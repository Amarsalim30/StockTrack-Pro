{"snapshots":{"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/data/repositories_impl/purchase_order_repository_impl.dart":{"filePath":"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/data/repositories_impl/purchase_order_repository_impl.dart","baseContent":"// lib/data/repositories/order/purchase_order_repository_impl.dart\n\nimport 'package:clean_arch_app/data/datasources/remote/purchase_order_api.dart';\nimport 'package:clean_arch_app/data/mappers/order/purchase_order_mapper.dart';\nimport 'package:clean_arch_app/data/models/order/purchase_order_model.dart';\nimport 'package:clean_arch_app/domain/entities/order/purchase_order.dart';\nimport 'package:clean_arch_app/domain/repositories/purchase_order_repository.dart';\n\nclass PurchaseOrderRepositoryImpl implements PurchaseOrderRepository {\n  final PurchaseOrderApi api;\n\n  PurchaseOrderRepositoryImpl(this.api);\n\n  @override\n  Future<void> createPurchaseOrder(PurchaseOrder order) async {\n    await api.createPurchaseOrder(order);\n  }\n\n  @override\n  Future<PurchaseOrder> getPurchaseOrderById(String id) async {\n    final model = await api.getPurchaseOrderById(id);\n    if(model != null) {\n      final PurchaseOrder purchaseOrder = model;\n      return purchaseOrder;\n    }\n    return (_);\n  }\n\n  @override\n  Future<List<PurchaseOrder>> getAllPurchaseOrders() async {\n    final models = await api.getAllPurchaseOrders();\n    return ;\n  }\n\n  @override\n  Future<PurchaseOrder> updatePurchaseOrder(PurchaseOrder order) async {\n    final model = PurchaseOrderMapper.toModel(order);\n    final resultModel = await api.updatePurchaseOrder(model);\n    return PurchaseOrderMapper.toEntity(resultModel);\n  }\n\n  @override\n  Future<void> deletePurchaseOrder(String id) async {\n    await api.deletePurchaseOrder(id);\n  }\n\n  @override\n  Future<PurchaseOrder> approvePurchaseOrder(String id, String approverUserId) async {\n    final model = await api.approvePurchaseOrder(id, approverUserId);\n    return PurchaseOrderMapper.toEntity(model);\n  }\n\n  @override\n  Future<PurchaseOrder> cancelPurchaseOrder(String id, String reason) async {\n    final model = await api.cancelPurchaseOrder(id, reason);\n    return PurchaseOrderMapper.toEntity(model);\n  }\n}\n","baseTimestamp":1755116559620,"deltas":[{"timestamp":1755116755170,"changes":[{"type":"MODIFY","lineNumber":53,"content":"    return model;","oldContent":"    return PurchaseOrderMapper.toEntity(model);"}]},{"timestamp":1755116823992,"changes":[{"type":"MODIFY","lineNumber":19,"content":"  Future<PurchaseOrder?> getPurchaseOrderById(String id) async {","oldContent":"  Future<PurchaseOrder> getPurchaseOrderById(String id) async {"}]},{"timestamp":1755116829622,"changes":[{"type":"MODIFY","lineNumber":25,"content":"    return null;","oldContent":"    return (_);"}]},{"timestamp":1755117756502,"changes":[{"type":"DELETE","lineNumber":3,"oldContent":"import 'package:clean_arch_app/data/mappers/order/purchase_order_mapper.dart';"},{"type":"DELETE","lineNumber":4,"oldContent":"import 'package:clean_arch_app/data/models/order/purchase_order_model.dart';"},{"type":"INSERT","lineNumber":53,"content":""},{"type":"INSERT","lineNumber":54,"content":"  @override"},{"type":"INSERT","lineNumber":55,"content":"  Future<List<PurchaseOrder>> filterPurchaseOrders(String? status, String? supplierId) async {"},{"type":"INSERT","lineNumber":56,"content":"    final models = await api.filterPurchaseOrders(status, supplierId);"},{"type":"INSERT","lineNumber":57,"content":"    return models;"},{"type":"INSERT","lineNumber":58,"content":"  }"}]},{"timestamp":1755118721752,"changes":[{"type":"DELETE","lineNumber":0,"oldContent":"// lib/data/repositories/order/purchase_order_repository_impl.dart"},{"type":"DELETE","lineNumber":1,"oldContent":""},{"type":"INSERT","lineNumber":0,"content":"import 'package:dartz/dartz.dart';"},{"type":"INSERT","lineNumber":1,"content":"import 'package:clean_arch_app/core/error/failures.dart';"},{"type":"MODIFY","lineNumber":4,"content":"import 'package:clean_arch_app/domain/repositories/order/purchase_order_repository.dart';","oldContent":"import 'package:clean_arch_app/domain/repositories/purchase_order_repository.dart';"},{"type":"DELETE","lineNumber":12,"oldContent":"  Future<void> createPurchaseOrder(PurchaseOrder order) async {"},{"type":"MODIFY","lineNumber":12,"content":"  Future<Either<Failure, void>> createPurchaseOrder(PurchaseOrder order) async {","oldContent":"    await api.createPurchaseOrder(order);"},{"type":"INSERT","lineNumber":13,"content":"    try {"},{"type":"INSERT","lineNumber":14,"content":"      await api.createPurchaseOrder(order);"},{"type":"INSERT","lineNumber":15,"content":"      return const Right(null);"},{"type":"INSERT","lineNumber":16,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":17,"content":"      return Left(ServerFailure(e.toString()));"},{"type":"INSERT","lineNumber":18,"content":"    }"},{"type":"DELETE","lineNumber":17,"oldContent":"  Future<PurchaseOrder?> getPurchaseOrderById(String id) async {"},{"type":"DELETE","lineNumber":18,"oldContent":"    final model = await api.getPurchaseOrderById(id);"},{"type":"DELETE","lineNumber":19,"oldContent":"    if(model != null) {"},{"type":"DELETE","lineNumber":20,"oldContent":"      final PurchaseOrder purchaseOrder = model;"},{"type":"DELETE","lineNumber":21,"oldContent":"      return purchaseOrder;"},{"type":"INSERT","lineNumber":22,"content":"  Future<Either<Failure, PurchaseOrder>> getPurchaseOrderById(String id) async {"},{"type":"INSERT","lineNumber":23,"content":"    try {"},{"type":"INSERT","lineNumber":24,"content":"      final model = await api.getPurchaseOrderById(id);"},{"type":"INSERT","lineNumber":25,"content":"      if (model != null) {"},{"type":"INSERT","lineNumber":26,"content":"        return Right(model);"},{"type":"INSERT","lineNumber":27,"content":"      } else {"},{"type":"INSERT","lineNumber":28,"content":"        return Left(ServerFailure(\"Purchase order not found\"));"},{"type":"INSERT","lineNumber":29,"content":"      }"},{"type":"INSERT","lineNumber":30,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":31,"content":"      return Left(ServerFailure(e.toString()));"},{"type":"DELETE","lineNumber":23,"oldContent":"    return null;"},{"type":"DELETE","lineNumber":27,"oldContent":"  Future<List<PurchaseOrder>> getAllPurchaseOrders() async {"},{"type":"DELETE","lineNumber":28,"oldContent":"    final models = await api.getAllPurchaseOrders();"},{"type":"DELETE","lineNumber":29,"oldContent":"    return models;"},{"type":"INSERT","lineNumber":36,"content":"  Future<Either<Failure, List<PurchaseOrder>>> getAllPurchaseOrders() async {"},{"type":"INSERT","lineNumber":37,"content":"    try {"},{"type":"INSERT","lineNumber":38,"content":"      final models = await api.getAllPurchaseOrders();"},{"type":"INSERT","lineNumber":39,"content":"      return Right(models);"},{"type":"INSERT","lineNumber":40,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":41,"content":"      return Left(ServerFailure(e.toString()));"},{"type":"INSERT","lineNumber":42,"content":"    }"},{"type":"DELETE","lineNumber":33,"oldContent":"  Future<void> updatePurchaseOrder(PurchaseOrder order) async {"},{"type":"DELETE","lineNumber":34,"oldContent":"    await api.updatePurchaseOrder(order);"},{"type":"INSERT","lineNumber":46,"content":"  Future<Either<Failure, void>> updatePurchaseOrder(PurchaseOrder order) async {"},{"type":"INSERT","lineNumber":47,"content":"    try {"},{"type":"INSERT","lineNumber":48,"content":"      await api.updatePurchaseOrder(order);"},{"type":"INSERT","lineNumber":49,"content":"      return const Right(null);"},{"type":"INSERT","lineNumber":50,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":51,"content":"      return Left(ServerFailure(e.toString()));"},{"type":"INSERT","lineNumber":52,"content":"    }"},{"type":"DELETE","lineNumber":38,"oldContent":"  Future<void> deletePurchaseOrder(String id) async {"},{"type":"DELETE","lineNumber":39,"oldContent":"    await api.deletePurchaseOrder(id);"},{"type":"INSERT","lineNumber":56,"content":"  Future<Either<Failure, void>> deletePurchaseOrder(String id) async {"},{"type":"INSERT","lineNumber":57,"content":"    try {"},{"type":"INSERT","lineNumber":58,"content":"      await api.deletePurchaseOrder(id);"},{"type":"INSERT","lineNumber":59,"content":"      return const Right(null);"},{"type":"INSERT","lineNumber":60,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":61,"content":"      return Left(ServerFailure(e.toString()));"},{"type":"INSERT","lineNumber":62,"content":"    }"},{"type":"DELETE","lineNumber":43,"oldContent":"  Future<PurchaseOrder> approvePurchaseOrder(String id, String approverUserId) async {"},{"type":"DELETE","lineNumber":44,"oldContent":"    final model = await api.approvePurchaseOrder(id, approverUserId);"},{"type":"DELETE","lineNumber":45,"oldContent":"    return model;"},{"type":"INSERT","lineNumber":66,"content":"  Future<Either<Failure, PurchaseOrder>> approvePurchaseOrder(String id, String approverUserId) async {"},{"type":"INSERT","lineNumber":67,"content":"    try {"},{"type":"INSERT","lineNumber":68,"content":"      final model = await api.approvePurchaseOrder(id, approverUserId);"},{"type":"INSERT","lineNumber":69,"content":"      return Right(model);"},{"type":"INSERT","lineNumber":70,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":71,"content":"      return Left(ServerFailure(e.toString()));"},{"type":"INSERT","lineNumber":72,"content":"    }"},{"type":"DELETE","lineNumber":49,"oldContent":"  Future<PurchaseOrder> cancelPurchaseOrder(String id, String reason) async {"},{"type":"DELETE","lineNumber":50,"oldContent":"    final model = await api.cancelPurchaseOrder(id, reason);"},{"type":"INSERT","lineNumber":76,"content":"  Future<Either<Failure, List<PurchaseOrder>>> filterPurchaseOrders(String? status, String? supplierId) async {"},{"type":"INSERT","lineNumber":77,"content":"    try {"},{"type":"INSERT","lineNumber":78,"content":"      final models = await api.filterPurchaseOrders(status, supplierId);"},{"type":"INSERT","lineNumber":79,"content":"      return Right(models);"},{"type":"INSERT","lineNumber":80,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":81,"content":"      return Left(ServerFailure(e.toString()));"},{"type":"INSERT","lineNumber":82,"content":"    }"},{"type":"INSERT","lineNumber":83,"content":"  }"},{"type":"DELETE","lineNumber":52,"oldContent":"    return model;"},{"type":"INSERT","lineNumber":86,"content":"  Future<Either<Failure, void>> cancelPurchaseOrder(String id, String reason) async {"},{"type":"INSERT","lineNumber":87,"content":"    try {"},{"type":"INSERT","lineNumber":88,"content":"      await api.cancelPurchaseOrder(id, reason);"},{"type":"INSERT","lineNumber":89,"content":"      return const Right(null);"},{"type":"INSERT","lineNumber":90,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":91,"content":"      return Left(ServerFailure(e.toString()));"},{"type":"INSERT","lineNumber":92,"content":"    }"},{"type":"DELETE","lineNumber":55,"oldContent":"  Future<List<PurchaseOrder>> filterPurchaseOrders(String? status, String? supplierId) async {"},{"type":"DELETE","lineNumber":57,"oldContent":"    final models = await api.filterPurchaseOrders(status, supplierId);"},{"type":"DELETE","lineNumber":59,"oldContent":"    return models;"},{"type":"DELETE","lineNumber":60,"oldContent":"  }"}]},{"timestamp":1755118738955,"changes":[{"type":"MODIFY","lineNumber":13,"content":"    try {","oldContent":"    await api.createPurchaseOrder(order);"},{"type":"DELETE","lineNumber":15,"oldContent":"  }"},{"type":"DELETE","lineNumber":17,"oldContent":""},{"type":"DELETE","lineNumber":19,"oldContent":"  @override"},{"type":"DELETE","lineNumber":20,"oldContent":"      return Left(ServerFailure(e.toString()));"},{"type":"INSERT","lineNumber":17,"content":"      return Left(ServerFailure(message: e.toString()));"},{"type":"INSERT","lineNumber":19,"content":"  }"},{"type":"INSERT","lineNumber":20,"content":""},{"type":"INSERT","lineNumber":21,"content":"  @override"},{"type":"DELETE","lineNumber":23,"oldContent":"    }"},{"type":"DELETE","lineNumber":26,"oldContent":"  }"},{"type":"DELETE","lineNumber":28,"oldContent":""},{"type":"DELETE","lineNumber":30,"oldContent":"  @override"},{"type":"DELETE","lineNumber":35,"oldContent":"  }"},{"type":"INSERT","lineNumber":32,"content":"    }"},{"type":"INSERT","lineNumber":33,"content":"  }"},{"type":"DELETE","lineNumber":39,"oldContent":"  }"},{"type":"DELETE","lineNumber":41,"oldContent":""},{"type":"DELETE","lineNumber":43,"oldContent":"  @override"},{"type":"DELETE","lineNumber":47,"oldContent":"  }"},{"type":"DELETE","lineNumber":49,"oldContent":""},{"type":"INSERT","lineNumber":43,"content":"  }"},{"type":"INSERT","lineNumber":44,"content":""},{"type":"DELETE","lineNumber":53,"oldContent":"  }"},{"type":"DELETE","lineNumber":55,"oldContent":""},{"type":"DELETE","lineNumber":57,"oldContent":"  @override"},{"type":"DELETE","lineNumber":61,"oldContent":""},{"type":"DELETE","lineNumber":63,"oldContent":"  @override"},{"type":"INSERT","lineNumber":54,"content":""},{"type":"INSERT","lineNumber":55,"content":"  @override"},{"type":"DELETE","lineNumber":66,"oldContent":"}"},{"type":"DELETE","lineNumber":69,"oldContent":""},{"type":"DELETE","lineNumber":74,"oldContent":"    }"},{"type":"DELETE","lineNumber":75,"oldContent":"      return Left(ServerFailure(e.toString()));"},{"type":"DELETE","lineNumber":76,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":77,"oldContent":"      return const Right(null);"},{"type":"DELETE","lineNumber":78,"oldContent":"      await api.cancelPurchaseOrder(id, reason);"},{"type":"INSERT","lineNumber":63,"content":"  }"},{"type":"INSERT","lineNumber":64,"content":""},{"type":"INSERT","lineNumber":65,"content":"  @override"},{"type":"DELETE","lineNumber":81,"oldContent":"    try {"},{"type":"DELETE","lineNumber":82,"oldContent":"  Future<Either<Failure, void>> cancelPurchaseOrder(String id, String reason) async {"},{"type":"DELETE","lineNumber":84,"oldContent":"  }"},{"type":"DELETE","lineNumber":86,"oldContent":"    }"},{"type":"DELETE","lineNumber":89,"oldContent":"      return Left(ServerFailure(e.toString()));"},{"type":"DELETE","lineNumber":90,"oldContent":"    } catch (e) {"},{"type":"DELETE","lineNumber":92,"oldContent":"      return Right(models);"},{"type":"INSERT","lineNumber":73,"content":"  }"},{"type":"INSERT","lineNumber":74,"content":""},{"type":"INSERT","lineNumber":75,"content":"  @override"},{"type":"INSERT","lineNumber":76,"content":"  Future<Either<Failure, List<PurchaseOrder>>> filterPurchaseOrders(String? status, String? supplierId) async {"},{"type":"INSERT","lineNumber":77,"content":"    try {"},{"type":"INSERT","lineNumber":79,"content":"      return Right(models);"},{"type":"INSERT","lineNumber":80,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":81,"content":"      return Left(ServerFailure(e.toString()));"},{"type":"INSERT","lineNumber":82,"content":"    }"},{"type":"INSERT","lineNumber":83,"content":"  }"},{"type":"INSERT","lineNumber":84,"content":""},{"type":"INSERT","lineNumber":85,"content":"  @override"},{"type":"INSERT","lineNumber":86,"content":"  Future<Either<Failure, void>> cancelPurchaseOrder(String id, String reason) async {"},{"type":"DELETE","lineNumber":95,"oldContent":"  Future<Either<Failure, List<PurchaseOrder>>> filterPurchaseOrders(String? status, String? supplierId) async {"},{"type":"INSERT","lineNumber":88,"content":"      await api.cancelPurchaseOrder(id, reason);"},{"type":"INSERT","lineNumber":89,"content":"      return const Right(null);"},{"type":"INSERT","lineNumber":90,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":91,"content":"      return Left(ServerFailure(e.toString()));"},{"type":"INSERT","lineNumber":92,"content":"    }"},{"type":"INSERT","lineNumber":93,"content":"  }"},{"type":"INSERT","lineNumber":94,"content":"}"},{"type":"INSERT","lineNumber":95,"content":""}]},{"timestamp":1755118748769,"changes":[{"type":"MODIFY","lineNumber":17,"content":"      return Left(ServerFailure(message: e.toString()));","oldContent":"      return Left(ServerFailure(message: e.toString()));"},{"type":"INSERT","lineNumber":18,"content":"    }"},{"type":"DELETE","lineNumber":21,"oldContent":"    }"},{"type":"DELETE","lineNumber":28,"oldContent":"    }"},{"type":"DELETE","lineNumber":30,"oldContent":"  }"},{"type":"DELETE","lineNumber":33,"oldContent":"      return Left(ServerFailure(e.toString()));"},{"type":"INSERT","lineNumber":31,"content":"      return Left(ServerFailure(message: e.toString()));"},{"type":"INSERT","lineNumber":32,"content":"    }"},{"type":"INSERT","lineNumber":33,"content":"  }"},{"type":"DELETE","lineNumber":38,"oldContent":"  }"},{"type":"DELETE","lineNumber":39,"oldContent":""},{"type":"INSERT","lineNumber":43,"content":"  }"},{"type":"INSERT","lineNumber":44,"content":""},{"type":"DELETE","lineNumber":47,"oldContent":""},{"type":"DELETE","lineNumber":49,"oldContent":"  @override"},{"type":"DELETE","lineNumber":57,"oldContent":"  }"},{"type":"INSERT","lineNumber":62,"content":"    }"},{"type":"INSERT","lineNumber":64,"content":""},{"type":"INSERT","lineNumber":65,"content":"  @override"},{"type":"INSERT","lineNumber":66,"content":"  Future<Either<Failure, PurchaseOrder>> approvePurchaseOrder(String id, String approverUserId) async {"},{"type":"INSERT","lineNumber":67,"content":"    try {"},{"type":"INSERT","lineNumber":68,"content":"      final model = await api.approvePurchaseOrder(id, approverUserId);"},{"type":"INSERT","lineNumber":69,"content":"      return Right(model);"},{"type":"INSERT","lineNumber":70,"content":"    } catch (e) {"},{"type":"INSERT","lineNumber":71,"content":"      return Left(ServerFailure(e.toString()));"},{"type":"INSERT","lineNumber":73,"content":"  }"},{"type":"INSERT","lineNumber":78,"content":"      final models = await api.filterPurchaseOrders(status, supplierId);"},{"type":"DELETE","lineNumber":72,"oldContent":"  Future<Either<Failure, PurchaseOrder>> approvePurchaseOrder(String id, String approverUserId) async {"},{"type":"DELETE","lineNumber":74,"oldContent":"    try {"},{"type":"DELETE","lineNumber":78,"oldContent":"      final model = await api.approvePurchaseOrder(id, approverUserId);"},{"type":"DELETE","lineNumber":81,"oldContent":"      return Right(model);"},{"type":"DELETE","lineNumber":83,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":87,"content":"    try {"},{"type":"DELETE","lineNumber":85,"oldContent":"      return Left(ServerFailure(e.toString()));"},{"type":"DELETE","lineNumber":90,"oldContent":"    }"},{"type":"DELETE","lineNumber":92,"oldContent":"      final models = await api.filterPurchaseOrders(status, supplierId);"},{"type":"DELETE","lineNumber":94,"oldContent":"    try {"}]},{"timestamp":1755118754178,"changes":[{"type":"INSERT","lineNumber":16,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":17,"oldContent":"      return Left(ServerFailure(message: e.toString()));"},{"type":"DELETE","lineNumber":29,"oldContent":"      return Left(ServerFailure(message: e.toString()));"},{"type":"MODIFY","lineNumber":31,"content":"      return Left(ServerFailure(message: e.toString()));","oldContent":"    }"},{"type":"INSERT","lineNumber":32,"content":"    }"},{"type":"INSERT","lineNumber":41,"content":"      return Left(ServerFailure(message: e.toString()));"},{"type":"INSERT","lineNumber":42,"content":"    }"},{"type":"DELETE","lineNumber":42,"oldContent":"      return Left(ServerFailure(e.toString()));"},{"type":"DELETE","lineNumber":44,"oldContent":"    }"},{"type":"DELETE","lineNumber":59,"oldContent":"    }"},{"type":"DELETE","lineNumber":62,"oldContent":""},{"type":"DELETE","lineNumber":64,"oldContent":"  @override"},{"type":"INSERT","lineNumber":62,"content":"    }"},{"type":"INSERT","lineNumber":64,"content":""},{"type":"INSERT","lineNumber":65,"content":"  @override"},{"type":"DELETE","lineNumber":67,"oldContent":"    }"},{"type":"DELETE","lineNumber":69,"oldContent":""},{"type":"DELETE","lineNumber":71,"oldContent":"  @override"},{"type":"DELETE","lineNumber":73,"oldContent":"  Future<Either<Failure, List<PurchaseOrder>>> filterPurchaseOrders(String? status, String? supplierId) async {"},{"type":"DELETE","lineNumber":75,"oldContent":"    try {"},{"type":"DELETE","lineNumber":77,"oldContent":"      return Right(models);"},{"type":"INSERT","lineNumber":72,"content":"    }"},{"type":"INSERT","lineNumber":74,"content":""},{"type":"INSERT","lineNumber":75,"content":"  @override"},{"type":"INSERT","lineNumber":76,"content":"  Future<Either<Failure, List<PurchaseOrder>>> filterPurchaseOrders(String? status, String? supplierId) async {"},{"type":"INSERT","lineNumber":77,"content":"    try {"},{"type":"INSERT","lineNumber":78,"content":"      final models = await api.filterPurchaseOrders(status, supplierId);"},{"type":"INSERT","lineNumber":79,"content":"      return Right(models);"},{"type":"DELETE","lineNumber":83,"oldContent":"      final models = await api.filterPurchaseOrders(status, supplierId);"},{"type":"INSERT","lineNumber":87,"content":"    try {"},{"type":"DELETE","lineNumber":89,"oldContent":"    try {"}]},{"timestamp":1755118757051,"changes":[{"type":"INSERT","lineNumber":30,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":32,"oldContent":"    } catch (e) {"},{"type":"MODIFY","lineNumber":43,"content":"  }","oldContent":"  }"},{"type":"MODIFY","lineNumber":51,"content":"      return Left(ServerFailure(message: e.toString()));","oldContent":"      return Left(ServerFailure(e.toString()));"},{"type":"MODIFY","lineNumber":62,"content":"    }","oldContent":"    }"},{"type":"INSERT","lineNumber":63,"content":"  }"},{"type":"DELETE","lineNumber":65,"oldContent":"  }"},{"type":"DELETE","lineNumber":69,"oldContent":"    }"},{"type":"MODIFY","lineNumber":71,"content":"      return Left(ServerFailure(e.toString()));","oldContent":""},{"type":"INSERT","lineNumber":72,"content":"    }"},{"type":"INSERT","lineNumber":73,"content":"  }"},{"type":"INSERT","lineNumber":74,"content":""},{"type":"DELETE","lineNumber":75,"oldContent":"      return Left(ServerFailure(e.toString()));"},{"type":"DELETE","lineNumber":78,"oldContent":"  }"}]},{"timestamp":1755118761369,"changes":[{"type":"INSERT","lineNumber":42,"content":"    }"},{"type":"DELETE","lineNumber":43,"oldContent":"  }"},{"type":"INSERT","lineNumber":61,"content":"      return Left(ServerFailure(message: e.toString()));"},{"type":"DELETE","lineNumber":62,"oldContent":"    }"},{"type":"INSERT","lineNumber":70,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":72,"oldContent":"    } catch (e) {"},{"type":"MODIFY","lineNumber":75,"content":"  @override","oldContent":"  @override"}]},{"timestamp":1755118764481,"changes":[{"type":"MODIFY","lineNumber":71,"content":"      return Left(ServerFailure(message: e.toString()));","oldContent":"      return Left(ServerFailure(e.toString()));"},{"type":"INSERT","lineNumber":74,"content":""},{"type":"DELETE","lineNumber":75,"oldContent":"  @override"}]},{"timestamp":1755118767772,"changes":[{"type":"MODIFY","lineNumber":81,"content":"      return Left(ServerFailure(message: e.toString()));","oldContent":"      return Left(ServerFailure(e.toString()));"}]},{"timestamp":1755118770897,"changes":[{"type":"MODIFY","lineNumber":45,"content":"  @override","oldContent":""},{"type":"MODIFY","lineNumber":91,"content":"      return Left(ServerFailure(message: e.toString()));","oldContent":"      return Left(ServerFailure(e.toString()));"},{"type":"DELETE","lineNumber":96,"oldContent":"  Future<Either<Failure, List<PurchaseOrder>>> filterPurchaseOrders(String? status, String? supplierId) async {"}]},{"timestamp":1755118789158,"changes":[{"type":"INSERT","lineNumber":6,"content":"import '../../domain/repositories/purchase_order_repository.dart';"},{"type":"INSERT","lineNumber":7,"content":""}]},{"timestamp":1755118793232,"changes":[{"type":"DELETE","lineNumber":4,"oldContent":"import 'package:clean_arch_app/domain/repositories/order/purchase_order_repository.dart';"},{"type":"MODIFY","lineNumber":7,"content":"class PurchaseOrderRepositoryImpl implements PurchaseOrderRepository {","oldContent":"class PurchaseOrderRepositoryImpl implements PurchaseOrderRepository {"}]},{"timestamp":1755118801442,"changes":[{"type":"MODIFY","lineNumber":7,"content":"class PurchaseOrderRepositoryImpl implements PurchaseOrderRepository {","oldContent":"class PurchaseOrderRepositoryImpl implements PurchaseOrderRepository {"},{"type":"MODIFY","lineNumber":29,"content":"        return Left(ServerFailure(message: \"Purchase order not found\"));","oldContent":"        return Left(ServerFailure(\"Purchase order not found\"));"},{"type":"DELETE","lineNumber":97,"oldContent":"    try {"}]},{"timestamp":1755118988122,"changes":[{"type":"INSERT","lineNumber":3,"content":"import 'package:clean_arch_app/data/mappers/order/purchase_order_mapper.dart';"},{"type":"INSERT","lineNumber":5,"content":"import 'package:clean_arch_app/domain/repositories/purchase_order_repository.dart';"},{"type":"DELETE","lineNumber":5,"oldContent":"import '../../domain/repositories/purchase_order_repository.dart';"},{"type":"DELETE","lineNumber":7,"oldContent":"class PurchaseOrderRepositoryImpl implements PurchaseOrderRepository {"},{"type":"MODIFY","lineNumber":15,"content":"      final model = PurchaseOrderMapper.fromEntity(order);","oldContent":"      await api.createPurchaseOrder(order);"},{"type":"INSERT","lineNumber":16,"content":"      await api.createPurchaseOrder(model);"},{"type":"MODIFY","lineNumber":28,"content":"        return Right(PurchaseOrderMapper.toEntity(model));","oldContent":"        return Right(model);"},{"type":"MODIFY","lineNumber":41,"content":"      return Right(models.map(PurchaseOrderMapper.toEntity).toList());","oldContent":"      return Right(models);"},{"type":"MODIFY","lineNumber":50,"content":"      final model = PurchaseOrderMapper.fromEntity(order);","oldContent":"      await api.updatePurchaseOrder(order);"},{"type":"INSERT","lineNumber":51,"content":"      await api.updatePurchaseOrder(model);"},{"type":"DELETE","lineNumber":70,"oldContent":"      return Right(model);"},{"type":"INSERT","lineNumber":72,"content":"      return Right(PurchaseOrderMapper.toEntity(model));"},{"type":"DELETE","lineNumber":80,"oldContent":"      return Right(models);"},{"type":"INSERT","lineNumber":82,"content":"      return Right(models.map(PurchaseOrderMapper.toEntity).toList());"}]},{"timestamp":1755119017448,"changes":[{"type":"MODIFY","lineNumber":6,"content":"","oldContent":""},{"type":"DELETE","lineNumber":28,"oldContent":"        return Right(model);"},{"type":"INSERT","lineNumber":29,"content":"      } else {"},{"type":"DELETE","lineNumber":41,"oldContent":"      return Right(models);"},{"type":"INSERT","lineNumber":42,"content":"    } catch (e) {"},{"type":"DELETE","lineNumber":50,"oldContent":"      await api.updatePurchaseOrder(order);"},{"type":"MODIFY","lineNumber":51,"content":"      await api.updatePurchaseOrder(model.id);","oldContent":"      await api.updatePurchaseOrder(model);"},{"type":"INSERT","lineNumber":52,"content":"      return const Right(null);"},{"type":"MODIFY","lineNumber":73,"content":"    } catch (e) {","oldContent":"    } catch (e) {"},{"type":"MODIFY","lineNumber":83,"content":"    } catch (e) {","oldContent":"    } catch (e) {"}]},{"timestamp":1755119027276,"changes":[{"type":"INSERT","lineNumber":5,"content":"import 'package:clean_arch_app/domain/repositories/purchase_order_repository.dart';"},{"type":"DELETE","lineNumber":6,"oldContent":""},{"type":"MODIFY","lineNumber":29,"content":"      } else {","oldContent":"      } else {"},{"type":"MODIFY","lineNumber":42,"content":"    } catch (e) {","oldContent":"    } catch (e) {"},{"type":"MODIFY","lineNumber":50,"content":"      final model = PurchaseOrderMapper.fromEntity(order);","oldContent":"      await api.updatePurchaseOrder(model.id);"},{"type":"INSERT","lineNumber":51,"content":"      await api.updatePurchaseOrder(model.id,);"},{"type":"DELETE","lineNumber":52,"oldContent":"      await api.updatePurchaseOrder(model);"},{"type":"INSERT","lineNumber":72,"content":"      return Right(PurchaseOrderMapper.toEntity(model));"},{"type":"DELETE","lineNumber":73,"oldContent":"    } catch (e) {"},{"type":"INSERT","lineNumber":82,"content":"      return Right(models.map(PurchaseOrderMapper.toEntity).toList());"},{"type":"DELETE","lineNumber":83,"oldContent":"    } catch (e) {"}]},{"timestamp":1755119034983,"changes":[{"type":"INSERT","lineNumber":28,"content":"        return Right(PurchaseOrderMapper.toEntity(model));"},{"type":"DELETE","lineNumber":29,"oldContent":"      } else {"},{"type":"INSERT","lineNumber":41,"content":"      return Right(models.map(PurchaseOrderMapper.toEntity).toList());"},{"type":"DELETE","lineNumber":42,"oldContent":"    } catch (e) {"},{"type":"MODIFY","lineNumber":51,"content":"      await api.updatePurchaseOrder(model.id, model);","oldContent":"      await api.updatePurchaseOrder(model.id,);"}]}]},"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/domain/repositories/purchase_order_repository.dart":{"filePath":"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/domain/repositories/purchase_order_repository.dart","baseContent":"// lib/domain/repositories/order/purchase_order_repository.dart\n\nimport 'package:clean_arch_app/domain/entities/order/purchase_order.dart';\n\nabstract class PurchaseOrderRepository {\n  /// Create a new purchase order\n  Future<void> createPurchaseOrder(PurchaseOrder order);\n\n  /// Get a single purchase order by ID\n  Future<PurchaseOrder> getPurchaseOrderById(String id);\n\n  /// Get all purchase orders\n  Future<List<PurchaseOrder>> getAllPurchaseOrders();\n\n  /// Update a purchase order\n  Future<void> updatePurchaseOrder(PurchaseOrder order);\n\n  /// Delete a purchase order\n  Future<void> deletePurchaseOrder(String id);\n\n  /// Approve a purchase order\n  Future<PurchaseOrder> approvePurchaseOrder(String id, String approverUserId);\n  Future<List<PurchaseOrder>> filterPurchaseOrders(String? status, String? supplierId);\n\n  /// Cancel a purchase order\n  Future<void> cancelPurchaseOrder(String id, String reason);\n}\n","baseTimestamp":1755116728906,"deltas":[{"timestamp":1755116860253,"changes":[{"type":"MODIFY","lineNumber":9,"content":"  Future<PurchaseOrder?> getPurchaseOrderById(String id);","oldContent":"  Future<PurchaseOrder> getPurchaseOrderById(String id);"}]},{"timestamp":1755118706228,"changes":[{"type":"DELETE","lineNumber":0,"oldContent":"// lib/domain/repositories/order/purchase_order_repository.dart"},{"type":"DELETE","lineNumber":1,"oldContent":""},{"type":"INSERT","lineNumber":0,"content":"import 'package:dartz/dartz.dart';"},{"type":"INSERT","lineNumber":1,"content":"import 'package:clean_arch_app/core/error/failures.dart';"},{"type":"DELETE","lineNumber":5,"oldContent":"  /// Create a new purchase order"},{"type":"MODIFY","lineNumber":5,"content":"  Future<Either<Failure, void>> createPurchaseOrder(PurchaseOrder order);","oldContent":"  Future<void> createPurchaseOrder(PurchaseOrder order);"},{"type":"DELETE","lineNumber":8,"oldContent":"  /// Get a single purchase order by ID"},{"type":"DELETE","lineNumber":9,"oldContent":"  Future<PurchaseOrder?> getPurchaseOrderById(String id);"},{"type":"INSERT","lineNumber":7,"content":"  Future<Either<Failure, PurchaseOrder>> getPurchaseOrderById(String id);"},{"type":"DELETE","lineNumber":11,"oldContent":"  /// Get all purchase orders"},{"type":"DELETE","lineNumber":12,"oldContent":"  Future<List<PurchaseOrder>> getAllPurchaseOrders();"},{"type":"INSERT","lineNumber":9,"content":"  Future<Either<Failure, List<PurchaseOrder>>> getAllPurchaseOrders();"},{"type":"DELETE","lineNumber":14,"oldContent":"  /// Update a purchase order"},{"type":"DELETE","lineNumber":15,"oldContent":"  Future<void> updatePurchaseOrder(PurchaseOrder order);"},{"type":"INSERT","lineNumber":11,"content":"  Future<Either<Failure, void>> updatePurchaseOrder(PurchaseOrder order);"},{"type":"DELETE","lineNumber":17,"oldContent":"  /// Delete a purchase order"},{"type":"DELETE","lineNumber":18,"oldContent":"  Future<void> deletePurchaseOrder(String id);"},{"type":"INSERT","lineNumber":13,"content":"  Future<Either<Failure, void>> deletePurchaseOrder(String id);"},{"type":"DELETE","lineNumber":20,"oldContent":"  /// Approve a purchase order"},{"type":"DELETE","lineNumber":21,"oldContent":"  Future<PurchaseOrder> approvePurchaseOrder(String id, String approverUserId);"},{"type":"DELETE","lineNumber":22,"oldContent":"  Future<List<PurchaseOrder>> filterPurchaseOrders(String? status, String? supplierId);"},{"type":"INSERT","lineNumber":15,"content":"  Future<Either<Failure, PurchaseOrder>> approvePurchaseOrder(String id, String approverUserId);"},{"type":"DELETE","lineNumber":24,"oldContent":"  /// Cancel a purchase order"},{"type":"DELETE","lineNumber":25,"oldContent":"  Future<void> cancelPurchaseOrder(String id, String reason);"},{"type":"INSERT","lineNumber":17,"content":"  Future<Either<Failure, List<PurchaseOrder>>> filterPurchaseOrders(String? status, String? supplierId);"},{"type":"INSERT","lineNumber":18,"content":""},{"type":"INSERT","lineNumber":19,"content":"  Future<Either<Failure, void>> cancelPurchaseOrder(String id, String reason);"}]}]},"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/domain/usecases/order/get_purchase_order_by_id_usecase.dart":{"filePath":"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/domain/usecases/order/get_purchase_order_by_id_usecase.dart","baseContent":"import 'package:clean_arch_app/domain/entities/order/purchase_order.dart';\nimport 'package:clean_arch_app/domain/repositories/purchase_order_repository.dart';\n\nclass GetPurchaseOrderByIdUseCase {\n  final PurchaseOrderRepository repository;\n\n  GetPurchaseOrderByIdUseCase(this.repository);\n\n  Future<PurchaseOrder?> call(String id) async {\n    return await repository.getPurchaseOrderById(id);\n  }\n}\n","baseTimestamp":1755116840002,"deltas":[{"timestamp":1755116866197,"changes":[{"type":"MODIFY","lineNumber":8,"content":"  Future<PurchaseOrder> call(String id) async {","oldContent":"  Future<PurchaseOrder?> call(String id) async {"}]},{"timestamp":1755116869143,"changes":[{"type":"MODIFY","lineNumber":8,"content":"  Future<PurchaseOrder?> call(String id) async {","oldContent":"  Future<PurchaseOrder> call(String id) async {"}]},{"timestamp":1755119233654,"changes":[{"type":"INSERT","lineNumber":0,"content":"import 'package:clean_arch_app/core/error/failures.dart';"},{"type":"MODIFY","lineNumber":9,"content":"  Future<Either<Failure,PurchaseOrder?> call(String id) async {","oldContent":"  Future<PurchaseOrder?> call(String id) async {"}]},{"timestamp":1755119236172,"changes":[{"type":"DELETE","lineNumber":9,"oldContent":"  Future<PurchaseOrder?> call(String id) async {"},{"type":"MODIFY","lineNumber":9,"content":"  Future<Either<Failure,PurchaseOrder?>> call(String id) async {","oldContent":"  Future<Either<Failure,PurchaseOrder?> call(String id) async {"},{"type":"INSERT","lineNumber":10,"content":"    return await repository.getPurchaseOrderById(id);"}]},{"timestamp":1755119243003,"changes":[{"type":"INSERT","lineNumber":3,"content":"import 'package:dartz/dartz.dart';"},{"type":"MODIFY","lineNumber":11,"content":"    return await repository.getPurchaseOrderById(id);","oldContent":"  Future<Either<Failure,PurchaseOrder?> call(String id) async {"}]}]},"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/data/datasources/remote/purchase_order_api.dart":{"filePath":"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/data/datasources/remote/purchase_order_api.dart","baseContent":"import 'package:clean_arch_app/domain/entities/order/purchase_order.dart';\nimport 'package:clean_arch_app/domain/entities/order/purchase_order_item.dart';\nimport 'package:dio/dio.dart';\n\nclass PurchaseOrderApi {\n  final Dio dio;\n\n  PurchaseOrderApi(this.dio);\n\n  Future<void> createPurchaseOrder(PurchaseOrder order) async {\n    await dio.post('/purchase-orders', data: _mapFromEntity(order));\n  }\n\n  Future<void> updatePurchaseOrder(PurchaseOrder order) async {\n    await dio.put('/purchase-orders/${order.id}', data: _mapFromEntity(order));\n  }\n\n  Future<void> deletePurchaseOrder(String id) async {\n    await dio.delete('/purchase-orders/$id');\n  }\n\n  Future<PurchaseOrder?> getPurchaseOrderById(String id) async {\n    final res = await dio.get('/purchase-orders/$id');\n    if (res.data == null) return null;\n    return _mapToEntity(res.data as Map<String, dynamic>);\n  }\n\n  Future<List<PurchaseOrder>> getAllPurchaseOrders() async {\n    final res = await dio.get('/purchase-orders');\n    return (res.data as List)\n        .map((json) => _mapToEntity(json as Map<String, dynamic>))\n        .toList();\n  }\n\n  Future<PurchaseOrder> approvePurchaseOrder(String id, String approverUserId) async {\n    final res = await dio.post('/purchase-orders/$id/approve', data: {\n      'approvedByUserId': approverUserId,\n    });\n    return _mapToEntity(res.data as Map<String, dynamic>);\n  }\n\n  Future<PurchaseOrder> cancelPurchaseOrder(String id, String reason) async {\n    final res = await dio.post('/purchase-orders/$id/cancel', data: {\n      'reason': reason,\n    });\n    return _mapToEntity(res.data as Map<String, dynamic>);\n  }\n\n  Future<List<PurchaseOrder>> filterPurchaseOrders(String? status, String? supplierId) async {\n    final res = await dio.get('/purchase-orders', queryParameters: {\n      if (status != null) 'status': status,\n      if (supplierId != null) 'supplierId': supplierId,\n    });\n    return (res.data as List)\n        .map((json) => _mapToEntity(json as Map<String, dynamic>))\n        .toList();\n  }\n\n  /// -------- Mapping Helpers -------- ///\n\n  Map<String, dynamic> _mapFromEntity(PurchaseOrder order) {\n    return {\n      'id': order.id,\n      'supplierId': order.supplierId,\n      'createdByUserId': order.createdByUserId,\n      'approvedByUserId': order.approvedByUserId,\n      'goodsReceiptId': order.goodsReceiptId,\n      'invoiceId': order.invoiceId,\n      'totalAmount': order.totalAmount,\n      'attachments': order.attachments,\n      'createdAt': order.createdAt.toIso8601String(),\n      'expectedDeliveryDate': order.expectedDeliveryDate?.toIso8601String(),\n      'receivedDate': order.receivedDate?.toIso8601String(),\n      'status': order.status,\n      'items': order.items.map((item) => {\n        'stockId': item.stockId,\n        'quantityOrdered': item.quantityOrdered,\n        'quantityReceived': item.quantityReceived,\n        'unitCost': item.unitCost,\n      }).toList(),\n      'notes': order.notes,\n    };\n  }\n\n  PurchaseOrder _mapToEntity(Map<String, dynamic> json) {\n    return PurchaseOrder(\n      id: json['id'] as String,\n      supplierId: json['supplierId'] as String,\n      createdByUserId: json['createdByUserId'] as String,\n      approvedByUserId: json['approvedByUserId'] as String?,\n      goodsReceiptId: json['goodsReceiptId'] as String?,\n      invoiceId: json['invoiceId'] as String?,\n      totalAmount: (json['totalAmount'] as num).toDouble(),\n      attachments: (json['attachments'] as List?)?.map((a) => a as String).toList(),\n      createdAt: DateTime.parse(json['createdAt']),\n      expectedDeliveryDate: json['expectedDeliveryDate'] != null\n          ? DateTime.parse(json['expectedDeliveryDate'])\n          : null,\n      receivedDate: json['receivedDate'] != null\n          ? DateTime.parse(json['receivedDate'])\n          : null,\n      status: json['status'] as String,\n      items: (json['items'] as List).map((item) {\n        final map = item as Map<String, dynamic>;\n        return PurchaseOrderItem(\n          stockId: map['stockId'] as String,\n          quantityOrdered: map['quantityOrdered'] as int,\n          quantityReceived: map['quantityReceived'] as int?,\n          unitCost: (map['unitCost'] as num).toDouble(),\n        );\n      }).toList(),\n      notes: json['notes'] as String?,\n    );\n  }\n}\n","baseTimestamp":1755117807590,"deltas":[{"timestamp":1755118882107,"changes":[{"type":"DELETE","lineNumber":0,"oldContent":"import 'package:clean_arch_app/domain/entities/order/purchase_order.dart';"},{"type":"MODIFY","lineNumber":1,"content":"import 'package:retrofit/retrofit.dart';","oldContent":"import 'package:clean_arch_app/domain/entities/order/purchase_order_item.dart';"},{"type":"INSERT","lineNumber":2,"content":"import 'package:clean_arch_app/data/models/order/purchase_order_model.dart';"},{"type":"DELETE","lineNumber":4,"oldContent":"class PurchaseOrderApi {"},{"type":"DELETE","lineNumber":5,"oldContent":"  final Dio dio;"},{"type":"INSERT","lineNumber":4,"content":"part 'purchase_order_api.g.dart';"},{"type":"DELETE","lineNumber":7,"oldContent":"  PurchaseOrderApi(this.dio);"},{"type":"INSERT","lineNumber":6,"content":"@RestApi()"},{"type":"INSERT","lineNumber":7,"content":"abstract class PurchaseOrderApi {"},{"type":"INSERT","lineNumber":8,"content":"  factory PurchaseOrderApi(Dio dio, {String baseUrl}) = _PurchaseOrderApi;"},{"type":"DELETE","lineNumber":9,"oldContent":"  Future<void> createPurchaseOrder(PurchaseOrder order) async {"},{"type":"DELETE","lineNumber":10,"oldContent":"    await dio.post('/purchase-orders', data: _mapFromEntity(order));"},{"type":"DELETE","lineNumber":11,"oldContent":"  }"},{"type":"INSERT","lineNumber":10,"content":"  @POST('/purchase-orders')"},{"type":"INSERT","lineNumber":11,"content":"  Future<void> createPurchaseOrder(@Body() PurchaseOrderModel order);"},{"type":"DELETE","lineNumber":13,"oldContent":"  Future<void> updatePurchaseOrder(PurchaseOrder order) async {"},{"type":"DELETE","lineNumber":14,"oldContent":"    await dio.put('/purchase-orders/${order.id}', data: _mapFromEntity(order));"},{"type":"DELETE","lineNumber":15,"oldContent":"  }"},{"type":"INSERT","lineNumber":13,"content":"  @PUT('/purchase-orders/{id}')"},{"type":"INSERT","lineNumber":14,"content":"  Future<void> updatePurchaseOrder("},{"type":"INSERT","lineNumber":15,"content":"      @Path(\"id\") String id,"},{"type":"INSERT","lineNumber":16,"content":"      @Body() PurchaseOrderModel order,"},{"type":"INSERT","lineNumber":17,"content":"      );"},{"type":"DELETE","lineNumber":17,"oldContent":"  Future<void> deletePurchaseOrder(String id) async {"},{"type":"DELETE","lineNumber":18,"oldContent":"    await dio.delete('/purchase-orders/$id');"},{"type":"MODIFY","lineNumber":19,"content":"  @DELETE('/purchase-orders/{id}')","oldContent":"  }"},{"type":"INSERT","lineNumber":20,"content":"  Future<void> deletePurchaseOrder(@Path(\"id\") String id);"},{"type":"DELETE","lineNumber":21,"oldContent":"  Future<PurchaseOrder?> getPurchaseOrderById(String id) async {"},{"type":"DELETE","lineNumber":22,"oldContent":"    final res = await dio.get('/purchase-orders/$id');"},{"type":"DELETE","lineNumber":23,"oldContent":"    if (res.data == null) return null;"},{"type":"DELETE","lineNumber":24,"oldContent":"    return _mapToEntity(res.data as Map<String, dynamic>);"},{"type":"DELETE","lineNumber":25,"oldContent":"  }"},{"type":"INSERT","lineNumber":22,"content":"  @GET('/purchase-orders/{id}')"},{"type":"INSERT","lineNumber":23,"content":"  Future<PurchaseOrderModel?> getPurchaseOrderById(@Path(\"id\") String id);"},{"type":"DELETE","lineNumber":27,"oldContent":"  Future<List<PurchaseOrder>> getAllPurchaseOrders() async {"},{"type":"DELETE","lineNumber":28,"oldContent":"    final res = await dio.get('/purchase-orders');"},{"type":"DELETE","lineNumber":29,"oldContent":"    return (res.data as List)"},{"type":"DELETE","lineNumber":30,"oldContent":"        .map((json) => _mapToEntity(json as Map<String, dynamic>))"},{"type":"DELETE","lineNumber":31,"oldContent":"        .toList();"},{"type":"DELETE","lineNumber":32,"oldContent":"  }"},{"type":"INSERT","lineNumber":25,"content":"  @GET('/purchase-orders')"},{"type":"INSERT","lineNumber":26,"content":"  Future<List<PurchaseOrderModel>> getAllPurchaseOrders();"},{"type":"DELETE","lineNumber":34,"oldContent":"  Future<PurchaseOrder> approvePurchaseOrder(String id, String approverUserId) async {"},{"type":"DELETE","lineNumber":35,"oldContent":"    final res = await dio.post('/purchase-orders/$id/approve', data: {"},{"type":"DELETE","lineNumber":36,"oldContent":"      'approvedByUserId': approverUserId,"},{"type":"DELETE","lineNumber":37,"oldContent":"    });"},{"type":"DELETE","lineNumber":38,"oldContent":"    return _mapToEntity(res.data as Map<String, dynamic>);"},{"type":"DELETE","lineNumber":39,"oldContent":"  }"},{"type":"INSERT","lineNumber":28,"content":"  @POST('/purchase-orders/{id}/approve')"},{"type":"INSERT","lineNumber":29,"content":"  Future<PurchaseOrderModel> approvePurchaseOrder("},{"type":"INSERT","lineNumber":30,"content":"      @Path(\"id\") String id,"},{"type":"INSERT","lineNumber":31,"content":"      @Field(\"approvedByUserId\") String approverUserId,"},{"type":"INSERT","lineNumber":32,"content":"      );"},{"type":"DELETE","lineNumber":41,"oldContent":"  Future<PurchaseOrder> cancelPurchaseOrder(String id, String reason) async {"},{"type":"DELETE","lineNumber":42,"oldContent":"    final res = await dio.post('/purchase-orders/$id/cancel', data: {"},{"type":"DELETE","lineNumber":43,"oldContent":"      'reason': reason,"},{"type":"DELETE","lineNumber":44,"oldContent":"    });"},{"type":"DELETE","lineNumber":45,"oldContent":"    return _mapToEntity(res.data as Map<String, dynamic>);"},{"type":"DELETE","lineNumber":46,"oldContent":"  }"},{"type":"INSERT","lineNumber":34,"content":"  @POST('/purchase-orders/{id}/cancel')"},{"type":"INSERT","lineNumber":35,"content":"  Future<PurchaseOrderModel> cancelPurchaseOrder("},{"type":"INSERT","lineNumber":36,"content":"      @Path(\"id\") String id,"},{"type":"INSERT","lineNumber":37,"content":"      @Field(\"reason\") String reason,"},{"type":"INSERT","lineNumber":38,"content":"      );"},{"type":"DELETE","lineNumber":48,"oldContent":"  Future<List<PurchaseOrder>> filterPurchaseOrders(String? status, String? supplierId) async {"},{"type":"DELETE","lineNumber":49,"oldContent":"    final res = await dio.get('/purchase-orders', queryParameters: {"},{"type":"DELETE","lineNumber":50,"oldContent":"      if (status != null) 'status': status,"},{"type":"DELETE","lineNumber":51,"oldContent":"      if (supplierId != null) 'supplierId': supplierId,"},{"type":"DELETE","lineNumber":52,"oldContent":"    });"},{"type":"DELETE","lineNumber":53,"oldContent":"    return (res.data as List)"},{"type":"DELETE","lineNumber":54,"oldContent":"        .map((json) => _mapToEntity(json as Map<String, dynamic>))"},{"type":"DELETE","lineNumber":55,"oldContent":"        .toList();"},{"type":"DELETE","lineNumber":56,"oldContent":"  }"},{"type":"DELETE","lineNumber":57,"oldContent":""},{"type":"DELETE","lineNumber":58,"oldContent":"  /// -------- Mapping Helpers -------- ///"},{"type":"DELETE","lineNumber":59,"oldContent":""},{"type":"DELETE","lineNumber":60,"oldContent":"  Map<String, dynamic> _mapFromEntity(PurchaseOrder order) {"},{"type":"DELETE","lineNumber":61,"oldContent":"    return {"},{"type":"DELETE","lineNumber":62,"oldContent":"      'id': order.id,"},{"type":"DELETE","lineNumber":63,"oldContent":"      'supplierId': order.supplierId,"},{"type":"DELETE","lineNumber":64,"oldContent":"      'createdByUserId': order.createdByUserId,"},{"type":"DELETE","lineNumber":65,"oldContent":"      'approvedByUserId': order.approvedByUserId,"},{"type":"DELETE","lineNumber":66,"oldContent":"      'goodsReceiptId': order.goodsReceiptId,"},{"type":"DELETE","lineNumber":67,"oldContent":"      'invoiceId': order.invoiceId,"},{"type":"DELETE","lineNumber":68,"oldContent":"      'totalAmount': order.totalAmount,"},{"type":"DELETE","lineNumber":69,"oldContent":"      'attachments': order.attachments,"},{"type":"DELETE","lineNumber":70,"oldContent":"      'createdAt': order.createdAt.toIso8601String(),"},{"type":"DELETE","lineNumber":71,"oldContent":"      'expectedDeliveryDate': order.expectedDeliveryDate?.toIso8601String(),"},{"type":"DELETE","lineNumber":72,"oldContent":"      'receivedDate': order.receivedDate?.toIso8601String(),"},{"type":"DELETE","lineNumber":73,"oldContent":"      'status': order.status,"},{"type":"DELETE","lineNumber":74,"oldContent":"      'items': order.items.map((item) => {"},{"type":"DELETE","lineNumber":75,"oldContent":"        'stockId': item.stockId,"},{"type":"DELETE","lineNumber":76,"oldContent":"        'quantityOrdered': item.quantityOrdered,"},{"type":"DELETE","lineNumber":77,"oldContent":"        'quantityReceived': item.quantityReceived,"},{"type":"DELETE","lineNumber":78,"oldContent":"        'unitCost': item.unitCost,"},{"type":"DELETE","lineNumber":79,"oldContent":"      }).toList(),"},{"type":"DELETE","lineNumber":80,"oldContent":"      'notes': order.notes,"},{"type":"DELETE","lineNumber":81,"oldContent":"    };"},{"type":"DELETE","lineNumber":82,"oldContent":"  }"},{"type":"DELETE","lineNumber":83,"oldContent":""},{"type":"DELETE","lineNumber":84,"oldContent":"  PurchaseOrder _mapToEntity(Map<String, dynamic> json) {"},{"type":"DELETE","lineNumber":85,"oldContent":"    return PurchaseOrder("},{"type":"DELETE","lineNumber":86,"oldContent":"      id: json['id'] as String,"},{"type":"DELETE","lineNumber":87,"oldContent":"      supplierId: json['supplierId'] as String,"},{"type":"DELETE","lineNumber":88,"oldContent":"      createdByUserId: json['createdByUserId'] as String,"},{"type":"DELETE","lineNumber":89,"oldContent":"      approvedByUserId: json['approvedByUserId'] as String?,"},{"type":"DELETE","lineNumber":90,"oldContent":"      goodsReceiptId: json['goodsReceiptId'] as String?,"},{"type":"DELETE","lineNumber":91,"oldContent":"      invoiceId: json['invoiceId'] as String?,"},{"type":"DELETE","lineNumber":92,"oldContent":"      totalAmount: (json['totalAmount'] as num).toDouble(),"},{"type":"DELETE","lineNumber":93,"oldContent":"      attachments: (json['attachments'] as List?)?.map((a) => a as String).toList(),"},{"type":"DELETE","lineNumber":94,"oldContent":"      createdAt: DateTime.parse(json['createdAt']),"},{"type":"DELETE","lineNumber":95,"oldContent":"      expectedDeliveryDate: json['expectedDeliveryDate'] != null"},{"type":"DELETE","lineNumber":96,"oldContent":"          ? DateTime.parse(json['expectedDeliveryDate'])"},{"type":"DELETE","lineNumber":97,"oldContent":"          : null,"},{"type":"DELETE","lineNumber":98,"oldContent":"      receivedDate: json['receivedDate'] != null"},{"type":"DELETE","lineNumber":99,"oldContent":"          ? DateTime.parse(json['receivedDate'])"},{"type":"DELETE","lineNumber":100,"oldContent":"          : null,"},{"type":"DELETE","lineNumber":101,"oldContent":"      status: json['status'] as String,"},{"type":"DELETE","lineNumber":102,"oldContent":"      items: (json['items'] as List).map((item) {"},{"type":"DELETE","lineNumber":103,"oldContent":"        final map = item as Map<String, dynamic>;"},{"type":"DELETE","lineNumber":104,"oldContent":"        return PurchaseOrderItem("},{"type":"DELETE","lineNumber":105,"oldContent":"          stockId: map['stockId'] as String,"},{"type":"DELETE","lineNumber":106,"oldContent":"          quantityOrdered: map['quantityOrdered'] as int,"},{"type":"DELETE","lineNumber":107,"oldContent":"          quantityReceived: map['quantityReceived'] as int?,"},{"type":"DELETE","lineNumber":108,"oldContent":"          unitCost: (map['unitCost'] as num).toDouble(),"},{"type":"DELETE","lineNumber":109,"oldContent":"        );"},{"type":"DELETE","lineNumber":110,"oldContent":"      }).toList(),"},{"type":"DELETE","lineNumber":111,"oldContent":"      notes: json['notes'] as String?,"},{"type":"DELETE","lineNumber":112,"oldContent":"    );"},{"type":"DELETE","lineNumber":113,"oldContent":"  }"},{"type":"INSERT","lineNumber":40,"content":"  @GET('/purchase-orders')"},{"type":"INSERT","lineNumber":41,"content":"  Future<List<PurchaseOrderModel>> filterPurchaseOrders("},{"type":"INSERT","lineNumber":42,"content":"      @Query(\"status\") String? status,"},{"type":"INSERT","lineNumber":43,"content":"      @Query(\"supplierId\") String? supplierId,"},{"type":"INSERT","lineNumber":44,"content":"      );"}]}]},"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/domain/usecases/order/update_purchase_order_usecase.dart":{"filePath":"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/domain/usecases/order/update_purchase_order_usecase.dart","baseContent":"import 'package:clean_arch_app/domain/entities/order/purchase_order.dart';\nimport 'package:clean_arch_app/domain/repositories/purchase_order_repository.dart';\n\nclass UpdatePurchaseOrderUseCase {\n  final PurchaseOrderRepository repository;\n\n  UpdatePurchaseOrderUseCase(this.repository);\n\n  Future<void> call(PurchaseOrder order) async {\n    return await repository.updatePurchaseOrder(order);\n  }\n}","baseTimestamp":1755117921184,"deltas":[{"timestamp":1755119255219,"changes":[{"type":"INSERT","lineNumber":0,"content":"import 'package:clean_arch_app/core/error/failures.dart';"},{"type":"INSERT","lineNumber":3,"content":"import 'package:dartz/dartz.dart';"},{"type":"DELETE","lineNumber":8,"oldContent":"  Future<void> call(PurchaseOrder order) async {"},{"type":"INSERT","lineNumber":10,"content":"  Future<Either<Failure>void> call(PurchaseOrder order) async {"}]},{"timestamp":1755119259830,"changes":[{"type":"MODIFY","lineNumber":4,"content":"","oldContent":""},{"type":"INSERT","lineNumber":10,"content":"  Future<Either<Failure,void> call(PurchaseOrder order) async {"},{"type":"DELETE","lineNumber":11,"oldContent":"  Future<Either<Failure>void> call(PurchaseOrder order) async {"}]},{"timestamp":1755119261838,"changes":[{"type":"INSERT","lineNumber":3,"content":"import 'package:dartz/dartz.dart';"},{"type":"DELETE","lineNumber":4,"oldContent":""},{"type":"MODIFY","lineNumber":10,"content":"  Future<Either<Failure,void>> call(PurchaseOrder order) async {","oldContent":"  Future<Either<Failure,void> call(PurchaseOrder order) async {"}]}]},"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/domain/usecases/order/create_purchase_order_usecase.dart":{"filePath":"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/domain/usecases/order/create_purchase_order_usecase.dart","baseContent":"import 'package:clean_arch_app/domain/entities/order/purchase_order.dart';\nimport 'package:clean_arch_app/domain/repositories/purchase_order_repository.dart';\n\nclass CreatePurchaseOrderUseCase {\n  final PurchaseOrderRepository repository;\n\n  CreatePurchaseOrderUseCase(this.repository);\n\n  Future<void> call(PurchaseOrder order) async {\n    return await repository.createPurchaseOrder(order);\n  }\n}\n","baseTimestamp":1755117934553,"deltas":[{"timestamp":1755119120852,"changes":[{"type":"MODIFY","lineNumber":8,"content":"  Future<Either<Failure,void>> call(PurchaseOrder order) async {","oldContent":"  Future<void> call(PurchaseOrder order) async {"}]},{"timestamp":1755119130954,"changes":[{"type":"INSERT","lineNumber":0,"content":"import 'package:clean_arch_app/core/error/failures.dart';"},{"type":"INSERT","lineNumber":3,"content":"import 'package:dartz/dartz.dart' show Either;"}]}]},"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/presentation/purchase_order/purchase_order_view_model.dart":{"filePath":"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/presentation/purchase_order/purchase_order_view_model.dart","baseContent":"class PurchaseOrderViewModel {\n  final PurchaseOrderUseCases purchaseOrderUseCases;\n  \n}","baseTimestamp":1755117969905,"deltas":[{"timestamp":1755118115386,"changes":[{"type":"MODIFY","lineNumber":0,"content":"// purchase_order_view_model.dart","oldContent":"class PurchaseOrderViewModel {"},{"type":"INSERT","lineNumber":1,"content":"import 'dart:async';"},{"type":"INSERT","lineNumber":2,"content":""},{"type":"INSERT","lineNumber":3,"content":"import 'package:clean_arch_app/domain/entities/order/purchase_order.dart';"},{"type":"INSERT","lineNumber":4,"content":"import 'package:flutter_riverpod/flutter_riverpod.dart';"},{"type":"INSERT","lineNumber":5,"content":""},{"type":"INSERT","lineNumber":6,"content":"import '../../core/enums/purchase_order_status.dart';"},{"type":"INSERT","lineNumber":7,"content":"import '../../domain/entities/auth/permission_type.dart';"},{"type":"INSERT","lineNumber":8,"content":"import '../../domain/repositories/auth_repository.dart';"},{"type":"INSERT","lineNumber":9,"content":"import '../../domain/usecases/order/purchase_order_usecases.dart';"},{"type":"INSERT","lineNumber":10,"content":"import 'purchase_order_state.dart';"},{"type":"INSERT","lineNumber":11,"content":""},{"type":"INSERT","lineNumber":12,"content":"class PurchaseOrderViewModel extends StateNotifier<PurchaseOrderState> {"},{"type":"INSERT","lineNumber":14,"content":"  final AuthRepository authRepository;"},{"type":"INSERT","lineNumber":15,"content":"  Timer? _searchDebounce;"},{"type":"INSERT","lineNumber":16,"content":""},{"type":"INSERT","lineNumber":17,"content":"  PurchaseOrderViewModel({"},{"type":"INSERT","lineNumber":18,"content":"    required this.purchaseOrderUseCases,"},{"type":"INSERT","lineNumber":19,"content":"    required this.authRepository,"},{"type":"INSERT","lineNumber":20,"content":"  }) : super(PurchaseOrderState.initial()) {"},{"type":"INSERT","lineNumber":21,"content":"    _init();"},{"type":"INSERT","lineNumber":22,"content":"  }"},{"type":"INSERT","lineNumber":23,"content":""},{"type":"INSERT","lineNumber":24,"content":"  void _init() {"},{"type":"INSERT","lineNumber":25,"content":"    _loadCurrentUser();"},{"type":"INSERT","lineNumber":26,"content":"    loadPurchaseOrders();"},{"type":"INSERT","lineNumber":27,"content":"  }"},{"type":"INSERT","lineNumber":28,"content":""},{"type":"INSERT","lineNumber":29,"content":"  Future<void> _loadCurrentUser() async {"},{"type":"INSERT","lineNumber":30,"content":"    final res = await authRepository.getCurrentUser();"},{"type":"INSERT","lineNumber":31,"content":"    res.fold("},{"type":"INSERT","lineNumber":32,"content":"      (failure) => state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Failed to load user'),"},{"type":"INSERT","lineNumber":33,"content":"      (user) => state = state.copyWith(currentUser: user),"},{"type":"INSERT","lineNumber":34,"content":"    );"},{"type":"INSERT","lineNumber":35,"content":"  }"},{"type":"INSERT","lineNumber":36,"content":""},{"type":"INSERT","lineNumber":37,"content":"  bool hasPermission(PermissionType permission) =>"},{"type":"INSERT","lineNumber":38,"content":"      state.currentUser?.hasPermission(permission) ?? false;"},{"type":"INSERT","lineNumber":39,"content":""},{"type":"INSERT","lineNumber":40,"content":"  bool get canCreatePurchaseOrder => hasPermission(PermissionType.createPurchaseOrder);"},{"type":"INSERT","lineNumber":41,"content":"  bool get canApprovePurchaseOrder => hasPermission(PermissionType.approvePurchaseOrder);"},{"type":"INSERT","lineNumber":42,"content":"  bool get canCancelPurchaseOrder => hasPermission(PermissionType.cancelPurchaseOrder);"},{"type":"INSERT","lineNumber":43,"content":""},{"type":"INSERT","lineNumber":44,"content":"  Future<void> loadPurchaseOrders() async {"},{"type":"INSERT","lineNumber":45,"content":"    state = state.copyWith(status: PurchaseOrderStateStatus.loading, errorMessage: null);"},{"type":"INSERT","lineNumber":46,"content":""},{"type":"INSERT","lineNumber":47,"content":"    final result = await purchaseOrderUseCases.getAllPurchaseOrders();"},{"type":"INSERT","lineNumber":48,"content":"    result.fold("},{"type":"INSERT","lineNumber":49,"content":"      (failure) => state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Failed to load purchase orders'),"},{"type":"INSERT","lineNumber":50,"content":"      (orders) => state = state.copyWith(purchaseOrders: orders, status: PurchaseOrderStateStatus.success),"},{"type":"INSERT","lineNumber":51,"content":"    );"},{"type":"INSERT","lineNumber":52,"content":"  }"},{"type":"INSERT","lineNumber":53,"content":""},{"type":"INSERT","lineNumber":54,"content":"  Future<void> refresh() async => loadPurchaseOrders();"},{"type":"INSERT","lineNumber":55,"content":""},{"type":"INSERT","lineNumber":56,"content":"  void setSearchQuery(String query) {"},{"type":"INSERT","lineNumber":57,"content":"    _searchDebounce?.cancel();"},{"type":"INSERT","lineNumber":58,"content":"    _searchDebounce = Timer(const Duration(milliseconds: 300), () {"},{"type":"INSERT","lineNumber":59,"content":"      state = state.copyWith(searchQuery: query);"},{"type":"INSERT","lineNumber":60,"content":"    });"},{"type":"INSERT","lineNumber":61,"content":"  }"},{"type":"INSERT","lineNumber":62,"content":""},{"type":"INSERT","lineNumber":63,"content":"  void setFilterStatus(PurchaseOrderStatus? status) {"},{"type":"INSERT","lineNumber":64,"content":"    state = state.copyWith(filterStatus: status);"},{"type":"INSERT","lineNumber":65,"content":"  }"},{"type":"INSERT","lineNumber":66,"content":""},{"type":"INSERT","lineNumber":67,"content":"  void setSortBy(PurchaseOrderSortBy sortBy) {"},{"type":"INSERT","lineNumber":68,"content":"    if (state.sortBy == sortBy) {"},{"type":"INSERT","lineNumber":69,"content":"      final newOrder = state.sortOrder == PurchaseOrderSortOrder.ascending"},{"type":"INSERT","lineNumber":70,"content":"          ? PurchaseOrderSortOrder.descending"},{"type":"INSERT","lineNumber":71,"content":"          : PurchaseOrderSortOrder.ascending;"},{"type":"INSERT","lineNumber":72,"content":"      state = state.copyWith(sortOrder: newOrder);"},{"type":"INSERT","lineNumber":73,"content":"    } else {"},{"type":"INSERT","lineNumber":74,"content":"      state = state.copyWith(sortBy: sortBy, sortOrder: PurchaseOrderSortOrder.ascending);"},{"type":"INSERT","lineNumber":75,"content":"    }"},{"type":"INSERT","lineNumber":76,"content":"  }"},{"type":"INSERT","lineNumber":77,"content":""},{"type":"INSERT","lineNumber":78,"content":"  Future<void> createPurchaseOrder(PurchaseOrder order) async {"},{"type":"INSERT","lineNumber":79,"content":"    if (!canCreatePurchaseOrder) {"},{"type":"INSERT","lineNumber":80,"content":"      state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Permission denied');"},{"type":"INSERT","lineNumber":81,"content":"      return;"},{"type":"INSERT","lineNumber":82,"content":"    }"},{"type":"INSERT","lineNumber":83,"content":"    state = state.copyWith(status: PurchaseOrderStateStatus.loading);"},{"type":"INSERT","lineNumber":84,"content":"    final result = await purchaseOrderUseCases.createPurchaseOrder(order);"},{"type":"INSERT","lineNumber":85,"content":"    result.fold("},{"type":"INSERT","lineNumber":86,"content":"      (failure) => state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Failed to create purchase order'),"},{"type":"INSERT","lineNumber":87,"content":"      (_) => loadPurchaseOrders(),"},{"type":"INSERT","lineNumber":88,"content":"    );"},{"type":"INSERT","lineNumber":89,"content":"  }"},{"type":"INSERT","lineNumber":91,"content":"  Future<void> approvePurchaseOrder(String orderId) async {"},{"type":"INSERT","lineNumber":92,"content":"    if (!canApprovePurchaseOrder) {"},{"type":"INSERT","lineNumber":93,"content":"      state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Permission denied');"},{"type":"INSERT","lineNumber":94,"content":"      return;"},{"type":"INSERT","lineNumber":95,"content":"    }"},{"type":"INSERT","lineNumber":96,"content":"    state = state.copyWith(status: PurchaseOrderStateStatus.loading);"},{"type":"INSERT","lineNumber":97,"content":"    final result = await purchaseOrderUseCases.approvePurchaseOrder(orderId);"},{"type":"INSERT","lineNumber":98,"content":"    result.fold("},{"type":"INSERT","lineNumber":99,"content":"      (failure) => state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Failed to approve purchase order'),"},{"type":"INSERT","lineNumber":100,"content":"      (_) => loadPurchaseOrders(),"},{"type":"INSERT","lineNumber":101,"content":"    );"},{"type":"INSERT","lineNumber":102,"content":"  }"},{"type":"INSERT","lineNumber":103,"content":""},{"type":"INSERT","lineNumber":104,"content":"  Future<void> cancelPurchaseOrder(String orderId) async {"},{"type":"INSERT","lineNumber":105,"content":"    if (!canCancelPurchaseOrder) {"},{"type":"INSERT","lineNumber":106,"content":"      state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Permission denied');"},{"type":"INSERT","lineNumber":107,"content":"      return;"},{"type":"INSERT","lineNumber":108,"content":"    }"},{"type":"INSERT","lineNumber":109,"content":"    state = state.copyWith(status: PurchaseOrderStateStatus.loading);"},{"type":"INSERT","lineNumber":110,"content":"    final result = await purchaseOrderUseCases.cancelPurchaseOrder(orderId);"},{"type":"INSERT","lineNumber":111,"content":"    result.fold("},{"type":"INSERT","lineNumber":112,"content":"      (failure) => state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Failed to cancel purchase order'),"},{"type":"INSERT","lineNumber":113,"content":"      (_) => loadPurchaseOrders(),"},{"type":"INSERT","lineNumber":114,"content":"    );"},{"type":"INSERT","lineNumber":115,"content":"  }"},{"type":"INSERT","lineNumber":116,"content":""},{"type":"INSERT","lineNumber":117,"content":"  @override"},{"type":"INSERT","lineNumber":118,"content":"  void dispose() {"},{"type":"INSERT","lineNumber":119,"content":"    _searchDebounce?.cancel();"},{"type":"INSERT","lineNumber":120,"content":"    super.dispose();"},{"type":"INSERT","lineNumber":121,"content":"  }"},{"type":"INSERT","lineNumber":123,"content":""}]},{"timestamp":1755118365723,"changes":[{"type":"DELETE","lineNumber":2,"oldContent":"  final PurchaseOrderUseCases purchaseOrderUseCases;"},{"type":"DELETE","lineNumber":4,"oldContent":"  "},{"type":"DELETE","lineNumber":6,"oldContent":"}"},{"type":"DELETE","lineNumber":9,"oldContent":""},{"type":"DELETE","lineNumber":10,"oldContent":"  }"},{"type":"DELETE","lineNumber":12,"oldContent":"    super.dispose();"},{"type":"DELETE","lineNumber":14,"oldContent":"    _searchDebounce?.cancel();"},{"type":"DELETE","lineNumber":16,"oldContent":"  void dispose() {"},{"type":"DELETE","lineNumber":18,"oldContent":"  @override"},{"type":"DELETE","lineNumber":21,"oldContent":""},{"type":"DELETE","lineNumber":22,"oldContent":"  }"},{"type":"DELETE","lineNumber":24,"oldContent":"    );"},{"type":"DELETE","lineNumber":25,"oldContent":"      (_) => loadPurchaseOrders(),"},{"type":"INSERT","lineNumber":13,"content":"  final PurchaseOrderUseCases purchaseOrderUseCases;"},{"type":"DELETE","lineNumber":27,"oldContent":"      (failure) => state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Failed to cancel purchase order'),"},{"type":"DELETE","lineNumber":29,"oldContent":"    result.fold("},{"type":"DELETE","lineNumber":31,"oldContent":"    final result = await purchaseOrderUseCases.cancelPurchaseOrder(orderId);"},{"type":"DELETE","lineNumber":33,"oldContent":"    state = state.copyWith(status: PurchaseOrderStateStatus.loading);"},{"type":"DELETE","lineNumber":35,"oldContent":"    }"},{"type":"DELETE","lineNumber":37,"oldContent":"      return;"},{"type":"DELETE","lineNumber":39,"oldContent":"      state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Permission denied');"},{"type":"DELETE","lineNumber":41,"oldContent":"    if (!canCancelPurchaseOrder) {"},{"type":"DELETE","lineNumber":43,"oldContent":"  Future<void> cancelPurchaseOrder(String orderId) async {"},{"type":"DELETE","lineNumber":45,"oldContent":""},{"type":"DELETE","lineNumber":47,"oldContent":"  }"},{"type":"DELETE","lineNumber":49,"oldContent":"    );"},{"type":"DELETE","lineNumber":51,"oldContent":"      (_) => loadPurchaseOrders(),"},{"type":"DELETE","lineNumber":53,"oldContent":"      (failure) => state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Failed to approve purchase order'),"},{"type":"DELETE","lineNumber":55,"oldContent":"    result.fold("},{"type":"DELETE","lineNumber":57,"oldContent":"    final result = await purchaseOrderUseCases.approvePurchaseOrder(orderId);"},{"type":"DELETE","lineNumber":59,"oldContent":"    state = state.copyWith(status: PurchaseOrderStateStatus.loading);"},{"type":"DELETE","lineNumber":61,"oldContent":"    }"},{"type":"DELETE","lineNumber":63,"oldContent":"      return;"},{"type":"DELETE","lineNumber":65,"oldContent":"      state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Permission denied');"},{"type":"DELETE","lineNumber":67,"oldContent":"    if (!canApprovePurchaseOrder) {"},{"type":"DELETE","lineNumber":69,"oldContent":"  Future<void> approvePurchaseOrder(String orderId) async {"},{"type":"DELETE","lineNumber":71,"oldContent":"  }"},{"type":"DELETE","lineNumber":73,"oldContent":"    );"},{"type":"DELETE","lineNumber":75,"oldContent":"      (_) => loadPurchaseOrders(),"},{"type":"DELETE","lineNumber":77,"oldContent":"      (failure) => state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Failed to create purchase order'),"},{"type":"DELETE","lineNumber":78,"oldContent":"  bool get canCreatePurchaseOrder => hasPermission(PermissionType.createPurchaseOrder);"},{"type":"DELETE","lineNumber":79,"oldContent":"    result.fold("},{"type":"DELETE","lineNumber":80,"oldContent":"  bool get canApprovePurchaseOrder => hasPermission(PermissionType.approvePurchaseOrder);"},{"type":"DELETE","lineNumber":81,"oldContent":"    final result = await purchaseOrderUseCases.createPurchaseOrder(order);"},{"type":"DELETE","lineNumber":82,"oldContent":"  bool get canCancelPurchaseOrder => hasPermission(PermissionType.cancelPurchaseOrder);"},{"type":"DELETE","lineNumber":83,"oldContent":"    state = state.copyWith(status: PurchaseOrderStateStatus.loading);"},{"type":"INSERT","lineNumber":40,"content":"  bool get canCreatePurchaseOrder => hasPermission(PermissionType.createOrder);"},{"type":"INSERT","lineNumber":41,"content":"  bool get canApprovePurchaseOrder => hasPermission(PermissionType.approveOrder);"},{"type":"INSERT","lineNumber":42,"content":"  bool get canCancelPurchaseOrder => hasPermission(PermissionType.approveOrder);"},{"type":"DELETE","lineNumber":85,"oldContent":"    }"},{"type":"DELETE","lineNumber":87,"oldContent":"      return;"},{"type":"DELETE","lineNumber":89,"oldContent":"      state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Permission denied');"},{"type":"DELETE","lineNumber":91,"oldContent":"    if (!canCreatePurchaseOrder) {"},{"type":"DELETE","lineNumber":93,"oldContent":"  Future<void> createPurchaseOrder(PurchaseOrder order) async {"},{"type":"DELETE","lineNumber":95,"oldContent":""},{"type":"DELETE","lineNumber":97,"oldContent":"  }"},{"type":"DELETE","lineNumber":99,"oldContent":"    }"},{"type":"DELETE","lineNumber":101,"oldContent":"      state = state.copyWith(sortBy: sortBy, sortOrder: PurchaseOrderSortOrder.ascending);"},{"type":"DELETE","lineNumber":103,"oldContent":"    } else {"},{"type":"DELETE","lineNumber":105,"oldContent":"      state = state.copyWith(sortOrder: newOrder);"},{"type":"DELETE","lineNumber":107,"oldContent":"          : PurchaseOrderSortOrder.ascending;"},{"type":"DELETE","lineNumber":109,"oldContent":"          ? PurchaseOrderSortOrder.descending"},{"type":"DELETE","lineNumber":111,"oldContent":"      final newOrder = state.sortOrder == PurchaseOrderSortOrder.ascending"},{"type":"DELETE","lineNumber":113,"oldContent":"    if (state.sortBy == sortBy) {"},{"type":"DELETE","lineNumber":115,"oldContent":"  void setSortBy(PurchaseOrderSortBy sortBy) {"},{"type":"DELETE","lineNumber":117,"oldContent":""},{"type":"DELETE","lineNumber":120,"oldContent":"  }"},{"type":"DELETE","lineNumber":121,"oldContent":"    state = state.copyWith(filterStatus: status);"},{"type":"INSERT","lineNumber":64,"content":"    state = state.copyWith(filterStatus: status);"},{"type":"INSERT","lineNumber":65,"content":"  }"},{"type":"INSERT","lineNumber":66,"content":""},{"type":"INSERT","lineNumber":67,"content":"  void setSortBy(PurchaseOrderSortBy sortBy) {"},{"type":"INSERT","lineNumber":68,"content":"    if (state.sortBy == sortBy) {"},{"type":"INSERT","lineNumber":69,"content":"      final newOrder = state.sortOrder == PurchaseOrderSortOrder.ascending"},{"type":"INSERT","lineNumber":70,"content":"          ? PurchaseOrderSortOrder.descending"},{"type":"INSERT","lineNumber":71,"content":"          : PurchaseOrderSortOrder.ascending;"},{"type":"INSERT","lineNumber":72,"content":"      state = state.copyWith(sortOrder: newOrder);"},{"type":"INSERT","lineNumber":73,"content":"    } else {"},{"type":"INSERT","lineNumber":74,"content":"      state = state.copyWith(sortBy: sortBy, sortOrder: PurchaseOrderSortOrder.ascending);"},{"type":"INSERT","lineNumber":75,"content":"    }"},{"type":"INSERT","lineNumber":76,"content":"  }"},{"type":"INSERT","lineNumber":77,"content":""},{"type":"INSERT","lineNumber":78,"content":"  Future<void> createPurchaseOrder(PurchaseOrder order) async {"},{"type":"INSERT","lineNumber":79,"content":"    if (!canCreatePurchaseOrder) {"},{"type":"INSERT","lineNumber":80,"content":"      state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Permission denied');"},{"type":"INSERT","lineNumber":81,"content":"      return;"},{"type":"INSERT","lineNumber":82,"content":"    }"},{"type":"INSERT","lineNumber":83,"content":"    state = state.copyWith(status: PurchaseOrderStateStatus.loading);"},{"type":"INSERT","lineNumber":84,"content":"    final result = await purchaseOrderUseCases.createPurchaseOrder(order);"},{"type":"INSERT","lineNumber":85,"content":"    result.fold("},{"type":"INSERT","lineNumber":86,"content":"      (failure) => state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Failed to create purchase order'),"},{"type":"INSERT","lineNumber":87,"content":"      (_) => loadPurchaseOrders(),"},{"type":"INSERT","lineNumber":88,"content":"    );"},{"type":"INSERT","lineNumber":89,"content":"  }"},{"type":"INSERT","lineNumber":90,"content":"  "},{"type":"INSERT","lineNumber":91,"content":"  Future<void> approvePurchaseOrder(String orderId) async {"},{"type":"INSERT","lineNumber":92,"content":"    if (!canApprovePurchaseOrder) {"},{"type":"INSERT","lineNumber":93,"content":"      state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Permission denied');"},{"type":"INSERT","lineNumber":94,"content":"      return;"},{"type":"INSERT","lineNumber":95,"content":"    }"},{"type":"INSERT","lineNumber":96,"content":"    state = state.copyWith(status: PurchaseOrderStateStatus.loading);"},{"type":"INSERT","lineNumber":97,"content":"    final result = await purchaseOrderUseCases.approvePurchaseOrder(orderId, state.currentUser!.id);"},{"type":"INSERT","lineNumber":98,"content":"    result.fold("},{"type":"INSERT","lineNumber":99,"content":"      (failure) => state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Failed to approve purchase order'),"},{"type":"INSERT","lineNumber":100,"content":"      (_) => loadPurchaseOrders(),"},{"type":"INSERT","lineNumber":101,"content":"    );"},{"type":"INSERT","lineNumber":102,"content":"  }"},{"type":"INSERT","lineNumber":103,"content":""},{"type":"INSERT","lineNumber":104,"content":"  Future<void> cancelPurchaseOrder(String orderId, String reason) async {"},{"type":"INSERT","lineNumber":105,"content":"    if (!canCancelPurchaseOrder) {"},{"type":"INSERT","lineNumber":106,"content":"      state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Permission denied');"},{"type":"INSERT","lineNumber":107,"content":"      return;"},{"type":"INSERT","lineNumber":108,"content":"    }"},{"type":"INSERT","lineNumber":109,"content":"    state = state.copyWith(status: PurchaseOrderStateStatus.loading);"},{"type":"INSERT","lineNumber":110,"content":"    final result = await purchaseOrderUseCases.cancelPurchaseOrder(orderId, reason);"},{"type":"INSERT","lineNumber":111,"content":"    result.fold("},{"type":"INSERT","lineNumber":112,"content":"      (failure) => state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Failed to cancel purchase order'),"},{"type":"INSERT","lineNumber":113,"content":"      (_) => loadPurchaseOrders(),"},{"type":"INSERT","lineNumber":114,"content":"    );"},{"type":"INSERT","lineNumber":115,"content":"  }"},{"type":"INSERT","lineNumber":116,"content":""},{"type":"INSERT","lineNumber":117,"content":"  @override"},{"type":"INSERT","lineNumber":118,"content":"  void dispose() {"},{"type":"INSERT","lineNumber":119,"content":"    _searchDebounce?.cancel();"},{"type":"INSERT","lineNumber":120,"content":"    super.dispose();"},{"type":"INSERT","lineNumber":121,"content":"  }"},{"type":"INSERT","lineNumber":122,"content":"}"},{"type":"INSERT","lineNumber":123,"content":""}]},{"timestamp":1755119353032,"changes":[{"type":"DELETE","lineNumber":7,"oldContent":"  final PurchaseOrderUseCases purchaseOrderUseCases;"},{"type":"INSERT","lineNumber":13,"content":"  final PurchaseOrderUseCases purchaseOrderUseCases;"},{"type":"DELETE","lineNumber":21,"oldContent":"  bool get canCreatePurchaseOrder => hasPermission(PermissionType.createOrder);"},{"type":"DELETE","lineNumber":23,"oldContent":"  bool get canApprovePurchaseOrder => hasPermission(PermissionType.approveOrder);"},{"type":"DELETE","lineNumber":24,"oldContent":"  bool get canCancelPurchaseOrder => hasPermission(PermissionType.approveOrder);"},{"type":"DELETE","lineNumber":36,"oldContent":"    state = state.copyWith(filterStatus: status);"},{"type":"INSERT","lineNumber":34,"content":"    );"},{"type":"INSERT","lineNumber":37,"content":"  bool hasPermission(PermissionType permission) =>"},{"type":"INSERT","lineNumber":38,"content":"      state.currentUser?.hasPermission(permission) ?? false;"},{"type":"INSERT","lineNumber":39,"content":""},{"type":"INSERT","lineNumber":40,"content":"  bool get canCreatePurchaseOrder => hasPermission(PermissionType.createOrder);"},{"type":"INSERT","lineNumber":41,"content":"  bool get canApprovePurchaseOrder => hasPermission(PermissionType.approveOrder);"},{"type":"INSERT","lineNumber":42,"content":"  bool get canCancelPurchaseOrder => hasPermission(PermissionType.approveOrder);"},{"type":"INSERT","lineNumber":43,"content":""},{"type":"INSERT","lineNumber":44,"content":"  Future<void> loadPurchaseOrders() async {"},{"type":"INSERT","lineNumber":45,"content":"    state = state.copyWith(status: PurchaseOrderStateStatus.loading, errorMessage: null);"},{"type":"INSERT","lineNumber":46,"content":""},{"type":"INSERT","lineNumber":47,"content":"    final result = await purchaseOrderUseCases.getAllPurchaseOrders();"},{"type":"INSERT","lineNumber":48,"content":"    result.fold("},{"type":"INSERT","lineNumber":49,"content":"      (failure) => state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Failed to load purchase orders'),"},{"type":"INSERT","lineNumber":50,"content":"      (orders) => state = state.copyWith(purchaseOrders: orders, status: PurchaseOrderStateStatus.success),"},{"type":"INSERT","lineNumber":52,"content":"  }"},{"type":"INSERT","lineNumber":53,"content":""},{"type":"INSERT","lineNumber":54,"content":"  Future<void> refresh() async => loadPurchaseOrders();"},{"type":"INSERT","lineNumber":55,"content":""},{"type":"INSERT","lineNumber":56,"content":"  void setSearchQuery(String query) {"},{"type":"INSERT","lineNumber":57,"content":"    _searchDebounce?.cancel();"},{"type":"INSERT","lineNumber":58,"content":"    _searchDebounce = Timer(const Duration(milliseconds: 300), () {"},{"type":"INSERT","lineNumber":59,"content":"      state = state.copyWith(searchQuery: query);"},{"type":"INSERT","lineNumber":60,"content":"    });"},{"type":"INSERT","lineNumber":61,"content":"  }"},{"type":"INSERT","lineNumber":62,"content":""},{"type":"INSERT","lineNumber":63,"content":"  void setFilterStatus(PurchaseOrderStatus? status) {"},{"type":"INSERT","lineNumber":64,"content":"    state = state.copyWith(filterStatus: status);"},{"type":"INSERT","lineNumber":65,"content":"  }"},{"type":"INSERT","lineNumber":66,"content":""},{"type":"DELETE","lineNumber":43,"oldContent":"  }"},{"type":"DELETE","lineNumber":46,"oldContent":""},{"type":"DELETE","lineNumber":49,"oldContent":"  bool hasPermission(PermissionType permission) =>"},{"type":"DELETE","lineNumber":52,"oldContent":"      state.currentUser?.hasPermission(permission) ?? false;"},{"type":"DELETE","lineNumber":56,"oldContent":""},{"type":"DELETE","lineNumber":64,"oldContent":""},{"type":"DELETE","lineNumber":67,"oldContent":"  Future<void> loadPurchaseOrders() async {"},{"type":"DELETE","lineNumber":70,"oldContent":"    state = state.copyWith(status: PurchaseOrderStateStatus.loading, errorMessage: null);"},{"type":"DELETE","lineNumber":73,"oldContent":""},{"type":"DELETE","lineNumber":76,"oldContent":"    final result = await purchaseOrderUseCases.getAllPurchaseOrders();"},{"type":"DELETE","lineNumber":79,"oldContent":"    result.fold("},{"type":"DELETE","lineNumber":82,"oldContent":"      (failure) => state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Failed to load purchase orders'),"},{"type":"DELETE","lineNumber":85,"oldContent":"      (orders) => state = state.copyWith(purchaseOrders: orders, status: PurchaseOrderStateStatus.success),"},{"type":"DELETE","lineNumber":89,"oldContent":"    );"},{"type":"DELETE","lineNumber":91,"oldContent":"  }"},{"type":"DELETE","lineNumber":94,"oldContent":""},{"type":"DELETE","lineNumber":97,"oldContent":"  Future<void> refresh() async => loadPurchaseOrders();"},{"type":"DELETE","lineNumber":100,"oldContent":""},{"type":"DELETE","lineNumber":103,"oldContent":"  void setSearchQuery(String query) {"},{"type":"DELETE","lineNumber":104,"oldContent":"    result.fold("},{"type":"DELETE","lineNumber":105,"oldContent":"      (failure) => state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Failed to cancel purchase order'),"},{"type":"DELETE","lineNumber":106,"oldContent":"    _searchDebounce?.cancel();"},{"type":"DELETE","lineNumber":107,"oldContent":"      (_) => loadPurchaseOrders(),"},{"type":"DELETE","lineNumber":108,"oldContent":"    );"},{"type":"DELETE","lineNumber":109,"oldContent":"    _searchDebounce = Timer(const Duration(milliseconds: 300), () {"},{"type":"INSERT","lineNumber":111,"content":"    "},{"type":"DELETE","lineNumber":112,"oldContent":"      state = state.copyWith(searchQuery: query);"},{"type":"DELETE","lineNumber":115,"oldContent":"    });"},{"type":"DELETE","lineNumber":117,"oldContent":"  }"},{"type":"DELETE","lineNumber":122,"oldContent":""},{"type":"DELETE","lineNumber":123,"oldContent":"  void setFilterStatus(PurchaseOrderStatus? status) {"}]},{"timestamp":1755119356159,"changes":[{"type":"MODIFY","lineNumber":13,"content":"  final PurchaseOrderUseCases purchaseOrderUseCases;","oldContent":"  final PurchaseOrderUseCases purchaseOrderUseCases;"},{"type":"DELETE","lineNumber":31,"oldContent":"    );"},{"type":"DELETE","lineNumber":34,"oldContent":"  bool hasPermission(PermissionType permission) =>"},{"type":"DELETE","lineNumber":36,"oldContent":"      state.currentUser?.hasPermission(permission) ?? false;"},{"type":"INSERT","lineNumber":34,"content":"    );"},{"type":"INSERT","lineNumber":37,"content":"  bool hasPermission(PermissionType permission) =>"},{"type":"INSERT","lineNumber":38,"content":"      state.currentUser?.hasPermission(permission) ?? false;"},{"type":"DELETE","lineNumber":41,"oldContent":"    );"},{"type":"DELETE","lineNumber":43,"oldContent":"  void setSortBy(PurchaseOrderSortBy sortBy) {"},{"type":"DELETE","lineNumber":45,"oldContent":"    if (state.sortBy == sortBy) {"},{"type":"DELETE","lineNumber":48,"oldContent":"      final newOrder = state.sortOrder == PurchaseOrderSortOrder.ascending"},{"type":"DELETE","lineNumber":50,"oldContent":"          ? PurchaseOrderSortOrder.descending"},{"type":"DELETE","lineNumber":53,"oldContent":"          : PurchaseOrderSortOrder.ascending;"},{"type":"DELETE","lineNumber":55,"oldContent":"      state = state.copyWith(sortOrder: newOrder);"},{"type":"DELETE","lineNumber":58,"oldContent":"    } else {"},{"type":"DELETE","lineNumber":59,"oldContent":"      state = state.copyWith(sortBy: sortBy, sortOrder: PurchaseOrderSortOrder.ascending);"},{"type":"INSERT","lineNumber":51,"content":"    );"},{"type":"DELETE","lineNumber":62,"oldContent":"    }"},{"type":"DELETE","lineNumber":64,"oldContent":"  }"},{"type":"DELETE","lineNumber":66,"oldContent":""},{"type":"DELETE","lineNumber":69,"oldContent":"  Future<void> createPurchaseOrder(PurchaseOrder order) async {"},{"type":"DELETE","lineNumber":71,"oldContent":"    if (!canCreatePurchaseOrder) {"},{"type":"DELETE","lineNumber":73,"oldContent":"      state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Permission denied');"},{"type":"DELETE","lineNumber":75,"oldContent":"      return;"},{"type":"DELETE","lineNumber":77,"oldContent":"    }"},{"type":"DELETE","lineNumber":79,"oldContent":"    state = state.copyWith(status: PurchaseOrderStateStatus.loading);"},{"type":"DELETE","lineNumber":81,"oldContent":"    final result = await purchaseOrderUseCases.createPurchaseOrder(order);"},{"type":"DELETE","lineNumber":84,"oldContent":"    result.fold("},{"type":"INSERT","lineNumber":67,"content":"  void setSortBy(PurchaseOrderSortBy sortBy) {"},{"type":"INSERT","lineNumber":68,"content":"    if (state.sortBy == sortBy) {"},{"type":"INSERT","lineNumber":69,"content":"      final newOrder = state.sortOrder == PurchaseOrderSortOrder.ascending"},{"type":"INSERT","lineNumber":70,"content":"          ? PurchaseOrderSortOrder.descending"},{"type":"INSERT","lineNumber":71,"content":"          : PurchaseOrderSortOrder.ascending;"},{"type":"INSERT","lineNumber":72,"content":"      state = state.copyWith(sortOrder: newOrder);"},{"type":"INSERT","lineNumber":73,"content":"    } else {"},{"type":"INSERT","lineNumber":74,"content":"      state = state.copyWith(sortBy: sortBy, sortOrder: PurchaseOrderSortOrder.ascending);"},{"type":"INSERT","lineNumber":75,"content":"    }"},{"type":"INSERT","lineNumber":76,"content":"  }"},{"type":"INSERT","lineNumber":77,"content":""},{"type":"INSERT","lineNumber":78,"content":"  Future<void> createPurchaseOrder(PurchaseOrder order) async {"},{"type":"INSERT","lineNumber":79,"content":"    if (!canCreatePurchaseOrder) {"},{"type":"INSERT","lineNumber":80,"content":"      state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Permission denied');"},{"type":"INSERT","lineNumber":81,"content":"      return;"},{"type":"INSERT","lineNumber":82,"content":"    }"},{"type":"INSERT","lineNumber":83,"content":"    state = state.copyWith(status: PurchaseOrderStateStatus.loading);"},{"type":"INSERT","lineNumber":84,"content":"    final result = await purchaseOrderUseCases.createPurchaseOrder(order);"},{"type":"INSERT","lineNumber":85,"content":"    result.fold("},{"type":"INSERT","lineNumber":111,"content":"    result.fold("},{"type":"INSERT","lineNumber":112,"content":"      (failure) => state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Failed to cancel purchase order'),"},{"type":"INSERT","lineNumber":113,"content":"      (_) => loadPurchaseOrders(),"},{"type":"INSERT","lineNumber":114,"content":"    );"},{"type":"DELETE","lineNumber":112,"oldContent":"    "}]},{"timestamp":1755119358444,"changes":[{"type":"INSERT","lineNumber":12,"content":"class PurchaseOrderViewModel extends StateNotifier<PurchaseOrderState> {"},{"type":"DELETE","lineNumber":13,"oldContent":"  final PurchaseOrderUseCases purchaseOrderUseCases;"},{"type":"DELETE","lineNumber":33,"oldContent":"    );"},{"type":"DELETE","lineNumber":35,"oldContent":"  bool hasPermission(PermissionType permission) =>"},{"type":"INSERT","lineNumber":34,"content":"    );"},{"type":"INSERT","lineNumber":36,"content":""},{"type":"INSERT","lineNumber":37,"content":"  bool hasPermission(PermissionType permission) =>"},{"type":"DELETE","lineNumber":39,"oldContent":""},{"type":"DELETE","lineNumber":46,"oldContent":"    );"},{"type":"INSERT","lineNumber":51,"content":"    );"},{"type":"DELETE","lineNumber":56,"oldContent":"  void setSortBy(PurchaseOrderSortBy sortBy) {"},{"type":"MODIFY","lineNumber":58,"content":"    _searchDebounce = Timer(const Duration(milliseconds: 300), () {","oldContent":"    if (state.sortBy == sortBy) {"},{"type":"INSERT","lineNumber":59,"content":"      state = state.copyWith(searchQuery: query);"},{"type":"INSERT","lineNumber":60,"content":"    });"},{"type":"INSERT","lineNumber":61,"content":"  }"},{"type":"INSERT","lineNumber":62,"content":""},{"type":"INSERT","lineNumber":63,"content":"  void setFilterStatus(PurchaseOrderStatus? status) {"},{"type":"INSERT","lineNumber":64,"content":"    state = state.copyWith(filterStatus: status);"},{"type":"INSERT","lineNumber":65,"content":"  }"},{"type":"INSERT","lineNumber":66,"content":""},{"type":"INSERT","lineNumber":67,"content":"  void setSortBy(PurchaseOrderSortBy sortBy) {"},{"type":"INSERT","lineNumber":68,"content":"    if (state.sortBy == sortBy) {"},{"type":"DELETE","lineNumber":62,"oldContent":"    _searchDebounce = Timer(const Duration(milliseconds: 300), () {"},{"type":"DELETE","lineNumber":65,"oldContent":"      state = state.copyWith(searchQuery: query);"},{"type":"DELETE","lineNumber":68,"oldContent":"    });"},{"type":"DELETE","lineNumber":71,"oldContent":"  }"},{"type":"DELETE","lineNumber":74,"oldContent":""},{"type":"DELETE","lineNumber":77,"oldContent":"  void setFilterStatus(PurchaseOrderStatus? status) {"},{"type":"DELETE","lineNumber":80,"oldContent":"    state = state.copyWith(filterStatus: status);"},{"type":"DELETE","lineNumber":82,"oldContent":"  }"},{"type":"DELETE","lineNumber":85,"oldContent":""},{"type":"MODIFY","lineNumber":111,"content":"    ","oldContent":"    result.fold("},{"type":"DELETE","lineNumber":113,"oldContent":"      (failure) => state = state.copyWith(status: PurchaseOrderStateStatus.error, errorMessage: 'Failed to cancel purchase order'),"},{"type":"DELETE","lineNumber":114,"oldContent":"      (_) => loadPurchaseOrders(),"},{"type":"DELETE","lineNumber":116,"oldContent":"    );"}]},{"timestamp":1755119360599,"changes":[{"type":"DELETE","lineNumber":33,"oldContent":"    );"},{"type":"DELETE","lineNumber":35,"oldContent":""},{"type":"INSERT","lineNumber":34,"content":"    );"},{"type":"INSERT","lineNumber":36,"content":""},{"type":"MODIFY","lineNumber":51,"content":"    );","oldContent":"    );"},{"type":"INSERT","lineNumber":57,"content":"    _searchDebounce?.cancel();"},{"type":"DELETE","lineNumber":59,"oldContent":"    _searchDebounce?.cancel();"},{"type":"DELETE","lineNumber":61,"oldContent":"      final newOrder = state.sortOrder == PurchaseOrderSortOrder.ascending"},{"type":"DELETE","lineNumber":63,"oldContent":"          ? PurchaseOrderSortOrder.descending"},{"type":"DELETE","lineNumber":66,"oldContent":"          : PurchaseOrderSortOrder.ascending;"},{"type":"DELETE","lineNumber":68,"oldContent":"      state = state.copyWith(sortOrder: newOrder);"},{"type":"DELETE","lineNumber":71,"oldContent":"    } else {"},{"type":"DELETE","lineNumber":73,"oldContent":"      state = state.copyWith(sortBy: sortBy, sortOrder: PurchaseOrderSortOrder.ascending);"},{"type":"INSERT","lineNumber":69,"content":"      final newOrder = state.sortOrder == PurchaseOrderSortOrder.ascending"},{"type":"INSERT","lineNumber":70,"content":"          ? PurchaseOrderSortOrder.descending"},{"type":"INSERT","lineNumber":71,"content":"          : PurchaseOrderSortOrder.ascending;"},{"type":"INSERT","lineNumber":72,"content":"      state = state.copyWith(sortOrder: newOrder);"},{"type":"INSERT","lineNumber":73,"content":"    } else {"},{"type":"INSERT","lineNumber":74,"content":"      state = state.copyWith(sortBy: sortBy, sortOrder: PurchaseOrderSortOrder.ascending);"},{"type":"MODIFY","lineNumber":111,"content":"        (_) => loadPurchaseOrders(),","oldContent":"    "},{"type":"INSERT","lineNumber":112,"content":""}]},{"timestamp":1755119364964,"changes":[{"type":"DELETE","lineNumber":33,"oldContent":"    );"},{"type":"DELETE","lineNumber":35,"oldContent":""},{"type":"INSERT","lineNumber":34,"content":"    );"},{"type":"INSERT","lineNumber":36,"content":""},{"type":"INSERT","lineNumber":50,"content":"      (orders) => state = state.copyWith(purchaseOrders: orders, status: PurchaseOrderStateStatus.success),"},{"type":"DELETE","lineNumber":51,"oldContent":"    );"},{"type":"DELETE","lineNumber":65,"oldContent":"      final newOrder = state.sortOrder == PurchaseOrderSortOrder.ascending"},{"type":"MODIFY","lineNumber":67,"content":"  void setSortBy(PurchaseOrderSortBy sortBy) {","oldContent":"          ? PurchaseOrderSortOrder.descending"},{"type":"INSERT","lineNumber":68,"content":"    if (state.sortBy == sortBy) {"},{"type":"INSERT","lineNumber":69,"content":"      final newOrder = state.sortOrder == PurchaseOrderSortOrder.ascending"},{"type":"INSERT","lineNumber":70,"content":"          ? PurchaseOrderSortOrder.descending"},{"type":"DELETE","lineNumber":71,"oldContent":"  void setSortBy(PurchaseOrderSortBy sortBy) {"},{"type":"DELETE","lineNumber":74,"oldContent":"    if (state.sortBy == sortBy) {"}]},{"timestamp":1755119374396,"changes":[{"type":"DELETE","lineNumber":33,"oldContent":"    );"},{"type":"DELETE","lineNumber":35,"oldContent":""},{"type":"INSERT","lineNumber":34,"content":"    );"},{"type":"INSERT","lineNumber":36,"content":""},{"type":"INSERT","lineNumber":66,"content":""},{"type":"DELETE","lineNumber":68,"oldContent":""},{"type":"MODIFY","lineNumber":71,"content":"          : PurchaseOrderSortOrder.ascending;","oldContent":"          : PurchaseOrderSortOrder.ascending;"},{"type":"MODIFY","lineNumber":111,"content":"        loadPurchaseOrders(),","oldContent":"        (_) => loadPurchaseOrders(),"}]},{"timestamp":1755119378663,"changes":[{"type":"DELETE","lineNumber":33,"oldContent":"    );"},{"type":"DELETE","lineNumber":35,"oldContent":""},{"type":"INSERT","lineNumber":34,"content":"    );"},{"type":"INSERT","lineNumber":36,"content":""},{"type":"INSERT","lineNumber":70,"content":"          ? PurchaseOrderSortOrder.descending"},{"type":"DELETE","lineNumber":71,"oldContent":"          : PurchaseOrderSortOrder.ascending;"},{"type":"MODIFY","lineNumber":111,"content":"        loadPurchaseOrders();","oldContent":"        loadPurchaseOrders(),"}]}]},"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/presentation/purchase_order/purchase_order_state.dart":{"filePath":"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/presentation/purchase_order/purchase_order_state.dart","baseContent":"// purchase_order_state.dart\nimport 'package:clean_arch_app/domain/entities/auth/user.dart';\nimport 'package:clean_arch_app/domain/entities/order/purchase_order.dart';\nimport 'package:clean_arch_app/core/enums/purchase_order_status.dart';\n\nenum PurchaseOrderSortBy { orderDate, deliveryDate, totalAmount }\nenum PurchaseOrderSortOrder { ascending, descending }\nenum PurchaseOrderStateStatus { initial, loading, success, error }\n\nclass PurchaseOrderState {\n  final List<PurchaseOrder> purchaseOrders;\n  final User? currentUser;\n\n  final bool isLoading;\n  final bool isBulkSelectionMode;\n  final PurchaseOrderStateStatus status;\n  final Set<String> selectedPurchaseOrderIds;\n  final String searchQuery;\n  final PurchaseOrderStatus? filterStatus;\n  final PurchaseOrderSortBy sortBy;\n  final PurchaseOrderSortOrder sortOrder;\n  final String? errorMessage;\n\n  const PurchaseOrderState({\n    this.purchaseOrders = const [],\n    this.currentUser,\n    this.status = PurchaseOrderStateStatus.initial,\n    this.selectedPurchaseOrderIds = const {},\n    this.searchQuery = '',\n    this.filterStatus,\n    this.sortBy = PurchaseOrderSortBy.orderDate,\n    this.sortOrder = PurchaseOrderSortOrder.descending,\n    this.errorMessage,\n    this.isLoading = false,\n    this.isBulkSelectionMode = false,\n  });\n\n  factory PurchaseOrderState.initial() => const PurchaseOrderState();\n\n  PurchaseOrderState copyWith({\n    List<PurchaseOrder>? purchaseOrders,\n    User? currentUser,\n    PurchaseOrderStateStatus? status,\n    Set<String>? selectedPurchaseOrderIds,\n    String? searchQuery,\n    PurchaseOrderStatus? filterStatus,\n    PurchaseOrderSortBy? sortBy,\n    PurchaseOrderSortOrder? sortOrder,\n    String? errorMessage,\n    bool? isLoading,\n    bool? isBulkSelectionMode,\n  }) {\n    return PurchaseOrderState(\n      purchaseOrders: purchaseOrders ?? this.purchaseOrders,\n      currentUser: currentUser ?? this.currentUser,\n      status: status ?? this.status,\n      selectedPurchaseOrderIds: selectedPurchaseOrderIds ?? this.selectedPurchaseOrderIds,\n      searchQuery: searchQuery ?? this.searchQuery,\n      filterStatus: filterStatus ?? this.filterStatus,\n      sortBy: sortBy ?? this.sortBy,\n      sortOrder: sortOrder ?? this.sortOrder,\n      errorMessage: errorMessage ?? this.errorMessage,\n      isLoading: isLoading ?? this.isLoading,\n      isBulkSelectionMode: isBulkSelectionMode ?? this.isBulkSelectionMode,\n    );\n  }\n\n  bool get hasSelection => selectedPurchaseOrderIds.isNotEmpty;\n  int get selectedCount => selectedPurchaseOrderIds.length;\n  bool get allSelected => purchaseOrders.isNotEmpty && selectedPurchaseOrderIds.length == purchaseOrders.length;\n\n  List<PurchaseOrder> get filteredPurchaseOrders {\n    var list = List<PurchaseOrder>.from(purchaseOrders);\n\n    if (searchQuery.isNotEmpty) {\n      list = list.where((order) =>\n          order.id.toLowerCase().contains(searchQuery.toLowerCase())).toList();\n    }\n\n    if (filterStatus != null) {\n      list = list.where((order) => order.status == filterStatus!.name).toList();\n    }\n\n    list.sort((a, b) {\n      int cmp = 0;\n      switch (sortBy) {\n        case PurchaseOrderSortBy.orderDate:\n          cmp = a.createdAt.compareTo(b.createdAt);\n          break;\n        case PurchaseOrderSortBy.deliveryDate:\n          cmp = (a.expectedDeliveryDate ?? DateTime(0)).compareTo(b.expectedDeliveryDate ?? DateTime(0));\n          break;\n        case PurchaseOrderSortBy.totalAmount:\n          cmp = a.totalAmount.compareTo(b.totalAmount);\n          break;\n      }\n      return sortOrder == PurchaseOrderSortOrder.ascending ? cmp : -cmp;\n    });\n\n    return list;\n  }\n}\n","baseTimestamp":1755118263234},"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/domain/usecases/order/approve_purchase_order_usecase.dart":{"filePath":"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/domain/usecases/order/approve_purchase_order_usecase.dart","baseContent":"\nimport 'package:clean_arch_app/domain/entities/order/purchase_order.dart';\nimport 'package:clean_arch_app/domain/repositories/purchase_order_repository.dart';\nimport 'package:dartz/dartz.dart';\n\nclass ApprovePurchaseOrderUseCase {\n  final PurchaseOrderRepository repository;\n\n  ApprovePurchaseOrderUseCase(this.repository);\n\n  Future<Either<>PurchaseOrder> call(String id,String userId) {\n    return repository.approvePurchaseOrder(id ,userId);\n  }\n}\n","baseTimestamp":1755119086905,"deltas":[{"timestamp":1755119096301,"changes":[{"type":"INSERT","lineNumber":1,"content":"import 'package:clean_arch_app/core/error/failures.dart';"},{"type":"MODIFY","lineNumber":11,"content":"  Future<Either<Failure,PurchaseOrder> call(String id,String userId) {","oldContent":"  Future<Either<>PurchaseOrder> call(String id,String userId) {"}]},{"timestamp":1755119099347,"changes":[{"type":"DELETE","lineNumber":11,"oldContent":"  Future<Either<>PurchaseOrder> call(String id,String userId) {"},{"type":"MODIFY","lineNumber":11,"content":"  Future<Either<Failure,PurchaseOrder>> call(String id,String userId) {","oldContent":"  Future<Either<Failure,PurchaseOrder> call(String id,String userId) {"},{"type":"INSERT","lineNumber":12,"content":"    return repository.approvePurchaseOrder(id ,userId);"}]}]},"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/domain/usecases/order/delete_purchase_order_usecase.dart":{"filePath":"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/domain/usecases/order/delete_purchase_order_usecase.dart","baseContent":"import 'package:clean_arch_app/domain/repositories/purchase_order_repository.dart';\n\nclass DeletePurchaseOrderUseCase {\n  final PurchaseOrderRepository repository;\n\n  DeletePurchaseOrderUseCase(this.repository);\n\n  Future<Either<Failure,PurchaseOrder>>  call(String id) async {\n    return await repository.deletePurchaseOrder(id);\n  }\n}\n","baseTimestamp":1755119138646,"deltas":[{"timestamp":1755119141931,"changes":[{"type":"MODIFY","lineNumber":7,"content":"  Future<Either<Failure,void>>  call(String id) async {","oldContent":"  Future<Either<Failure,PurchaseOrder>>  call(String id) async {"}]},{"timestamp":1755119144957,"changes":[{"type":"INSERT","lineNumber":2,"content":"import '../../../core/error/failures.dart' show Failure;"},{"type":"INSERT","lineNumber":3,"content":""}]},{"timestamp":1755119147090,"changes":[{"type":"INSERT","lineNumber":1,"content":"import 'package:dartz/dartz.dart';"},{"type":"DELETE","lineNumber":3,"oldContent":"class DeletePurchaseOrderUseCase {"},{"type":"INSERT","lineNumber":5,"content":"class DeletePurchaseOrderUseCase {"}]}]},"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/domain/usecases/order/filter_purchase_orders_usecase.dart":{"filePath":"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/domain/usecases/order/filter_purchase_orders_usecase.dart","baseContent":"\nimport 'package:clean_arch_app/domain/entities/order/purchase_order.dart';\nimport 'package:clean_arch_app/domain/repositories/purchase_order_repository.dart';\nimport 'package:dartz/dartz.dart';\n\nclass FilterPurchaseOrdersUseCase {\n  final PurchaseOrderRepository repository;\n\n  FilterPurchaseOrdersUseCase(this.repository);\n\n  Future<Either<>List<PurchaseOrder>> call({String? status, String? supplierId}) {\n    return repository.filterPurchaseOrders(status,  supplierId);\n  }\n}\n","baseTimestamp":1755119160938,"deltas":[{"timestamp":1755119168525,"changes":[{"type":"INSERT","lineNumber":1,"content":"import 'package:clean_arch_app/core/error/failures.dart';"},{"type":"MODIFY","lineNumber":11,"content":"  Future<Either<Failure,List<PurchaseOrder>> call({String? status, String? supplierId}) {","oldContent":"  Future<Either<>List<PurchaseOrder>> call({String? status, String? supplierId}) {"}]},{"timestamp":1755119171959,"changes":[{"type":"DELETE","lineNumber":11,"oldContent":"  Future<Either<>List<PurchaseOrder>> call({String? status, String? supplierId}) {"},{"type":"MODIFY","lineNumber":11,"content":"  Future<Either<Failure,List<PurchaseOrder>>> call({String? status, String? supplierId}) {","oldContent":"  Future<Either<Failure,List<PurchaseOrder>> call({String? status, String? supplierId}) {"},{"type":"INSERT","lineNumber":12,"content":"    return repository.filterPurchaseOrders(status,  supplierId);"}]}]},"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/domain/usecases/order/get_all_purchase_orders_usecase.dart":{"filePath":"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/domain/usecases/order/get_all_purchase_orders_usecase.dart","baseContent":"import 'package:clean_arch_app/domain/entities/order/purchase_order.dart';\nimport 'package:clean_arch_app/domain/repositories/purchase_order_repository.dart';\n\nclass GetAllPurchaseOrdersUseCase {\n  final PurchaseOrderRepository repository;\n\n  GetAllPurchaseOrdersUseCase(this.repository);\n\n  Future<Either<F><List<PurchaseOrder>> call() async {\n    return await repository.getAllPurchaseOrders();\n  }\n}\n","baseTimestamp":1755119187254,"deltas":[{"timestamp":1755119193196,"changes":[{"type":"MODIFY","lineNumber":8,"content":"  Future<Either<Failure, List<PurchaseOrder>>> call() async {><List<PurchaseOrder>> call() async {","oldContent":"  Future<Either<F><List<PurchaseOrder>> call() async {"}]},{"timestamp":1755119198610,"changes":[{"type":"MODIFY","lineNumber":8,"content":"  Future<Either<Failure, List<PurchaseOrder>>> call() async { ><List<PurchaseOrder>> call() async {","oldContent":"  Future<Either<Failure, List<PurchaseOrder>>> call() async {><List<PurchaseOrder>> call() async {"}]},{"timestamp":1755119206513,"changes":[{"type":"MODIFY","lineNumber":8,"content":"  Future<Either<Failure, List<PurchaseOrder>>> call() async { ","oldContent":"  Future<Either<Failure, List<PurchaseOrder>>> call() async { ><List<PurchaseOrder>> call() async {"}]},{"timestamp":1755119216801,"changes":[{"type":"INSERT","lineNumber":0,"content":"import 'package:clean_arch_app/core/error/failures.dart';"}]},{"timestamp":1755119219503,"changes":[{"type":"INSERT","lineNumber":3,"content":"import 'package:dartz/dartz.dart';"}]},{"timestamp":1755119441468,"changes":[{"type":"MODIFY","lineNumber":10,"content":"  Future<Either<Failure, List<PurchaseOrder>>> call() async {","oldContent":"  Future<Either<Failure, List<PurchaseOrder>>> call() async { "}]}]},"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/presentation/common/widgets/main_scaffold.dart":{"filePath":"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/presentation/common/widgets/main_scaffold.dart","baseContent":"// lib/presentation/core/main_scaffold_final_with_blur_overlay.dart\nimport 'dart:ui';\nimport 'package:flutter/material.dart';\nimport 'package:flutter_lucide/flutter_lucide.dart';\nimport 'package:flutter_riverpod/flutter_riverpod.dart';\nimport 'package:flutter_speed_dial/flutter_speed_dial.dart';\nimport 'package:go_router/go_router.dart';\n\nclass MainScaffold extends ConsumerStatefulWidget {\n  final Widget child;\n  const MainScaffold({super.key, required this.child});\n\n  @override\n  ConsumerState<MainScaffold> createState() => _MainScaffoldState();\n}\n\nclass _MainScaffoldState extends ConsumerState<MainScaffold> {\n  late int _selectedIndex;\n\n  // ValueNotifier controls SpeedDial open/close and overlay visibility\n  final ValueNotifier<bool> _dialOpen = ValueNotifier<bool>(false);\n\n  static const List<_NavItem> _navItems = [\n    _NavItem(icon: Icons.inventory, label: 'Stock', route: '/stock'),\n    _NavItem(icon: Icons.receipt_long, label: 'Purchase', route: '/purchase-order'),\n    _NavItem(icon: Icons.insert_chart_outlined, label: 'Reporting', route: '/reporting'),\n    _NavItem(icon: Icons.timeline, label: 'Activities', route: '/activity'),\n  ];\n\n  @override\n  void didChangeDependencies() {\n    super.didChangeDependencies();\n    // Use GoRouter location for robust current-path detection\n    final loc = GoRouter.of(context).location; // e.g. \"/stock/123\"\n    final idx = _navItems.indexWhere((i) => loc.startsWith(i.route));\n    _selectedIndex = idx == -1 ? 0 : idx;\n  }\n\n  @override\n  void dispose() {\n    _dialOpen.dispose();\n    super.dispose();\n  }\n\n  void _onItemTapped(int index) {\n    if (_selectedIndex == index) return;\n    setState(() => _selectedIndex = index);\n    context.go(_navItems[index].route);\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    final theme = Theme.of(context);\n\n    // Layout constants (small, tidy)\n    const double navHeight = 60.0;\n    const double indicatorWidth = 60.0;\n    const double indicatorHeight = 34.0;\n    const double iconSize = 18.0;\n    const double fabDiameter = 48.0;\n    const double fabIconSize = 18.0;\n    final Color activeColor = theme.colorScheme.primary;\n    final Color inactiveColor = theme.colorScheme.onSurface.withOpacity(0.68);\n\n    return Scaffold(\n      // Body in a Stack so custom overlay sits above content\n      body: Stack(\n        children: [\n          widget.child,\n\n          // Frosted overlay when SpeedDial is open (subtle glass)\n          ValueListenableBuilder<bool>(\n            valueListenable: _dialOpen,\n            builder: (context, open, _) {\n              if (!open) return const SizedBox.shrink();\n              return Positioned.fill(\n                child: GestureDetector(\n                  behavior: HitTestBehavior.opaque,\n                  onTap: () => _dialOpen.value = false,\n                  child: AnimatedOpacity(\n                    duration: const Duration(milliseconds: 200),\n                    opacity: 1.0,\n                    child: BackdropFilter(\n                      // reduced blur for a lighter glass effect\n                      filter: ImageFilter.blur(sigmaX: 3.5, sigmaY: 3.5),\n                      child: Container(\n                        color: theme.colorScheme.surface.withOpacity(0.12), // slight tint\n                      ),\n                    ),\n                  ),\n                ),\n              );\n            },\n          ),\n        ],\n      ),\n\n      // main floating action (SpeedDial)\n      floatingActionButton: _buildFab(theme, fabDiameter, fabIconSize),\n      floatingActionButtonLocation: FloatingActionButtonLocation.miniEndFloat,\n\n      // Bottom navigation bar  frosted, compact, minimal\n      bottomNavigationBar: SafeArea(\n        top: false,\n        child: Padding(\n          padding: const EdgeInsets.fromLTRB(12, 8, 12, 8),\n          child: ClipRRect(\n            borderRadius: BorderRadius.circular(14),\n            child: BackdropFilter(\n              // subtle blur on the bottom bar\n              filter: ImageFilter.blur(sigmaX: 3.0, sigmaY: 3.0),\n              child: Material(\n                color: theme.colorScheme.surface.withOpacity(0.92),\n                child: BottomAppBar(\n                  elevation: 0,\n                  notchMargin: 8,\n                  shape: const CircularNotchedRectangle(),\n                  color: Colors.transparent,\n                  child: SizedBox(\n                    height: navHeight,\n                    child: Stack(\n                      alignment: Alignment.center,\n                      children: [\n                        // Moving rounded indicator behind the active item\n                        AnimatedAlign(\n                          alignment: _alignmentForIndex(_selectedIndex, _navItems.length),\n                          duration: const Duration(milliseconds: 300),\n                          curve: Curves.easeOutCubic,\n                          child: Padding(\n                            padding: const EdgeInsets.only(bottom: 6),\n                            child: AnimatedContainer(\n                              duration: const Duration(milliseconds: 220),\n                              width: indicatorWidth,\n                              height: indicatorHeight,\n                              decoration: BoxDecoration(\n                                color: activeColor.withOpacity(0.10),\n                                borderRadius: BorderRadius.circular(indicatorHeight / 2),\n                              ),\n                            ),\n                          ),\n                        ),\n\n                        // Nav items (equally spaced)\n                        Row(\n                          mainAxisAlignment: MainAxisAlignment.spaceAround,\n                          children: List.generate(_navItems.length, (i) {\n                            final item = _navItems[i];\n                            final selected = i == _selectedIndex;\n                            return _BottomNavItem(\n                              icon: item.icon,\n                              label: item.label,\n                              selected: selected,\n                              activeColor: activeColor,\n                              inactiveColor: inactiveColor,\n                              onTap: () => _onItemTapped(i),\n                              iconSize: iconSize,\n                            );\n                          }),\n                        ),\n                      ],\n                    ),\n                  ),\n                ),\n              ),\n            ),\n          ),\n        ),\n      ),\n    );\n  }\n\n  // FAB / SpeedDial builder\n  Widget _buildFab(ThemeData theme, double diameter, double iconSize) {\n    final actions = <_ActionItem>[\n      _ActionItem(icon: LucideIcons.scan, label: 'Scan Barcode', route: '/scan'),\n      _ActionItem(icon: Icons.inventory_2_outlined, label: 'New Stock Take', route: '/new-stock-take'),\n      _ActionItem(icon: Icons.precision_manufacturing, label: 'New Production Run', route: '/new-production'),\n      _ActionItem(icon: Icons.article_outlined, label: 'New Bill of Material', route: '/new-bom'),\n      _ActionItem(icon: Icons.shopping_cart_outlined, label: 'New Customer Order', route: '/new-order'),\n    ];\n\n    Widget _buildLabel(BuildContext ctx, IconData icon, String label) {\n      final t = Theme.of(ctx);\n      return ClipRRect(\n        borderRadius: BorderRadius.circular(12),\n        child: BackdropFilter(\n          filter: ImageFilter.blur(sigmaX: 6, sigmaY: 6),\n          child: Container(\n            padding: const EdgeInsets.symmetric(vertical: 8, horizontal: 12),\n            color: t.colorScheme.surface.withOpacity(0.65),\n            child: Row(\n              mainAxisSize: MainAxisSize.min,\n              children: [\n                Icon(icon, size: 16, color: t.colorScheme.onSurface.withOpacity(0.95)),\n                const SizedBox(width: 10),\n                Text(label, style: TextStyle(fontSize: 14, fontWeight: FontWeight.w600, color: t.colorScheme.onSurface)),\n              ],\n            ),\n          ),\n        ),\n      );\n    }\n\n    final sdChildren = actions.map((a) {\n      return SpeedDialChild(\n        child: const SizedBox.shrink(), // we only show labelWidget\n        labelWidget: _buildLabel(context, a.icon, a.label),\n        backgroundColor: Colors.transparent,\n        labelBackgroundColor: Colors.transparent,\n        onTap: () {\n          _dialOpen.value = false;\n          GoRouter.of(context).push(a.route);\n        },\n      );\n    }).toList();\n\n    final fabChild = Container(\n      width: diameter,\n      height: diameter,\n      decoration: BoxDecoration(\n        color: theme.colorScheme.primary,\n        shape: BoxShape.circle,\n        boxShadow: [BoxShadow(color: Colors.black.withOpacity(0.12), blurRadius: 8, offset: const Offset(0, 3))],\n      ),\n      child: Center(child: Icon(LucideIcons.plus, size: iconSize, color: Colors.white)),\n    );\n\n    final activeChild = Container(\n      width: diameter,\n      height: diameter,\n      decoration: BoxDecoration(\n        color: theme.colorScheme.primary,\n        shape: BoxShape.circle,\n      ),\n      child: Center(child: Icon(Icons.close, size: iconSize, color: Colors.white)),\n    );\n\n    return SpeedDial(\n      icon: null,\n      child: fabChild,\n      activeChild: activeChild,\n      openCloseDial: _dialOpen,\n      onOpen: () => _dialOpen.value = true,\n      onClose: () => _dialOpen.value = false,\n      backgroundColor: Colors.transparent,\n      foregroundColor: Colors.white,\n      overlayOpacity: 0.0, // we manage our own overlay\n      curve: Curves.easeInOut,\n      elevation: 0,\n      shape: const CircleBorder(),\n      useRotationAnimation: true,\n      animationDuration: const Duration(milliseconds: 240),\n      children: sdChildren,\n    );\n  }\n\n  Alignment _alignmentForIndex(int index, int total) {\n    if (total <= 1) return Alignment.center;\n    final frac = index / (total - 1);\n    final ax = (frac * 2) - 1;\n    return Alignment(ax, 0);\n  }\n}\n\n// Reusable widgets and models\n\nclass _BottomNavItem extends StatelessWidget {\n  final IconData icon;\n  final String label;\n  final bool selected;\n  final Color activeColor;\n  final Color inactiveColor;\n  final VoidCallback onTap;\n  final double iconSize;\n\n  const _BottomNavItem({\n    Key? key,\n    required this.icon,\n    required this.label,\n    required this.selected,\n    required this.activeColor,\n    required this.inactiveColor,\n    required this.onTap,\n    required this.iconSize,\n  }) : super(key: key);\n\n  @override\n  Widget build(BuildContext context) {\n    return Expanded(\n      child: InkWell(\n        onTap: onTap,\n        child: SizedBox(\n          height: double.infinity,\n          child: Column(\n            mainAxisAlignment: MainAxisAlignment.center,\n            children: [\n              Icon(icon, size: iconSize, color: selected ? activeColor : inactiveColor),\n              const SizedBox(height: 4),\n              AnimatedDefaultTextStyle(\n                duration: const Duration(milliseconds: 200),\n                style: TextStyle(\n                  fontSize: 11,\n                  fontWeight: selected ? FontWeight.w700 : FontWeight.w600,\n                  color: selected ? activeColor : inactiveColor,\n                ),\n                child: Text(label),\n              ),\n            ],\n          ),\n        ),\n      ),\n    );\n  }\n}\n\nclass _NavItem {\n  final IconData icon;\n  final String label;\n  final String route;\n  const _NavItem({required this.icon, required this.label, required this.route});\n}\n\nclass _ActionItem {\n  final IconData icon;\n  final String label;\n  final String route;\n  const _ActionItem({required this.icon, required this.label, required this.route});\n}\n","baseTimestamp":1755121384821,"deltas":[{"timestamp":1755129294760,"changes":[{"type":"MODIFY","lineNumber":6,"content":"  final Widget child;","oldContent":"import 'package:go_router/go_router.dart';"},{"type":"INSERT","lineNumber":7,"content":"  const MainScaffold({super.key, required this.child});"},{"type":"DELETE","lineNumber":8,"oldContent":""},{"type":"MODIFY","lineNumber":17,"content":"","oldContent":"  late int _selectedIndex;"},{"type":"DELETE","lineNumber":26,"oldContent":"    _NavItem(icon: Icons.insert_chart_outlined, label: 'Reporting', route: '/reporting'),"},{"type":"DELETE","lineNumber":27,"oldContent":"    _NavItem(icon: Icons.timeline, label: 'Activities', route: '/activity'),"},{"type":"INSERT","lineNumber":26,"content":"    setState(() {"},{"type":"INSERT","lineNumber":27,"content":"      _selectedIndex = index;"},{"type":"MODIFY","lineNumber":30,"content":"  }","oldContent":"  void didChangeDependencies() {"},{"type":"DELETE","lineNumber":33,"oldContent":"    final idx = _navItems.indexWhere((i) => loc.startsWith(i.route));"},{"type":"DELETE","lineNumber":34,"oldContent":"  }"},{"type":"INSERT","lineNumber":33,"content":"  Widget build(BuildContext context) {"},{"type":"INSERT","lineNumber":34,"content":"    final theme = Theme.of(context);"},{"type":"MODIFY","lineNumber":39,"content":"      floatingActionButtonLocation: FloatingActionButtonLocation.miniEndFloati,","oldContent":"      floatingActionButtonLocation: FloatingActionButtonLocation.mi,"},{"type":"DELETE","lineNumber":143,"oldContent":"  final String route;"},{"type":"DELETE","lineNumber":144,"oldContent":"  const _ActionItem({required this.icon, required this.label, required this.route});"},{"type":"DELETE","lineNumber":145,"oldContent":"}"},{"type":"DELETE","lineNumber":146,"oldContent":""}]},{"timestamp":1755129300113,"changes":[{"type":"MODIFY","lineNumber":0,"content":"import 'package:flutter/material.dart';","oldContent":"// lib/presentation/core/main_scaffold_final_with_blur_overlay.dart"},{"type":"MODIFY","lineNumber":4,"content":"","oldContent":"import 'package:flutter_riverpod/flutter_riverpod.dart';"},{"type":"MODIFY","lineNumber":20,"content":"    _NavItem(icon: Icons.cameraswitch_rounded, label: 'Purchase Order', route: '/health'),","oldContent":"  final ValueNotifier<bool> _dialOpen = ValueNotifier<bool>(false);"},{"type":"MODIFY","lineNumber":25,"content":"  void _onItemTapped(int index) {","oldContent":"    _NavItem(icon: Icons.insert_chart_outlined, label: 'Reporting', route: '/reporting'),"},{"type":"MODIFY","lineNumber":32,"content":"  @override","oldContent":"    super.didChangeDependencies();"},{"type":"DELETE","lineNumber":37,"oldContent":"    _selectedIndex = idx == -1 ? 0 : idx;"},{"type":"DELETE","lineNumber":38,"oldContent":"  }"},{"type":"DELETE","lineNumber":39,"oldContent":"      floatingActionButtonLocation: FloatingActionButtonLocation.miniEndFloati,"},{"type":"INSERT","lineNumber":37,"content":"      body: widget.child,"},{"type":"INSERT","lineNumber":38,"content":"      floatingActionButton: _buildFab(theme, 56, 28),"},{"type":"INSERT","lineNumber":39,"content":"      floatingActionButtonLocation: FloatingActionButtonLocation.miniEndFloat,"},{"type":"MODIFY","lineNumber":69,"content":"                      ),","oldContent":""},{"type":"MODIFY","lineNumber":72,"content":"                ),","oldContent":"            valueListenable: _dialOpen,"},{"type":"MODIFY","lineNumber":77,"content":"      ),","oldContent":"                  behavior: HitTestBehavior.opaque,"},{"type":"DELETE","lineNumber":88,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":89,"oldContent":"                  ),"},{"type":"DELETE","lineNumber":90,"oldContent":"                ),"},{"type":"INSERT","lineNumber":88,"content":""},{"type":"INSERT","lineNumber":89,"content":"    return SpeedDial("},{"type":"INSERT","lineNumber":90,"content":"      icon: null,"},{"type":"MODIFY","lineNumber":100,"content":"          ),","oldContent":""},{"type":"MODIFY","lineNumber":102,"content":"        ),","oldContent":"      bottomNavigationBar: SafeArea("}]},{"timestamp":1755129402431,"changes":[{"type":"MODIFY","lineNumber":1,"content":"import 'package:flutter_lucide/flutter_lucide.dart';","oldContent":"import 'dart:ui';"},{"type":"MODIFY","lineNumber":9,"content":"  @override","oldContent":"  final Widget child;"},{"type":"MODIFY","lineNumber":35,"content":"","oldContent":"    _selectedIndex = idx == -1 ? 0 : idx;"},{"type":"MODIFY","lineNumber":68,"content":"                        selected ? Colors.cyanAccent : Colors.white70,","oldContent":"          widget.child,"},{"type":"MODIFY","lineNumber":71,"content":"                  ],","oldContent":"          ValueListenableBuilder<bool>("},{"type":"DELETE","lineNumber":82,"oldContent":"    final actions = <_ActionItem>["},{"type":"DELETE","lineNumber":83,"oldContent":"      _ActionItem(icon: LucideIcons.activity, label: 'Add blood pressure', route: '/bp'),"},{"type":"DELETE","lineNumber":84,"oldContent":"      _ActionItem(icon: LucideIcons.weight, label: 'Add weight', route: '/weight'),"},{"type":"DELETE","lineNumber":85,"oldContent":"                      child: Container("},{"type":"DELETE","lineNumber":86,"oldContent":"      _ActionItem(icon: Icons.run_circle_outlined, label: 'Track workout', route: '/workout'),"},{"type":"DELETE","lineNumber":87,"oldContent":"    ];"},{"type":"INSERT","lineNumber":82,"content":"    final actions = <_ActionItem>[ _ActionItem(icon: LucideIcons.scan, label: 'Scan Barcode', route: '/scan'), _ActionItem(icon: Icons.inventory_2_outlined, label: 'New Stock Take', route: '/new-stock-take'), _ActionItem(icon: Icons.precision_manufacturing, label: 'New Production', route: '/new-production'), _ActionItem(icon: Icons.article_outlined, label: 'New BOM', route: '/new-bom'), _ActionItem(icon: Icons.shopping_cart_outlined, label: 'New Order', route: '/new-order'), ];"},{"type":"DELETE","lineNumber":104,"oldContent":"        child: Padding("},{"type":"DELETE","lineNumber":105,"oldContent":"          padding: const EdgeInsets.fromLTRB(12, 8, 12, 8),"},{"type":"INSERT","lineNumber":99,"content":"      openCloseDial: _dialOpen,"},{"type":"INSERT","lineNumber":100,"content":"      overlayOpacity: 0.5,"}]},{"timestamp":1755129447173,"changes":[{"type":"INSERT","lineNumber":7,"content":""},{"type":"INSERT","lineNumber":12,"content":"}"},{"type":"DELETE","lineNumber":12,"oldContent":""},{"type":"DELETE","lineNumber":20,"oldContent":"    _NavItem(icon: Icons.cameraswitch_rounded, label: 'Purchase Order', route: '/health'),"},{"type":"INSERT","lineNumber":21,"content":"    _NavItem("},{"type":"INSERT","lineNumber":22,"content":"      icon: Icons.cameraswitch_rounded,"},{"type":"INSERT","lineNumber":23,"content":"      label: 'Purchase Order',"},{"type":"INSERT","lineNumber":24,"content":"      route: '/health',"},{"type":"INSERT","lineNumber":25,"content":"    ),"},{"type":"DELETE","lineNumber":22,"oldContent":"    _NavItem(icon: Icons.history_outlined, label: 'activity', route: '/profile'),"},{"type":"INSERT","lineNumber":27,"content":"    _NavItem("},{"type":"INSERT","lineNumber":28,"content":"      icon: Icons.history_outlined,"},{"type":"INSERT","lineNumber":29,"content":"      label: 'activity',"},{"type":"INSERT","lineNumber":30,"content":"      route: '/profile',"},{"type":"INSERT","lineNumber":31,"content":"    ),"},{"type":"DELETE","lineNumber":31,"oldContent":"    super.didChangeDependencies();"},{"type":"INSERT","lineNumber":40,"content":""},{"type":"DELETE","lineNumber":65,"oldContent":"                        fontWeight:"},{"type":"DELETE","lineNumber":66,"oldContent":"                        selected ? FontWeight.w700 : FontWeight.w500,"},{"type":"DELETE","lineNumber":67,"oldContent":"                        color:"},{"type":"DELETE","lineNumber":68,"oldContent":"                        selected ? Colors.cyanAccent : Colors.white70,"},{"type":"INSERT","lineNumber":74,"content":"                        fontWeight: selected"},{"type":"INSERT","lineNumber":75,"content":"                            ? FontWeight.w700"},{"type":"INSERT","lineNumber":76,"content":"                            : FontWeight.w500,"},{"type":"INSERT","lineNumber":77,"content":"                        color: selected ? Colors.cyanAccent : Colors.white70,"},{"type":"DELETE","lineNumber":70,"oldContent":"          // Frosted overlay when SpeedDial is open (subtle glass)"},{"type":"INSERT","lineNumber":79,"content":"                    ),"},{"type":"DELETE","lineNumber":74,"oldContent":"              if (!open) return const SizedBox.shrink();"},{"type":"INSERT","lineNumber":83,"content":"            }),"},{"type":"DELETE","lineNumber":76,"oldContent":"                child: GestureDetector("},{"type":"INSERT","lineNumber":85,"content":"        ),"},{"type":"DELETE","lineNumber":82,"oldContent":"    final actions = <_ActionItem>[ _ActionItem(icon: LucideIcons.scan, label: 'Scan Barcode', route: '/scan'), _ActionItem(icon: Icons.inventory_2_outlined, label: 'New Stock Take', route: '/new-stock-take'), _ActionItem(icon: Icons.precision_manufacturing, label: 'New Production', route: '/new-production'), _ActionItem(icon: Icons.article_outlined, label: 'New BOM', route: '/new-bom'), _ActionItem(icon: Icons.shopping_cart_outlined, label: 'New Order', route: '/new-order'), ];"},{"type":"INSERT","lineNumber":91,"content":"    final actions = <_ActionItem>["},{"type":"INSERT","lineNumber":92,"content":"      _ActionItem("},{"type":"INSERT","lineNumber":93,"content":"        icon: LucideIcons.scan,"},{"type":"INSERT","lineNumber":94,"content":"        label: 'Scan Barcode',"},{"type":"INSERT","lineNumber":95,"content":"        route: '/scan',"},{"type":"INSERT","lineNumber":96,"content":"      ),"},{"type":"INSERT","lineNumber":97,"content":"      _ActionItem("},{"type":"INSERT","lineNumber":98,"content":"        icon: Icons.inventory_2_outlined,"},{"type":"INSERT","lineNumber":99,"content":"        label: 'New Stock Take',"},{"type":"INSERT","lineNumber":100,"content":"        route: '/new-stock-take',"},{"type":"INSERT","lineNumber":101,"content":"      ),"},{"type":"INSERT","lineNumber":102,"content":"      _ActionItem("},{"type":"INSERT","lineNumber":103,"content":"        icon: Icons.precision_manufacturing,"},{"type":"INSERT","lineNumber":104,"content":"        label: 'New Production',"},{"type":"INSERT","lineNumber":105,"content":"        route: '/new-production',"},{"type":"INSERT","lineNumber":106,"content":"      ),"},{"type":"INSERT","lineNumber":107,"content":"      _ActionItem("},{"type":"INSERT","lineNumber":108,"content":"        icon: Icons.article_outlined,"},{"type":"INSERT","lineNumber":109,"content":"        label: 'New BOM',"},{"type":"INSERT","lineNumber":110,"content":"        route: '/new-bom',"},{"type":"INSERT","lineNumber":111,"content":"      ),"},{"type":"INSERT","lineNumber":112,"content":"      _ActionItem("},{"type":"INSERT","lineNumber":113,"content":"        icon: Icons.shopping_cart_outlined,"},{"type":"INSERT","lineNumber":114,"content":"        label: 'New Order',"},{"type":"INSERT","lineNumber":115,"content":"        route: '/new-order',"},{"type":"INSERT","lineNumber":116,"content":"      ),"},{"type":"INSERT","lineNumber":117,"content":"    ];"},{"type":"DELETE","lineNumber":87,"oldContent":"            },"},{"type":"DELETE","lineNumber":88,"oldContent":"          ),"},{"type":"INSERT","lineNumber":122,"content":"        duration: const Duration(milliseconds: 250),"},{"type":"INSERT","lineNumber":123,"content":"        turns: _dialOpen.value ? 0.125 : 0,"},{"type":"DELETE","lineNumber":94,"oldContent":"      openCloseDial: _dialOpen,"},{"type":"DELETE","lineNumber":96,"oldContent":"      overlayOpacity: 0.5,"},{"type":"DELETE","lineNumber":100,"oldContent":"        top: false,"},{"type":"INSERT","lineNumber":133,"content":"      ),"},{"type":"INSERT","lineNumber":134,"content":"      openCloseDial: _dialOpen,"},{"type":"INSERT","lineNumber":135,"content":"      overlayOpacity: 0.5,"},{"type":"DELETE","lineNumber":107,"oldContent":"          .map((action) => SpeedDialChild("},{"type":"DELETE","lineNumber":108,"oldContent":"        backgroundColor: const Color(0xFF0E2330),"},{"type":"DELETE","lineNumber":109,"oldContent":"        child: Icon(action.icon, color: Colors.white, size: 20),"},{"type":"DELETE","lineNumber":110,"oldContent":"        label: action.label,"},{"type":"DELETE","lineNumber":111,"oldContent":"        labelStyle:"},{"type":"DELETE","lineNumber":112,"oldContent":"        const TextStyle(color: Colors.white, fontSize: 14),"},{"type":"DELETE","lineNumber":113,"oldContent":"        labelBackgroundColor: Colors.transparent,"},{"type":"DELETE","lineNumber":114,"oldContent":"        onTap: () => GoRouter.of(context).push(action.route),"},{"type":"DELETE","lineNumber":115,"oldContent":"      ))"},{"type":"INSERT","lineNumber":142,"content":"          .map("},{"type":"INSERT","lineNumber":143,"content":"            (action) => SpeedDialChild("},{"type":"INSERT","lineNumber":144,"content":"              backgroundColor: const Color(0xFF0E2330),"},{"type":"INSERT","lineNumber":145,"content":"              child: Icon(action.icon, color: Colors.white, size: 20),"},{"type":"INSERT","lineNumber":146,"content":"              label: action.label,"},{"type":"INSERT","lineNumber":147,"content":"              labelStyle: const TextStyle(color: Colors.white, fontSize: 14),"},{"type":"INSERT","lineNumber":148,"content":"              labelBackgroundColor: Colors.transparent,"},{"type":"INSERT","lineNumber":149,"content":"              onTap: () => GoRouter.of(context).push(action.route),"},{"type":"INSERT","lineNumber":150,"content":"            ),"},{"type":"INSERT","lineNumber":151,"content":"          )"},{"type":"DELETE","lineNumber":134,"oldContent":"  _ActionItem("},{"type":"DELETE","lineNumber":135,"oldContent":"      {required this.icon, required this.label, required this.route});"},{"type":"INSERT","lineNumber":170,"content":"  _ActionItem({required this.icon, required this.label, required this.route});"}]},{"timestamp":1755129493010,"changes":[{"type":"MODIFY","lineNumber":2,"content":"import 'package:flutter_speed_dial/flutter_speed_dial.dart';","oldContent":"import 'package:flutter/material.dart';"},{"type":"MODIFY","lineNumber":13,"content":"","oldContent":""},{"type":"DELETE","lineNumber":22,"oldContent":"    _NavItem(icon: Icons.bar_chart_sharp, label: 'Reporting', route: '/stats'),"},{"type":"DELETE","lineNumber":25,"oldContent":"  ];"},{"type":"DELETE","lineNumber":27,"oldContent":""},{"type":"INSERT","lineNumber":26,"content":"    _NavItem(icon: Icons.bar_chart_sharp, label: 'Reporting', route: '/stats'),"},{"type":"INSERT","lineNumber":27,"content":"    _NavItem("},{"type":"INSERT","lineNumber":28,"content":"      icon: Icons.history_outlined,"},{"type":"INSERT","lineNumber":29,"content":"      label: 'activity',"},{"type":"INSERT","lineNumber":30,"content":"      route: '/profile',"},{"type":"INSERT","lineNumber":31,"content":"    ),"},{"type":"INSERT","lineNumber":32,"content":"  ];"},{"type":"INSERT","lineNumber":33,"content":""},{"type":"DELETE","lineNumber":31,"oldContent":"    _NavItem("},{"type":"DELETE","lineNumber":33,"oldContent":"      icon: Icons.history_outlined,"},{"type":"DELETE","lineNumber":35,"oldContent":"      label: 'activity',"},{"type":"DELETE","lineNumber":37,"oldContent":"      route: '/profile',"},{"type":"DELETE","lineNumber":39,"oldContent":"    ),"},{"type":"INSERT","lineNumber":40,"content":""},{"type":"DELETE","lineNumber":44,"oldContent":"  }"},{"type":"INSERT","lineNumber":45,"content":"    return Scaffold("},{"type":"DELETE","lineNumber":48,"oldContent":""},{"type":"DELETE","lineNumber":74,"oldContent":"                      ),"},{"type":"DELETE","lineNumber":75,"oldContent":"                  ],"},{"type":"DELETE","lineNumber":76,"oldContent":"                ),"},{"type":"DELETE","lineNumber":77,"oldContent":"            builder: (context, open, _) {"},{"type":"DELETE","lineNumber":80,"oldContent":"          ),"},{"type":"INSERT","lineNumber":78,"content":"                      ),"},{"type":"INSERT","lineNumber":79,"content":"                    ),"},{"type":"INSERT","lineNumber":80,"content":"                  ],"},{"type":"INSERT","lineNumber":81,"content":"                ),"},{"type":"INSERT","lineNumber":82,"content":"              );"},{"type":"INSERT","lineNumber":83,"content":"            }),"},{"type":"INSERT","lineNumber":84,"content":"          ),"},{"type":"INSERT","lineNumber":85,"content":"        ),"},{"type":"DELETE","lineNumber":85,"oldContent":"                    ),"},{"type":"DELETE","lineNumber":89,"oldContent":"            }),"},{"type":"DELETE","lineNumber":90,"oldContent":""},{"type":"DELETE","lineNumber":91,"oldContent":"    return SpeedDial("},{"type":"DELETE","lineNumber":92,"oldContent":"        ),"},{"type":"DELETE","lineNumber":93,"oldContent":"      icon: null,"},{"type":"DELETE","lineNumber":94,"oldContent":"              );"},{"type":"DELETE","lineNumber":95,"oldContent":"        child: Container("},{"type":"DELETE","lineNumber":96,"oldContent":"          width: diameter,"},{"type":"DELETE","lineNumber":98,"oldContent":"          height: diameter,"},{"type":"DELETE","lineNumber":100,"oldContent":"          decoration: const BoxDecoration("},{"type":"DELETE","lineNumber":102,"oldContent":"            color: Color(0xFF0E2330),"},{"type":"DELETE","lineNumber":105,"oldContent":"            shape: BoxShape.circle,"},{"type":"DELETE","lineNumber":108,"oldContent":"          ),"},{"type":"DELETE","lineNumber":110,"oldContent":"          child: const Icon(Icons.add, color: Colors.white, size: 28),"},{"type":"DELETE","lineNumber":112,"oldContent":"        ),"},{"type":"DELETE","lineNumber":115,"oldContent":"      overlayColor: Colors.black,"},{"type":"DELETE","lineNumber":117,"oldContent":"      backgroundColor: Colors.transparent,"},{"type":"DELETE","lineNumber":119,"oldContent":"      elevation: 0,"},{"type":"DELETE","lineNumber":121,"oldContent":"      spacing: 10,"},{"type":"DELETE","lineNumber":123,"oldContent":"      spaceBetweenChildren: 10,"},{"type":"DELETE","lineNumber":125,"oldContent":"      children: actions"},{"type":"DELETE","lineNumber":136,"oldContent":"          .toList(),"},{"type":"INSERT","lineNumber":118,"content":""},{"type":"INSERT","lineNumber":119,"content":"    return SpeedDial("},{"type":"INSERT","lineNumber":120,"content":"      icon: ,"},{"type":"INSERT","lineNumber":121,"content":"      child: AnimatedRotation("},{"type":"INSERT","lineNumber":122,"content":"        duration: const Duration(milliseconds: 250),"},{"type":"INSERT","lineNumber":123,"content":"        turns: _dialOpen.value ? 0.125 : 0,"},{"type":"INSERT","lineNumber":124,"content":"        child: Container("},{"type":"INSERT","lineNumber":125,"content":"          width: diameter,"},{"type":"INSERT","lineNumber":126,"content":"          height: diameter,"},{"type":"INSERT","lineNumber":127,"content":"          decoration: const BoxDecoration("},{"type":"INSERT","lineNumber":128,"content":"            color: Color(0xFF0E2330),"},{"type":"INSERT","lineNumber":129,"content":"            shape: BoxShape.circle,"},{"type":"INSERT","lineNumber":130,"content":"          ),"},{"type":"INSERT","lineNumber":131,"content":"          child: const Icon(Icons.add, color: Colors.white, size: 28),"},{"type":"INSERT","lineNumber":132,"content":"        ),"},{"type":"INSERT","lineNumber":133,"content":"      ),"},{"type":"INSERT","lineNumber":134,"content":"      openCloseDial: _dialOpen,"},{"type":"INSERT","lineNumber":135,"content":"      overlayOpacity: 0.5,"},{"type":"INSERT","lineNumber":136,"content":"      overlayColor: Colors.black,"},{"type":"INSERT","lineNumber":137,"content":"      backgroundColor: Colors.transparent,"},{"type":"INSERT","lineNumber":138,"content":"      elevation: 0,"},{"type":"INSERT","lineNumber":139,"content":"      spacing: 10,"},{"type":"INSERT","lineNumber":140,"content":"      spaceBetweenChildren: 10,"},{"type":"INSERT","lineNumber":141,"content":"      children: actions"},{"type":"INSERT","lineNumber":142,"content":"          .map("},{"type":"INSERT","lineNumber":143,"content":"            (action) => SpeedDialChild("},{"type":"INSERT","lineNumber":144,"content":"              backgroundColor: const Color(0xFF0E2330),"},{"type":"INSERT","lineNumber":145,"content":"              child: Icon(action.icon, color: Colors.white, size: 20),"},{"type":"INSERT","lineNumber":146,"content":"              label: action.label,"},{"type":"INSERT","lineNumber":147,"content":"              labelStyle: const TextStyle(color: Colors.white, fontSize: 14),"},{"type":"INSERT","lineNumber":148,"content":"              labelBackgroundColor: Colors.transparent,"},{"type":"INSERT","lineNumber":149,"content":"              onTap: () => GoRouter.of(context).push(action.route),"},{"type":"INSERT","lineNumber":150,"content":"            ),"},{"type":"INSERT","lineNumber":151,"content":"          )"},{"type":"INSERT","lineNumber":152,"content":"          .toList(),"},{"type":"DELETE","lineNumber":142,"oldContent":"                          duration: const Duration(milliseconds: 300),"},{"type":"DELETE","lineNumber":143,"oldContent":"        duration: const Duration(milliseconds: 250),"},{"type":"DELETE","lineNumber":144,"oldContent":"                          curve: Curves.easeOutCubic,"},{"type":"DELETE","lineNumber":145,"oldContent":"        turns: _dialOpen.value ? 0.125 : 0,"},{"type":"DELETE","lineNumber":146,"oldContent":"                          child: Padding("},{"type":"INSERT","lineNumber":157,"content":"class _NavItem {"},{"type":"INSERT","lineNumber":158,"content":"  final IconData icon;"},{"type":"INSERT","lineNumber":159,"content":"  final String label;"},{"type":"DELETE","lineNumber":150,"oldContent":"                              width: indicatorWidth,"},{"type":"INSERT","lineNumber":163,"content":"}"},{"type":"DELETE","lineNumber":152,"oldContent":"                              decoration: BoxDecoration("},{"type":"DELETE","lineNumber":153,"oldContent":"                                color: activeColor.withOpacity(0.10),"},{"type":"INSERT","lineNumber":165,"content":"class _ActionItem {"},{"type":"INSERT","lineNumber":166,"content":"  final IconData icon;"},{"type":"DELETE","lineNumber":156,"oldContent":"      ),"},{"type":"DELETE","lineNumber":158,"oldContent":"      openCloseDial: _dialOpen,"},{"type":"DELETE","lineNumber":159,"oldContent":"      overlayOpacity: 0.5,"},{"type":"INSERT","lineNumber":170,"content":"  _ActionItem({required this.icon, required this.label, required this.route});"},{"type":"DELETE","lineNumber":162,"oldContent":"  _ActionItem({required this.icon, required this.label, required this.route});"},{"type":"DELETE","lineNumber":163,"oldContent":"          )"},{"type":"DELETE","lineNumber":164,"oldContent":"            ),"},{"type":"DELETE","lineNumber":165,"oldContent":"              onTap: () => GoRouter.of(context).push(action.route),"},{"type":"DELETE","lineNumber":166,"oldContent":"          .map("},{"type":"DELETE","lineNumber":167,"oldContent":"              labelBackgroundColor: Colors.transparent,"},{"type":"DELETE","lineNumber":168,"oldContent":"            (action) => SpeedDialChild("},{"type":"DELETE","lineNumber":169,"oldContent":"              labelStyle: const TextStyle(color: Colors.white, fontSize: 14),"},{"type":"DELETE","lineNumber":170,"oldContent":"              backgroundColor: const Color(0xFF0E2330),"},{"type":"DELETE","lineNumber":171,"oldContent":"              label: action.label,"},{"type":"DELETE","lineNumber":172,"oldContent":"              child: Icon(action.icon, color: Colors.white, size: 20),"}]},{"timestamp":1755129497599,"changes":[{"type":"INSERT","lineNumber":12,"content":"}"},{"type":"DELETE","lineNumber":13,"oldContent":""},{"type":"DELETE","lineNumber":24,"oldContent":"    _NavItem(icon: Icons.bar_chart_sharp, label: 'Reporting', route: '/stats'),"},{"type":"INSERT","lineNumber":25,"content":"    ),"},{"type":"INSERT","lineNumber":26,"content":"    _NavItem(icon: Icons.bar_chart_sharp, label: 'Reporting', route: '/stats'),"},{"type":"DELETE","lineNumber":28,"oldContent":"    ),"},{"type":"DELETE","lineNumber":30,"oldContent":"  void _onItemTapped(int index) {"},{"type":"DELETE","lineNumber":32,"oldContent":"    setState(() {"},{"type":"DELETE","lineNumber":35,"oldContent":"      _selectedIndex = index;"},{"type":"INSERT","lineNumber":34,"content":"  void _onItemTapped(int index) {"},{"type":"INSERT","lineNumber":35,"content":"    setState(() {"},{"type":"INSERT","lineNumber":36,"content":"      _selectedIndex = index;"},{"type":"DELETE","lineNumber":74,"oldContent":"                      ),"},{"type":"MODIFY","lineNumber":76,"content":"                            : FontWeight.w500,","oldContent":"                    ),"},{"type":"INSERT","lineNumber":77,"content":"                        color: selected ? Colors.cyanAccent : Colors.white70,"},{"type":"INSERT","lineNumber":78,"content":"                      ),"},{"type":"INSERT","lineNumber":79,"content":"                    ),"},{"type":"DELETE","lineNumber":80,"oldContent":"                            : FontWeight.w500,"},{"type":"DELETE","lineNumber":82,"oldContent":"                        color: selected ? Colors.cyanAccent : Colors.white70,"},{"type":"DELETE","lineNumber":84,"oldContent":"      ),"},{"type":"MODIFY","lineNumber":86,"content":"      ),","oldContent":"    );"},{"type":"INSERT","lineNumber":87,"content":"    );"},{"type":"DELETE","lineNumber":103,"oldContent":""},{"type":"DELETE","lineNumber":105,"oldContent":"    return SpeedDial("},{"type":"DELETE","lineNumber":106,"oldContent":"      icon: ,"},{"type":"INSERT","lineNumber":105,"content":"        route: '/new-production',"},{"type":"INSERT","lineNumber":106,"content":"      ),"},{"type":"INSERT","lineNumber":107,"content":"      _ActionItem("},{"type":"INSERT","lineNumber":108,"content":"        icon: Icons.article_outlined,"},{"type":"INSERT","lineNumber":109,"content":"        label: 'New BOM',"},{"type":"INSERT","lineNumber":110,"content":"        route: '/new-bom',"},{"type":"INSERT","lineNumber":111,"content":"      ),"},{"type":"INSERT","lineNumber":112,"content":"      _ActionItem("},{"type":"INSERT","lineNumber":113,"content":"        icon: Icons.shopping_cart_outlined,"},{"type":"INSERT","lineNumber":114,"content":"        label: 'New Order',"},{"type":"INSERT","lineNumber":115,"content":"        route: '/new-order',"},{"type":"INSERT","lineNumber":116,"content":"      ),"},{"type":"INSERT","lineNumber":117,"content":"    ];"},{"type":"INSERT","lineNumber":118,"content":""},{"type":"INSERT","lineNumber":119,"content":"    return SpeedDial("},{"type":"INSERT","lineNumber":120,"content":"      icon: Ic,"},{"type":"DELETE","lineNumber":110,"oldContent":"        route: '/new-production',"},{"type":"DELETE","lineNumber":113,"oldContent":"      ),"},{"type":"DELETE","lineNumber":116,"oldContent":"      _ActionItem("},{"type":"DELETE","lineNumber":118,"oldContent":"        icon: Icons.article_outlined,"},{"type":"DELETE","lineNumber":120,"oldContent":"        label: 'New BOM',"},{"type":"DELETE","lineNumber":122,"oldContent":"        route: '/new-bom',"},{"type":"DELETE","lineNumber":124,"oldContent":"      ),"},{"type":"DELETE","lineNumber":126,"oldContent":"      _ActionItem("},{"type":"DELETE","lineNumber":128,"oldContent":"        icon: Icons.shopping_cart_outlined,"},{"type":"DELETE","lineNumber":130,"oldContent":"        label: 'New Order',"},{"type":"DELETE","lineNumber":132,"oldContent":"        route: '/new-order',"},{"type":"DELETE","lineNumber":134,"oldContent":"      ),"},{"type":"DELETE","lineNumber":137,"oldContent":"    ];"},{"type":"DELETE","lineNumber":139,"oldContent":"    );"},{"type":"DELETE","lineNumber":141,"oldContent":"  }"},{"type":"DELETE","lineNumber":143,"oldContent":"}"},{"type":"DELETE","lineNumber":145,"oldContent":""},{"type":"DELETE","lineNumber":152,"oldContent":"  final String route;"},{"type":"DELETE","lineNumber":154,"oldContent":""},{"type":"DELETE","lineNumber":156,"oldContent":"  _NavItem({required this.icon, required this.label, required this.route});"},{"type":"DELETE","lineNumber":159,"oldContent":""},{"type":"DELETE","lineNumber":161,"oldContent":"  final String label;"},{"type":"DELETE","lineNumber":162,"oldContent":"  final String route;"},{"type":"DELETE","lineNumber":163,"oldContent":"class _NavItem {"},{"type":"INSERT","lineNumber":153,"content":"    );"},{"type":"INSERT","lineNumber":154,"content":"  }"},{"type":"INSERT","lineNumber":155,"content":"}"},{"type":"INSERT","lineNumber":157,"content":"class _NavItem {"},{"type":"DELETE","lineNumber":167,"oldContent":"}"},{"type":"INSERT","lineNumber":160,"content":"  final String route;"},{"type":"INSERT","lineNumber":162,"content":"  _NavItem({required this.icon, required this.label, required this.route});"},{"type":"INSERT","lineNumber":164,"content":""},{"type":"INSERT","lineNumber":167,"content":"  final String label;"},{"type":"INSERT","lineNumber":168,"content":"  final String route;"},{"type":"INSERT","lineNumber":169,"content":""},{"type":"INSERT","lineNumber":171,"content":"}"},{"type":"INSERT","lineNumber":172,"content":""}]},{"timestamp":1755129500459,"changes":[{"type":"MODIFY","lineNumber":25,"content":"    ),","oldContent":"    ),"},{"type":"DELETE","lineNumber":32,"oldContent":"  void _onItemTapped(int index) {"},{"type":"INSERT","lineNumber":33,"content":""},{"type":"INSERT","lineNumber":34,"content":"  void _onItemTapped(int index) {"},{"type":"DELETE","lineNumber":36,"oldContent":""},{"type":"INSERT","lineNumber":75,"content":"                            ? FontWeight.w700"},{"type":"DELETE","lineNumber":77,"oldContent":"                            ? FontWeight.w700"},{"type":"MODIFY","lineNumber":80,"content":"                  ],","oldContent":"                  ],"},{"type":"INSERT","lineNumber":85,"content":"        ),"},{"type":"DELETE","lineNumber":87,"oldContent":"        ),"},{"type":"INSERT","lineNumber":104,"content":"        label: 'New Production',"},{"type":"DELETE","lineNumber":107,"oldContent":"        label: 'New Production',"},{"type":"DELETE","lineNumber":109,"oldContent":"      child: AnimatedRotation("},{"type":"DELETE","lineNumber":111,"oldContent":"        duration: const Duration(milliseconds: 250),"},{"type":"DELETE","lineNumber":114,"oldContent":"        turns: _dialOpen.value ? 0.125 : 0,"},{"type":"DELETE","lineNumber":116,"oldContent":"        child: Container("},{"type":"DELETE","lineNumber":119,"oldContent":"          width: diameter,"},{"type":"DELETE","lineNumber":121,"oldContent":"          height: diameter,"},{"type":"DELETE","lineNumber":124,"oldContent":"          decoration: const BoxDecoration("},{"type":"DELETE","lineNumber":127,"oldContent":"            color: Color(0xFF0E2330),"},{"type":"INSERT","lineNumber":121,"content":"      child: AnimatedRotation("},{"type":"INSERT","lineNumber":122,"content":"        duration: const Duration(milliseconds: 250),"},{"type":"INSERT","lineNumber":123,"content":"        turns: _dialOpen.value ? 0.125 : 0,"},{"type":"INSERT","lineNumber":124,"content":"        child: Container("},{"type":"INSERT","lineNumber":125,"content":"          width: diameter,"},{"type":"INSERT","lineNumber":126,"content":"          height: diameter,"},{"type":"INSERT","lineNumber":127,"content":"          decoration: const BoxDecoration("},{"type":"INSERT","lineNumber":128,"content":"            color: Color(0xFF0E2330),"},{"type":"DELETE","lineNumber":148,"oldContent":"    );"},{"type":"DELETE","lineNumber":150,"oldContent":"  }"},{"type":"DELETE","lineNumber":151,"oldContent":"}"},{"type":"DELETE","lineNumber":153,"oldContent":"class _NavItem {"},{"type":"DELETE","lineNumber":156,"oldContent":"  final String route;"},{"type":"DELETE","lineNumber":158,"oldContent":"  _NavItem({required this.icon, required this.label, required this.route});"},{"type":"INSERT","lineNumber":153,"content":"    );"},{"type":"INSERT","lineNumber":154,"content":"  }"},{"type":"INSERT","lineNumber":155,"content":"}"},{"type":"DELETE","lineNumber":160,"oldContent":""},{"type":"INSERT","lineNumber":157,"content":"class _NavItem {"},{"type":"DELETE","lineNumber":163,"oldContent":"  final String label;"},{"type":"DELETE","lineNumber":166,"oldContent":""},{"type":"INSERT","lineNumber":162,"content":"  _NavItem({required this.icon, required this.label, required this.route});"},{"type":"INSERT","lineNumber":164,"content":""},{"type":"DELETE","lineNumber":169,"oldContent":"}"},{"type":"INSERT","lineNumber":167,"content":"  final String label;"},{"type":"INSERT","lineNumber":168,"content":"  final String route;"},{"type":"INSERT","lineNumber":171,"content":"}"},{"type":"INSERT","lineNumber":172,"content":""}]},{"timestamp":1755129509727,"changes":[{"type":"INSERT","lineNumber":24,"content":"      route: '/health',"},{"type":"DELETE","lineNumber":25,"oldContent":"    ),"},{"type":"MODIFY","lineNumber":33,"content":"","oldContent":""},{"type":"INSERT","lineNumber":79,"content":"                    ),"},{"type":"DELETE","lineNumber":80,"oldContent":"                  ],"},{"type":"INSERT","lineNumber":116,"content":"      ),"},{"type":"INSERT","lineNumber":117,"content":"    ];"},{"type":"INSERT","lineNumber":118,"content":""},{"type":"INSERT","lineNumber":119,"content":"    return SpeedDial("},{"type":"INSERT","lineNumber":120,"content":"      icon: ,"},{"type":"DELETE","lineNumber":118,"oldContent":"      ),"},{"type":"DELETE","lineNumber":120,"oldContent":"    ];"},{"type":"DELETE","lineNumber":123,"oldContent":""},{"type":"DELETE","lineNumber":125,"oldContent":"    return SpeedDial("},{"type":"DELETE","lineNumber":128,"oldContent":"      icon: Ic,"},{"type":"DELETE","lineNumber":150,"oldContent":"    );"},{"type":"DELETE","lineNumber":151,"oldContent":"  }"},{"type":"DELETE","lineNumber":153,"oldContent":"}"},{"type":"DELETE","lineNumber":155,"oldContent":"class _NavItem {"},{"type":"INSERT","lineNumber":153,"content":"    );"},{"type":"INSERT","lineNumber":154,"content":"  }"},{"type":"INSERT","lineNumber":155,"content":"}"},{"type":"INSERT","lineNumber":157,"content":"class _NavItem {"},{"type":"DELETE","lineNumber":159,"oldContent":"  _NavItem({required this.icon, required this.label, required this.route});"},{"type":"DELETE","lineNumber":161,"oldContent":""},{"type":"DELETE","lineNumber":164,"oldContent":"  final String label;"},{"type":"INSERT","lineNumber":162,"content":"  _NavItem({required this.icon, required this.label, required this.route});"},{"type":"DELETE","lineNumber":166,"oldContent":"  final String route;"},{"type":"INSERT","lineNumber":164,"content":""},{"type":"DELETE","lineNumber":169,"oldContent":"}"},{"type":"INSERT","lineNumber":167,"content":"  final String label;"},{"type":"INSERT","lineNumber":168,"content":"  final String route;"},{"type":"MODIFY","lineNumber":171,"content":"}","oldContent":""},{"type":"INSERT","lineNumber":172,"content":""}]},{"timestamp":1755129513355,"changes":[{"type":"INSERT","lineNumber":32,"content":"  ];"},{"type":"DELETE","lineNumber":33,"oldContent":""},{"type":"DELETE","lineNumber":117,"oldContent":"      child: AnimatedRotation("},{"type":"DELETE","lineNumber":119,"oldContent":"        duration: const Duration(milliseconds: 250),"},{"type":"INSERT","lineNumber":120,"content":"      icon: Icons.add,"},{"type":"INSERT","lineNumber":121,"content":"      child: AnimatedRotation("},{"type":"INSERT","lineNumber":122,"content":"        duration: const Duration(milliseconds: 250),"},{"type":"DELETE","lineNumber":123,"oldContent":"      icon: ,"},{"type":"INSERT","lineNumber":151,"content":"          )"},{"type":"INSERT","lineNumber":152,"content":"          .toList(),"},{"type":"DELETE","lineNumber":153,"oldContent":"          )"},{"type":"DELETE","lineNumber":155,"oldContent":"          .toList(),"},{"type":"MODIFY","lineNumber":157,"content":"class _NavItem {","oldContent":"class _NavItem {"},{"type":"DELETE","lineNumber":160,"oldContent":"  _NavItem({required this.icon, required this.label, required this.route});"},{"type":"DELETE","lineNumber":163,"oldContent":""},{"type":"INSERT","lineNumber":162,"content":"  _NavItem({required this.icon, required this.label, required this.route});"},{"type":"DELETE","lineNumber":165,"oldContent":"  final String label;"},{"type":"INSERT","lineNumber":164,"content":""},{"type":"MODIFY","lineNumber":167,"content":"  final String label;","oldContent":"  final String route;"},{"type":"INSERT","lineNumber":168,"content":"  final String route;"},{"type":"INSERT","lineNumber":170,"content":"  _ActionItem({required this.icon, required this.label, required this.route});"},{"type":"DELETE","lineNumber":172,"oldContent":"  _ActionItem({required this.icon, required this.label, required this.route});"}]},{"timestamp":1755129532742,"changes":[{"type":"DELETE","lineNumber":118,"oldContent":"      icon: Icons.add,"},{"type":"MODIFY","lineNumber":120,"content":"      icon: null,","oldContent":"      child: AnimatedRotation("},{"type":"INSERT","lineNumber":121,"content":"      child: AnimatedRotation("},{"type":"MODIFY","lineNumber":153,"content":"    );","oldContent":"    );"},{"type":"INSERT","lineNumber":156,"content":""},{"type":"DELETE","lineNumber":157,"oldContent":"class _NavItem {"},{"type":"DELETE","lineNumber":161,"oldContent":"  _NavItem({required this.icon, required this.label, required this.route});"},{"type":"DELETE","lineNumber":163,"oldContent":""},{"type":"INSERT","lineNumber":162,"content":"  _NavItem({required this.icon, required this.label, required this.route});"},{"type":"INSERT","lineNumber":164,"content":""},{"type":"INSERT","lineNumber":166,"content":"  final IconData icon;"},{"type":"DELETE","lineNumber":168,"oldContent":"  final IconData icon;"}]},{"timestamp":1755129543665,"changes":[{"type":"DELETE","lineNumber":7,"oldContent":""},{"type":"DELETE","lineNumber":21,"oldContent":"    _NavItem("},{"type":"DELETE","lineNumber":22,"oldContent":"      icon: Icons.cameraswitch_rounded,"},{"type":"DELETE","lineNumber":23,"oldContent":"      label: 'Purchase Order',"},{"type":"DELETE","lineNumber":24,"oldContent":"      route: '/health',"},{"type":"DELETE","lineNumber":25,"oldContent":"    ),"},{"type":"INSERT","lineNumber":20,"content":"    _NavItem(icon: Icons.cameraswitch_rounded, label: 'Purchase Order', route: '/health'),"},{"type":"DELETE","lineNumber":27,"oldContent":"    _NavItem("},{"type":"DELETE","lineNumber":28,"oldContent":"      icon: Icons.history_outlined,"},{"type":"DELETE","lineNumber":29,"oldContent":"      label: 'activity',"},{"type":"DELETE","lineNumber":30,"oldContent":"      route: '/profile',"},{"type":"DELETE","lineNumber":31,"oldContent":"    ),"},{"type":"INSERT","lineNumber":22,"content":"    _NavItem(icon: Icons.history_outlined, label: 'activity', route: '/profile'),"},{"type":"DELETE","lineNumber":74,"oldContent":"                        fontWeight: selected"},{"type":"DELETE","lineNumber":75,"oldContent":"                            ? FontWeight.w700"},{"type":"DELETE","lineNumber":76,"oldContent":"                            : FontWeight.w500,"},{"type":"DELETE","lineNumber":77,"oldContent":"                        color: selected ? Colors.cyanAccent : Colors.white70,"},{"type":"INSERT","lineNumber":65,"content":"                        fontWeight:"},{"type":"INSERT","lineNumber":66,"content":"                        selected ? FontWeight.w700 : FontWeight.w500,"},{"type":"INSERT","lineNumber":67,"content":"                        color:"},{"type":"INSERT","lineNumber":68,"content":"                        selected ? Colors.cyanAccent : Colors.white70,"},{"type":"DELETE","lineNumber":91,"oldContent":"    final actions = <_ActionItem>["},{"type":"DELETE","lineNumber":92,"oldContent":"      _ActionItem("},{"type":"DELETE","lineNumber":93,"oldContent":"        icon: LucideIcons.scan,"},{"type":"DELETE","lineNumber":94,"oldContent":"        label: 'Scan Barcode',"},{"type":"DELETE","lineNumber":95,"oldContent":"        route: '/scan',"},{"type":"DELETE","lineNumber":96,"oldContent":"      ),"},{"type":"DELETE","lineNumber":97,"oldContent":"      _ActionItem("},{"type":"DELETE","lineNumber":98,"oldContent":"        icon: Icons.inventory_2_outlined,"},{"type":"DELETE","lineNumber":99,"oldContent":"        label: 'New Stock Take',"},{"type":"DELETE","lineNumber":100,"oldContent":"        route: '/new-stock-take',"},{"type":"DELETE","lineNumber":101,"oldContent":"      ),"},{"type":"DELETE","lineNumber":102,"oldContent":"      _ActionItem("},{"type":"DELETE","lineNumber":103,"oldContent":"        icon: Icons.precision_manufacturing,"},{"type":"DELETE","lineNumber":104,"oldContent":"        label: 'New Production',"},{"type":"DELETE","lineNumber":105,"oldContent":"        route: '/new-production',"},{"type":"DELETE","lineNumber":106,"oldContent":"      ),"},{"type":"DELETE","lineNumber":107,"oldContent":"      _ActionItem("},{"type":"DELETE","lineNumber":108,"oldContent":"        icon: Icons.article_outlined,"},{"type":"DELETE","lineNumber":109,"oldContent":"        label: 'New BOM',"},{"type":"DELETE","lineNumber":110,"oldContent":"        route: '/new-bom',"},{"type":"DELETE","lineNumber":111,"oldContent":"      ),"},{"type":"DELETE","lineNumber":112,"oldContent":"      _ActionItem("},{"type":"DELETE","lineNumber":113,"oldContent":"        icon: Icons.shopping_cart_outlined,"},{"type":"DELETE","lineNumber":114,"oldContent":"        label: 'New Order',"},{"type":"DELETE","lineNumber":115,"oldContent":"        route: '/new-order',"},{"type":"DELETE","lineNumber":116,"oldContent":"      ),"},{"type":"DELETE","lineNumber":117,"oldContent":"    ];"},{"type":"INSERT","lineNumber":82,"content":"    final actions = <_ActionItem>[ _ActionItem(icon: LucideIcons.scan, label: 'Scan Barcode', route: '/scan'), _ActionItem(icon: Icons.inventory_2_outlined, label: 'New Stock Take', route: '/new-stock-take'), _ActionItem(icon: Icons.precision_manufacturing, label: 'New Production', route: '/new-production'), _ActionItem(icon: Icons.article_outlined, label: 'New BOM', route: '/new-bom'), _ActionItem(icon: Icons.shopping_cart_outlined, label: 'New Order', route: '/new-order'), ];"},{"type":"INSERT","lineNumber":84,"content":"    return SpeedDial("},{"type":"DELETE","lineNumber":121,"oldContent":"    return SpeedDial("},{"type":"DELETE","lineNumber":142,"oldContent":"          .map("},{"type":"DELETE","lineNumber":143,"oldContent":"            (action) => SpeedDialChild("},{"type":"DELETE","lineNumber":144,"oldContent":"              backgroundColor: const Color(0xFF0E2330),"},{"type":"DELETE","lineNumber":145,"oldContent":"              child: Icon(action.icon, color: Colors.white, size: 20),"},{"type":"DELETE","lineNumber":146,"oldContent":"              label: action.label,"},{"type":"DELETE","lineNumber":147,"oldContent":"              labelStyle: const TextStyle(color: Colors.white, fontSize: 14),"},{"type":"DELETE","lineNumber":148,"oldContent":"              labelBackgroundColor: Colors.transparent,"},{"type":"DELETE","lineNumber":149,"oldContent":"              onTap: () => GoRouter.of(context).push(action.route),"},{"type":"DELETE","lineNumber":150,"oldContent":"            ),"},{"type":"DELETE","lineNumber":151,"oldContent":"          )"},{"type":"INSERT","lineNumber":107,"content":"          .map((action) => SpeedDialChild("},{"type":"INSERT","lineNumber":108,"content":"        backgroundColor: const Color(0xFF0E2330),"},{"type":"INSERT","lineNumber":109,"content":"        child: Icon(action.icon, color: Colors.white, size: 20),"},{"type":"INSERT","lineNumber":110,"content":"        label: action.label,"},{"type":"INSERT","lineNumber":111,"content":"        labelStyle:"},{"type":"INSERT","lineNumber":112,"content":"        const TextStyle(color: Colors.white, fontSize: 14),"},{"type":"INSERT","lineNumber":113,"content":"        labelBackgroundColor: Colors.transparent,"},{"type":"INSERT","lineNumber":114,"content":"        onTap: () => GoRouter.of(context).push(action.route),"},{"type":"INSERT","lineNumber":115,"content":"      ))"},{"type":"INSERT","lineNumber":116,"content":"          .toList(),"},{"type":"DELETE","lineNumber":153,"oldContent":"    );"},{"type":"DELETE","lineNumber":161,"oldContent":"  _NavItem({required this.icon, required this.label, required this.route});"},{"type":"DELETE","lineNumber":163,"oldContent":""},{"type":"INSERT","lineNumber":126,"content":"  _NavItem({required this.icon, required this.label, required this.route});"},{"type":"INSERT","lineNumber":128,"content":""},{"type":"DELETE","lineNumber":170,"oldContent":"  _ActionItem({required this.icon, required this.label, required this.route});"},{"type":"INSERT","lineNumber":134,"content":"  _ActionItem("},{"type":"INSERT","lineNumber":135,"content":"      {required this.icon, required this.label, required this.route});"},{"type":"DELETE","lineNumber":173,"oldContent":"              label: action.label,"}]},{"timestamp":1755129548334,"changes":[{"type":"MODIFY","lineNumber":3,"content":"import 'package:go_router/go_router.dart';","oldContent":"import 'package:flutter_lucide/flutter_lucide.dart';"},{"type":"INSERT","lineNumber":19,"content":"    _NavItem(icon: Icons.inventory_outlined, label: 'Stock', route: '/'),"},{"type":"DELETE","lineNumber":20,"oldContent":"  // ValueNotifier controls SpeedDial open/close and overlay visibility"},{"type":"MODIFY","lineNumber":22,"content":"    _NavItem(icon: Icons.history_outlined, label: 'activity', route: '/profile'),","oldContent":"    _NavItem(icon: Icons.history_outlined, label: 'activity', route: '/profile'),"},{"type":"DELETE","lineNumber":56,"oldContent":"                        fontWeight:"},{"type":"DELETE","lineNumber":58,"oldContent":"                        selected ? FontWeight.w700 : FontWeight.w500,"},{"type":"DELETE","lineNumber":60,"oldContent":"                        color:"},{"type":"DELETE","lineNumber":62,"oldContent":"                        selected ? Colors.cyanAccent : Colors.white70,"},{"type":"INSERT","lineNumber":65,"content":"                        fontWeight:"},{"type":"INSERT","lineNumber":66,"content":"                        selected ? FontWeight.w700 : FontWeight.w500,"},{"type":"INSERT","lineNumber":67,"content":"                        color:"},{"type":"INSERT","lineNumber":68,"content":"                        selected ? Colors.cyanAccent : Colors.white70,"},{"type":"DELETE","lineNumber":73,"oldContent":"    final actions = <_ActionItem>[ _ActionItem(icon: LucideIcons.scan, label: 'Scan Barcode', route: '/scan'), _ActionItem(icon: Icons.inventory_2_outlined, label: 'New Stock Take', route: '/new-stock-take'), _ActionItem(icon: Icons.precision_manufacturing, label: 'New Production', route: '/new-production'), _ActionItem(icon: Icons.article_outlined, label: 'New BOM', route: '/new-bom'), _ActionItem(icon: Icons.shopping_cart_outlined, label: 'New Order', route: '/new-order'), ];"},{"type":"DELETE","lineNumber":76,"oldContent":"    return SpeedDial("},{"type":"DELETE","lineNumber":84,"oldContent":"          .map((action) => SpeedDialChild("},{"type":"DELETE","lineNumber":85,"oldContent":"        backgroundColor: const Color(0xFF0E2330),"},{"type":"DELETE","lineNumber":86,"oldContent":"        child: Icon(action.icon, color: Colors.white, size: 20),"},{"type":"DELETE","lineNumber":87,"oldContent":"        label: action.label,"},{"type":"DELETE","lineNumber":88,"oldContent":"        labelStyle:"},{"type":"DELETE","lineNumber":89,"oldContent":"        const TextStyle(color: Colors.white, fontSize: 14),"},{"type":"DELETE","lineNumber":90,"oldContent":"        labelBackgroundColor: Colors.transparent,"},{"type":"DELETE","lineNumber":91,"oldContent":"        onTap: () => GoRouter.of(context).push(action.route),"},{"type":"DELETE","lineNumber":92,"oldContent":"      ))"},{"type":"DELETE","lineNumber":93,"oldContent":"          .toList(),"},{"type":"INSERT","lineNumber":82,"content":"    final actions = <_ActionItem>["},{"type":"INSERT","lineNumber":83,"content":"      _ActionItem(icon: LucideIcons.activity, label: 'Add blood pressure', route: '/bp'),"},{"type":"INSERT","lineNumber":84,"content":"      _ActionItem(icon: LucideIcons.weight, label: 'Add weight', route: '/weight'),"},{"type":"INSERT","lineNumber":85,"content":"      _ActionItem(icon: LucideIcons.pencil, label: 'Add activity', route: '/activity'),"},{"type":"INSERT","lineNumber":86,"content":"      _ActionItem(icon: Icons.run_circle_outlined, label: 'Track workout', route: '/workout'),"},{"type":"INSERT","lineNumber":87,"content":"    ];"},{"type":"INSERT","lineNumber":89,"content":"    return SpeedDial("},{"type":"DELETE","lineNumber":101,"oldContent":"  _NavItem({required this.icon, required this.label, required this.route});"},{"type":"DELETE","lineNumber":104,"oldContent":""},{"type":"DELETE","lineNumber":111,"oldContent":"  _ActionItem("},{"type":"DELETE","lineNumber":113,"oldContent":"      {required this.icon, required this.label, required this.route});"},{"type":"INSERT","lineNumber":112,"content":"          .map((action) => SpeedDialChild("},{"type":"INSERT","lineNumber":113,"content":"        backgroundColor: const Color(0xFF0E2330),"},{"type":"INSERT","lineNumber":114,"content":"        child: Icon(action.icon, color: Colors.white, size: 20),"},{"type":"INSERT","lineNumber":115,"content":"        label: action.label,"},{"type":"INSERT","lineNumber":116,"content":"        labelStyle:"},{"type":"INSERT","lineNumber":117,"content":"        const TextStyle(color: Colors.white, fontSize: 14),"},{"type":"INSERT","lineNumber":118,"content":"        labelBackgroundColor: Colors.transparent,"},{"type":"INSERT","lineNumber":119,"content":"        onTap: () => GoRouter.of(context).push(action.route),"},{"type":"INSERT","lineNumber":120,"content":"      ))"},{"type":"INSERT","lineNumber":121,"content":"          .toList(),"},{"type":"INSERT","lineNumber":131,"content":"  _NavItem({required this.icon, required this.label, required this.route});"},{"type":"INSERT","lineNumber":133,"content":""},{"type":"INSERT","lineNumber":139,"content":"  _ActionItem("},{"type":"INSERT","lineNumber":140,"content":"      {required this.icon, required this.label, required this.route});"}]},{"timestamp":1755129576267,"changes":[{"type":"INSERT","lineNumber":21,"content":"    _NavItem(icon: Icons.bar_chart_sharp, label: 'Reporting', route: '/stats'),"},{"type":"DELETE","lineNumber":22,"oldContent":"    _NavItem(icon: Icons.history_outlined, label: 'activity', route: '/profile'),"},{"type":"DELETE","lineNumber":61,"oldContent":"                        fontWeight:"},{"type":"DELETE","lineNumber":63,"oldContent":"                        selected ? FontWeight.w700 : FontWeight.w500,"},{"type":"DELETE","lineNumber":65,"oldContent":"                        color:"},{"type":"DELETE","lineNumber":67,"oldContent":"                        selected ? Colors.cyanAccent : Colors.white70,"},{"type":"INSERT","lineNumber":65,"content":"                        fontWeight:"},{"type":"INSERT","lineNumber":66,"content":"                        selected ? FontWeight.w700 : FontWeight.w500,"},{"type":"INSERT","lineNumber":67,"content":"                        color:"},{"type":"INSERT","lineNumber":68,"content":"                        selected ? Colors.cyanAccent : Colors.white70,"},{"type":"DELETE","lineNumber":80,"oldContent":"    final actions = <_ActionItem>["},{"type":"DELETE","lineNumber":82,"oldContent":"      _ActionItem(icon: LucideIcons.activity, label: 'Add blood pressure', route: '/bp'),"},{"type":"DELETE","lineNumber":84,"oldContent":"      _ActionItem(icon: LucideIcons.weight, label: 'Add weight', route: '/weight'),"},{"type":"DELETE","lineNumber":85,"oldContent":"      _ActionItem(icon: LucideIcons.pencil, label: 'Add activity', route: '/activity'),"},{"type":"DELETE","lineNumber":86,"oldContent":"      _ActionItem(icon: Icons.run_circle_outlined, label: 'Track workout', route: '/workout'),"},{"type":"DELETE","lineNumber":87,"oldContent":"    ];"},{"type":"DELETE","lineNumber":88,"oldContent":"    return SpeedDial("},{"type":"INSERT","lineNumber":82,"content":"    final actions = <_ActionItem>[ _ActionItem(icon: LucideIcons.scan, label: 'Scan Barcode', route: '/scan'), _ActionItem(icon: Icons.inventory_2_outlined, label: 'New Stock Take', route: '/new-stock-take'), _ActionItem(icon: Icons.precision_manufacturing, label: 'New Production', route: '/new-production'), _ActionItem(icon: Icons.article_outlined, label: 'New BOM', route: '/new-bom'), _ActionItem(icon: Icons.shopping_cart_outlined, label: 'New Order', route: '/new-order'), ];"},{"type":"INSERT","lineNumber":84,"content":"    return SpeedDial("},{"type":"DELETE","lineNumber":104,"oldContent":"          .map((action) => SpeedDialChild("},{"type":"INSERT","lineNumber":100,"content":"      overlayOpacity: 0.5,"},{"type":"INSERT","lineNumber":101,"content":"      overlayColor: Colors.black,"},{"type":"INSERT","lineNumber":102,"content":"      backgroundColor: Colors.transparent,"},{"type":"INSERT","lineNumber":103,"content":"      elevation: 0,"},{"type":"INSERT","lineNumber":104,"content":"      spacing: 10,"},{"type":"INSERT","lineNumber":105,"content":"      spaceBetweenChildren: 10,"},{"type":"INSERT","lineNumber":106,"content":"      children: actions"},{"type":"INSERT","lineNumber":107,"content":"          .map((action) => SpeedDialChild("},{"type":"DELETE","lineNumber":108,"oldContent":"      overlayOpacity: 0.5,"},{"type":"DELETE","lineNumber":110,"oldContent":"      overlayColor: Colors.black,"},{"type":"DELETE","lineNumber":112,"oldContent":"      backgroundColor: Colors.transparent,"},{"type":"DELETE","lineNumber":114,"oldContent":"      elevation: 0,"},{"type":"DELETE","lineNumber":116,"oldContent":"      spacing: 10,"},{"type":"DELETE","lineNumber":118,"oldContent":"      spaceBetweenChildren: 10,"},{"type":"DELETE","lineNumber":120,"oldContent":"      children: actions"},{"type":"DELETE","lineNumber":131,"oldContent":"}"},{"type":"INSERT","lineNumber":127,"content":"}"},{"type":"INSERT","lineNumber":128,"content":""},{"type":"DELETE","lineNumber":135,"oldContent":""},{"type":"INSERT","lineNumber":134,"content":"  _ActionItem("},{"type":"INSERT","lineNumber":135,"content":"      {required this.icon, required this.label, required this.route});"},{"type":"DELETE","lineNumber":141,"oldContent":"      {required this.icon, required this.label, required this.route});"},{"type":"DELETE","lineNumber":142,"oldContent":"  _ActionItem("}]},{"timestamp":1755129654633,"changes":[{"type":"INSERT","lineNumber":7,"content":""},{"type":"DELETE","lineNumber":20,"oldContent":"    _NavItem(icon: Icons.cameraswitch_rounded, label: 'Purchase Order', route: '/health'),"},{"type":"INSERT","lineNumber":21,"content":"    _NavItem("},{"type":"INSERT","lineNumber":22,"content":"      icon: Icons.cameraswitch_rounded,"},{"type":"INSERT","lineNumber":23,"content":"      label: 'Purchase Order',"},{"type":"INSERT","lineNumber":24,"content":"      route: '/health',"},{"type":"INSERT","lineNumber":25,"content":"    ),"},{"type":"DELETE","lineNumber":22,"oldContent":"    _NavItem(icon: Icons.history_outlined, label: 'activity', route: '/profile'),"},{"type":"INSERT","lineNumber":27,"content":"    _NavItem("},{"type":"INSERT","lineNumber":28,"content":"      icon: Icons.history_outlined,"},{"type":"INSERT","lineNumber":29,"content":"      label: 'activity',"},{"type":"INSERT","lineNumber":30,"content":"      route: '/profile',"},{"type":"INSERT","lineNumber":31,"content":"    ),"},{"type":"DELETE","lineNumber":63,"oldContent":"                        fontWeight:"},{"type":"DELETE","lineNumber":64,"oldContent":"                        selected ? FontWeight.w700 : FontWeight.w500,"},{"type":"DELETE","lineNumber":66,"oldContent":"                        color:"},{"type":"DELETE","lineNumber":67,"oldContent":"                        selected ? Colors.cyanAccent : Colors.white70,"},{"type":"INSERT","lineNumber":74,"content":"                        fontWeight: selected"},{"type":"INSERT","lineNumber":75,"content":"                            ? FontWeight.w700"},{"type":"INSERT","lineNumber":76,"content":"                            : FontWeight.w500,"},{"type":"INSERT","lineNumber":77,"content":"                        color: selected ? Colors.cyanAccent : Colors.white70,"},{"type":"DELETE","lineNumber":81,"oldContent":"    final actions = <_ActionItem>[ _ActionItem(icon: LucideIcons.scan, label: 'Scan Barcode', route: '/scan'), _ActionItem(icon: Icons.inventory_2_outlined, label: 'New Stock Take', route: '/new-stock-take'), _ActionItem(icon: Icons.precision_manufacturing, label: 'New Production', route: '/new-production'), _ActionItem(icon: Icons.article_outlined, label: 'New BOM', route: '/new-bom'), _ActionItem(icon: Icons.shopping_cart_outlined, label: 'New Order', route: '/new-order'), ];"},{"type":"DELETE","lineNumber":83,"oldContent":"    return SpeedDial("},{"type":"INSERT","lineNumber":91,"content":"    final actions = <_ActionItem>["},{"type":"INSERT","lineNumber":92,"content":"      _ActionItem("},{"type":"INSERT","lineNumber":93,"content":"        icon: LucideIcons.scan,"},{"type":"INSERT","lineNumber":94,"content":"        label: 'Scan Barcode',"},{"type":"INSERT","lineNumber":95,"content":"        route: '/scan',"},{"type":"INSERT","lineNumber":96,"content":"      ),"},{"type":"INSERT","lineNumber":97,"content":"      _ActionItem("},{"type":"INSERT","lineNumber":98,"content":"        icon: Icons.inventory_2_outlined,"},{"type":"INSERT","lineNumber":99,"content":"        label: 'New Stock Take',"},{"type":"INSERT","lineNumber":100,"content":"        route: '/new-stock-take',"},{"type":"INSERT","lineNumber":101,"content":"      ),"},{"type":"INSERT","lineNumber":102,"content":"      _ActionItem("},{"type":"INSERT","lineNumber":103,"content":"        icon: Icons.precision_manufacturing,"},{"type":"INSERT","lineNumber":104,"content":"        label: 'New Production',"},{"type":"INSERT","lineNumber":105,"content":"        route: '/new-production',"},{"type":"INSERT","lineNumber":106,"content":"      ),"},{"type":"INSERT","lineNumber":107,"content":"      _ActionItem("},{"type":"INSERT","lineNumber":108,"content":"        icon: Icons.article_outlined,"},{"type":"INSERT","lineNumber":109,"content":"        label: 'New BOM',"},{"type":"INSERT","lineNumber":110,"content":"        route: '/new-bom',"},{"type":"INSERT","lineNumber":111,"content":"      ),"},{"type":"INSERT","lineNumber":112,"content":"      _ActionItem("},{"type":"INSERT","lineNumber":113,"content":"        icon: Icons.shopping_cart_outlined,"},{"type":"INSERT","lineNumber":114,"content":"        label: 'New Order',"},{"type":"INSERT","lineNumber":115,"content":"        route: '/new-order',"},{"type":"INSERT","lineNumber":116,"content":"      ),"},{"type":"INSERT","lineNumber":117,"content":"    ];"},{"type":"INSERT","lineNumber":119,"content":"    return SpeedDial("},{"type":"DELETE","lineNumber":95,"oldContent":"      overlayOpacity: 0.5,"},{"type":"DELETE","lineNumber":97,"oldContent":"      overlayColor: Colors.black,"},{"type":"DELETE","lineNumber":99,"oldContent":"      backgroundColor: Colors.transparent,"},{"type":"DELETE","lineNumber":101,"oldContent":"      elevation: 0,"},{"type":"INSERT","lineNumber":134,"content":"      openCloseDial: _dialOpen,"},{"type":"INSERT","lineNumber":135,"content":"      overlayOpacity: 0.5,"},{"type":"INSERT","lineNumber":136,"content":"      overlayColor: Colors.black,"},{"type":"INSERT","lineNumber":137,"content":"      backgroundColor: Colors.transparent,"},{"type":"INSERT","lineNumber":138,"content":"      elevation: 0,"},{"type":"DELETE","lineNumber":105,"oldContent":"      openCloseDial: _dialOpen,"},{"type":"DELETE","lineNumber":107,"oldContent":"        backgroundColor: const Color(0xFF0E2330),"},{"type":"DELETE","lineNumber":108,"oldContent":"          .map((action) => SpeedDialChild("},{"type":"DELETE","lineNumber":109,"oldContent":"        child: Icon(action.icon, color: Colors.white, size: 20),"},{"type":"DELETE","lineNumber":110,"oldContent":"        label: action.label,"},{"type":"DELETE","lineNumber":111,"oldContent":"        labelStyle:"},{"type":"DELETE","lineNumber":112,"oldContent":"        const TextStyle(color: Colors.white, fontSize: 14),"},{"type":"DELETE","lineNumber":113,"oldContent":"        labelBackgroundColor: Colors.transparent,"},{"type":"DELETE","lineNumber":114,"oldContent":"        onTap: () => GoRouter.of(context).push(action.route),"},{"type":"DELETE","lineNumber":115,"oldContent":"      ))"},{"type":"INSERT","lineNumber":142,"content":"          .map("},{"type":"INSERT","lineNumber":143,"content":"            (action) => SpeedDialChild("},{"type":"INSERT","lineNumber":144,"content":"              backgroundColor: const Color(0xFF0E2330),"},{"type":"INSERT","lineNumber":145,"content":"              child: Icon(action.icon, color: Colors.white, size: 20),"},{"type":"INSERT","lineNumber":146,"content":"              label: action.label,"},{"type":"INSERT","lineNumber":147,"content":"              labelStyle: const TextStyle(color: Colors.white, fontSize: 14),"},{"type":"INSERT","lineNumber":148,"content":"              labelBackgroundColor: Colors.transparent,"},{"type":"INSERT","lineNumber":149,"content":"              onTap: () => GoRouter.of(context).push(action.route),"},{"type":"INSERT","lineNumber":150,"content":"            ),"},{"type":"INSERT","lineNumber":151,"content":"          )"},{"type":"DELETE","lineNumber":122,"oldContent":"}"},{"type":"DELETE","lineNumber":124,"oldContent":""},{"type":"INSERT","lineNumber":163,"content":"}"},{"type":"INSERT","lineNumber":164,"content":""},{"type":"DELETE","lineNumber":130,"oldContent":"  _ActionItem("},{"type":"DELETE","lineNumber":132,"oldContent":"      {required this.icon, required this.label, required this.route});"},{"type":"INSERT","lineNumber":170,"content":"  _ActionItem({required this.icon, required this.label, required this.route});"}]},{"timestamp":1755129728898,"changes":[{"type":"DELETE","lineNumber":7,"oldContent":""},{"type":"DELETE","lineNumber":16,"oldContent":""},{"type":"DELETE","lineNumber":21,"oldContent":"    _NavItem("},{"type":"INSERT","lineNumber":19,"content":"    _NavItem(icon: Icons.cameraswitch_rounded, label: 'Purchase Order', route: '/health'),"},{"type":"DELETE","lineNumber":23,"oldContent":"      icon: Icons.cameraswitch_rounded,"},{"type":"DELETE","lineNumber":24,"oldContent":"      label: 'Purchase Order',"},{"type":"INSERT","lineNumber":21,"content":"    _NavItem(icon: Icons.history_outlined, label: 'Activity', route: '/profile'),"},{"type":"DELETE","lineNumber":26,"oldContent":"      route: '/health',"},{"type":"DELETE","lineNumber":28,"oldContent":"    ),"},{"type":"DELETE","lineNumber":30,"oldContent":"    setState(() {"},{"type":"DELETE","lineNumber":31,"oldContent":"    _NavItem("},{"type":"DELETE","lineNumber":32,"oldContent":"      _selectedIndex = index;"},{"type":"DELETE","lineNumber":33,"oldContent":"      icon: Icons.history_outlined,"},{"type":"DELETE","lineNumber":34,"oldContent":"    });"},{"type":"DELETE","lineNumber":35,"oldContent":"      label: 'activity',"},{"type":"INSERT","lineNumber":25,"content":"    setState(() => _selectedIndex = index);"},{"type":"DELETE","lineNumber":37,"oldContent":"      route: '/profile',"},{"type":"DELETE","lineNumber":39,"oldContent":"    ),"},{"type":"DELETE","lineNumber":47,"oldContent":"      floatingActionButton: _buildFab(theme, 56, 28),"},{"type":"INSERT","lineNumber":35,"content":"      floatingActionButton: _buildFab(theme, 56),"},{"type":"INSERT","lineNumber":62,"content":"                        fontWeight: selected ? FontWeight.w700 : FontWeight.w500,"},{"type":"INSERT","lineNumber":63,"content":"                        color: selected ? Colors.cyanAccent : Colors.white70,"},{"type":"DELETE","lineNumber":79,"oldContent":"                        fontWeight: selected"},{"type":"DELETE","lineNumber":81,"oldContent":"                            ? FontWeight.w700"},{"type":"DELETE","lineNumber":83,"oldContent":"                            : FontWeight.w500,"},{"type":"DELETE","lineNumber":85,"oldContent":"                        color: selected ? Colors.cyanAccent : Colors.white70,"},{"type":"DELETE","lineNumber":90,"oldContent":"  Widget _buildFab(ThemeData theme, double diameter, double iconSize) {"},{"type":"DELETE","lineNumber":91,"oldContent":""},{"type":"DELETE","lineNumber":92,"oldContent":"      icon: null,"},{"type":"DELETE","lineNumber":93,"oldContent":"      child: AnimatedRotation("},{"type":"DELETE","lineNumber":94,"oldContent":"        duration: const Duration(milliseconds: 250),"},{"type":"DELETE","lineNumber":95,"oldContent":"        turns: _dialOpen.value ? 0.125 : 0,"},{"type":"DELETE","lineNumber":96,"oldContent":"        child: Container("},{"type":"DELETE","lineNumber":97,"oldContent":"          width: diameter,"},{"type":"INSERT","lineNumber":76,"content":"  Widget _buildFab(ThemeData theme, double diameter) {"},{"type":"DELETE","lineNumber":99,"oldContent":"          height: diameter,"},{"type":"DELETE","lineNumber":100,"oldContent":"      _ActionItem("},{"type":"DELETE","lineNumber":101,"oldContent":"          decoration: const BoxDecoration("},{"type":"DELETE","lineNumber":102,"oldContent":"        icon: LucideIcons.scan,"},{"type":"DELETE","lineNumber":103,"oldContent":"            color: Color(0xFF0E2330),"},{"type":"DELETE","lineNumber":104,"oldContent":"        label: 'Scan Barcode',"},{"type":"DELETE","lineNumber":105,"oldContent":"            shape: BoxShape.circle,"},{"type":"DELETE","lineNumber":106,"oldContent":"        route: '/scan',"},{"type":"DELETE","lineNumber":107,"oldContent":"      ),"},{"type":"DELETE","lineNumber":108,"oldContent":"          ),"},{"type":"DELETE","lineNumber":109,"oldContent":"      _ActionItem("},{"type":"DELETE","lineNumber":110,"oldContent":"        icon: Icons.inventory_2_outlined,"},{"type":"DELETE","lineNumber":111,"oldContent":"          child: const Icon(Icons.add, color: Colors.white, size: 28),"},{"type":"DELETE","lineNumber":112,"oldContent":"        label: 'New Stock Take',"},{"type":"DELETE","lineNumber":113,"oldContent":"        route: '/new-stock-take',"},{"type":"DELETE","lineNumber":114,"oldContent":"        ),"},{"type":"DELETE","lineNumber":115,"oldContent":"      ),"},{"type":"DELETE","lineNumber":116,"oldContent":"      _ActionItem("},{"type":"DELETE","lineNumber":117,"oldContent":"      ),"},{"type":"DELETE","lineNumber":118,"oldContent":"        icon: Icons.precision_manufacturing,"},{"type":"DELETE","lineNumber":119,"oldContent":"      spacing: 10,"},{"type":"DELETE","lineNumber":120,"oldContent":"        label: 'New Production',"},{"type":"DELETE","lineNumber":121,"oldContent":"      spaceBetweenChildren: 10,"},{"type":"DELETE","lineNumber":122,"oldContent":"        route: '/new-production',"},{"type":"DELETE","lineNumber":123,"oldContent":"      ),"},{"type":"INSERT","lineNumber":78,"content":"      _ActionItem(icon: LucideIcons.scan, label: 'Scan Barcode', route: '/scan'),"},{"type":"INSERT","lineNumber":79,"content":"      _ActionItem(icon: Icons.inventory_2_outlined, label: 'New Stock Take', route: '/new-stock-take'),"},{"type":"INSERT","lineNumber":80,"content":"      _ActionItem(icon: Icons.precision_manufacturing, label: 'New Production', route: '/new-production'),"},{"type":"INSERT","lineNumber":81,"content":"      _ActionItem(icon: Icons.article_outlined, label: 'New BOM', route: '/new-bom'),"},{"type":"INSERT","lineNumber":82,"content":"      _ActionItem(icon: Icons.shopping_cart_outlined, label: 'New Order', route: '/new-order'),"},{"type":"INSERT","lineNumber":83,"content":"    ];"},{"type":"INSERT","lineNumber":84,"content":""},{"type":"INSERT","lineNumber":85,"content":"    return SpeedDial("},{"type":"INSERT","lineNumber":86,"content":"      icon: null, // We handle our own icon animation"},{"type":"INSERT","lineNumber":87,"content":"      openCloseDial: _dialOpen,"},{"type":"INSERT","lineNumber":88,"content":"      overlayOpacity: 0.5,"},{"type":"INSERT","lineNumber":89,"content":"      overlayColor: Colors.black,"},{"type":"INSERT","lineNumber":90,"content":"      backgroundColor: Colors.transparent,"},{"type":"INSERT","lineNumber":91,"content":"      elevation: 0,"},{"type":"INSERT","lineNumber":92,"content":"      spacing: 8,"},{"type":"INSERT","lineNumber":93,"content":"      spaceBetweenChildren: 8,"},{"type":"DELETE","lineNumber":125,"oldContent":"      _ActionItem("},{"type":"DELETE","lineNumber":126,"oldContent":"        icon: Icons.article_outlined,"},{"type":"DELETE","lineNumber":127,"oldContent":"        label: 'New BOM',"},{"type":"DELETE","lineNumber":128,"oldContent":"        route: '/new-bom',"},{"type":"DELETE","lineNumber":129,"oldContent":"      ),"},{"type":"DELETE","lineNumber":130,"oldContent":"      _ActionItem("},{"type":"DELETE","lineNumber":131,"oldContent":"        icon: Icons.shopping_cart_outlined,"},{"type":"DELETE","lineNumber":132,"oldContent":"        label: 'New Order',"},{"type":"DELETE","lineNumber":133,"oldContent":"        route: '/new-order',"},{"type":"DELETE","lineNumber":134,"oldContent":"      ),"},{"type":"INSERT","lineNumber":95,"content":"          .map((action) => SpeedDialChild("},{"type":"INSERT","lineNumber":96,"content":"        backgroundColor: const Color(0xFF0E2330),"},{"type":"INSERT","lineNumber":97,"content":"        child: Icon(action.icon, color: Colors.white, size: 18), // smaller icon"},{"type":"INSERT","lineNumber":98,"content":"        label: action.label,"},{"type":"INSERT","lineNumber":99,"content":"        labelStyle: const TextStyle(color: Colors.white, fontSize: 13),"},{"type":"INSERT","lineNumber":100,"content":"        labelBackgroundColor: Colors.transparent,"},{"type":"INSERT","lineNumber":101,"content":"        onTap: () => GoRouter.of(context).push(action.route),"},{"type":"INSERT","lineNumber":102,"content":"      ))"},{"type":"DELETE","lineNumber":136,"oldContent":"    ];"},{"type":"INSERT","lineNumber":104,"content":"      child: ValueListenableBuilder<bool>("},{"type":"INSERT","lineNumber":105,"content":"        valueListenable: _dialOpen,"},{"type":"INSERT","lineNumber":106,"content":"        builder: (context, isOpen, _) {"},{"type":"INSERT","lineNumber":107,"content":"          return AnimatedRotation("},{"type":"INSERT","lineNumber":108,"content":"            duration: const Duration(milliseconds: 250),"},{"type":"INSERT","lineNumber":109,"content":"            turns: isOpen ? 0.125 : 0, // 45 rotation"},{"type":"INSERT","lineNumber":110,"content":"            child: Container("},{"type":"INSERT","lineNumber":111,"content":"              width: diameter,"},{"type":"INSERT","lineNumber":112,"content":"              height: diameter,"},{"type":"INSERT","lineNumber":113,"content":"              decoration: const BoxDecoration("},{"type":"INSERT","lineNumber":114,"content":"                color: Color(0xFF0E2330),"},{"type":"INSERT","lineNumber":115,"content":"                shape: BoxShape.circle,"},{"type":"INSERT","lineNumber":116,"content":"              ),"},{"type":"INSERT","lineNumber":117,"content":"              child: const Icon(Icons.add, color: Colors.white, size: 28),"},{"type":"INSERT","lineNumber":118,"content":"            ),"},{"type":"INSERT","lineNumber":119,"content":"          );"},{"type":"INSERT","lineNumber":120,"content":"        },"},{"type":"INSERT","lineNumber":121,"content":"      ),"},{"type":"DELETE","lineNumber":139,"oldContent":"    return SpeedDial("},{"type":"DELETE","lineNumber":146,"oldContent":""},{"type":"INSERT","lineNumber":131,"content":"}"},{"type":"INSERT","lineNumber":132,"content":""},{"type":"DELETE","lineNumber":151,"oldContent":"      openCloseDial: _dialOpen,"},{"type":"DELETE","lineNumber":153,"oldContent":"      overlayOpacity: 0.5,"},{"type":"DELETE","lineNumber":154,"oldContent":""},{"type":"DELETE","lineNumber":155,"oldContent":"      overlayColor: Colors.black,"},{"type":"DELETE","lineNumber":156,"oldContent":"}"},{"type":"DELETE","lineNumber":157,"oldContent":"      backgroundColor: Colors.transparent,"},{"type":"DELETE","lineNumber":158,"oldContent":""},{"type":"DELETE","lineNumber":159,"oldContent":"      elevation: 0,"},{"type":"DELETE","lineNumber":161,"oldContent":""},{"type":"DELETE","lineNumber":163,"oldContent":"          )"},{"type":"DELETE","lineNumber":164,"oldContent":"          .map("},{"type":"DELETE","lineNumber":165,"oldContent":"            ),"},{"type":"DELETE","lineNumber":166,"oldContent":"            (action) => SpeedDialChild("},{"type":"DELETE","lineNumber":167,"oldContent":"              onTap: () => GoRouter.of(context).push(action.route),"},{"type":"DELETE","lineNumber":168,"oldContent":"              backgroundColor: const Color(0xFF0E2330),"},{"type":"DELETE","lineNumber":169,"oldContent":"              labelBackgroundColor: Colors.transparent,"},{"type":"DELETE","lineNumber":170,"oldContent":"              child: Icon(action.icon, color: Colors.white, size: 20),"},{"type":"DELETE","lineNumber":171,"oldContent":"              labelStyle: const TextStyle(color: Colors.white, fontSize: 14),"},{"type":"DELETE","lineNumber":172,"oldContent":"              label: action.label,"},{"type":"INSERT","lineNumber":139,"content":""}]},{"timestamp":1755129791963,"changes":[{"type":"DELETE","lineNumber":17,"oldContent":"    _NavItem(icon: Icons.cameraswitch_rounded, label: 'Purchase Order', route: '/health'),"},{"type":"MODIFY","lineNumber":19,"content":"    _NavItem(icon: Icons.cameraswitch_rounded, label: 'Purchase Order', route: '/health'),","oldContent":"    _NavItem(icon: Icons.history_outlined, label: 'Activity', route: '/profile'),"},{"type":"DELETE","lineNumber":22,"oldContent":"    setState(() => _selectedIndex = index);"},{"type":"INSERT","lineNumber":21,"content":"    _NavItem(icon: Icons.history_outlined, label: 'Activity', route: '/profile'),"},{"type":"DELETE","lineNumber":26,"oldContent":"      floatingActionButton: _buildFab(theme, 56),"},{"type":"INSERT","lineNumber":25,"content":"    setState(() => _selectedIndex = index);"},{"type":"INSERT","lineNumber":35,"content":"      floatingActionButton: _buildFab(theme, 56),"},{"type":"DELETE","lineNumber":50,"oldContent":"                        fontWeight: selected ? FontWeight.w700 : FontWeight.w500,"},{"type":"DELETE","lineNumber":52,"oldContent":"                        color: selected ? Colors.cyanAccent : Colors.white70,"},{"type":"INSERT","lineNumber":62,"content":"                        fontWeight: selected ? FontWeight.w700 : FontWeight.w500,"},{"type":"INSERT","lineNumber":63,"content":"                        color: selected ? Colors.cyanAccent : Colors.white70,"},{"type":"DELETE","lineNumber":66,"oldContent":"  Widget _buildFab(ThemeData theme, double diameter) {"},{"type":"MODIFY","lineNumber":69,"content":"            }),","oldContent":"      _ActionItem(icon: LucideIcons.scan, label: 'Scan Barcode', route: '/scan'),"},{"type":"INSERT","lineNumber":70,"content":"          ),"},{"type":"INSERT","lineNumber":71,"content":"        ),"},{"type":"INSERT","lineNumber":72,"content":"      ),"},{"type":"INSERT","lineNumber":73,"content":"    );"},{"type":"INSERT","lineNumber":74,"content":"  }"},{"type":"INSERT","lineNumber":75,"content":""},{"type":"INSERT","lineNumber":76,"content":"  Widget _buildFab(ThemeData theme, double diameter) {"},{"type":"INSERT","lineNumber":77,"content":"    final actions = <_ActionItem>["},{"type":"INSERT","lineNumber":78,"content":"      _ActionItem(icon: LucideIcons.scan, label: 'Scan Barcode', route: '/scan'),"},{"type":"DELETE","lineNumber":73,"oldContent":"            }),"},{"type":"DELETE","lineNumber":76,"oldContent":"          ),"},{"type":"DELETE","lineNumber":79,"oldContent":"        ),"},{"type":"DELETE","lineNumber":82,"oldContent":"      ),"},{"type":"DELETE","lineNumber":84,"oldContent":"    );"},{"type":"DELETE","lineNumber":86,"oldContent":"  }"},{"type":"DELETE","lineNumber":88,"oldContent":""},{"type":"MODIFY","lineNumber":91,"content":"      elevation: 1,","oldContent":"      elevation: 0,"},{"type":"INSERT","lineNumber":94,"content":"      children: actions"},{"type":"DELETE","lineNumber":97,"oldContent":"    final actions = <_ActionItem>["},{"type":"INSERT","lineNumber":103,"content":"          .toList(),"},{"type":"DELETE","lineNumber":120,"oldContent":"      children: actions"},{"type":"DELETE","lineNumber":121,"oldContent":"}"},{"type":"DELETE","lineNumber":122,"oldContent":""},{"type":"DELETE","lineNumber":123,"oldContent":"          .toList(),"},{"type":"DELETE","lineNumber":126,"oldContent":""},{"type":"INSERT","lineNumber":131,"content":"}"},{"type":"INSERT","lineNumber":132,"content":""},{"type":"INSERT","lineNumber":139,"content":""}]},{"timestamp":1755129814012,"changes":[{"type":"INSERT","lineNumber":18,"content":"    _NavItem(icon: Icons.inventory_outlined, label: 'Stock', route: '/'),"},{"type":"DELETE","lineNumber":19,"oldContent":"    _NavItem(icon: Icons.history_outlined, label: 'Activity', route: '/profile'),"},{"type":"MODIFY","lineNumber":21,"content":"    _NavItem(icon: Icons.history_outlined, label: 'Activity', route: '/profile'),","oldContent":"    _NavItem(icon: Icons.history_outlined, label: 'Activity', route: '/profile'),"},{"type":"MODIFY","lineNumber":25,"content":"    setState(() => _selectedIndex = index);","oldContent":"    setState(() => _selectedIndex = index);"},{"type":"MODIFY","lineNumber":35,"content":"      floatingActionButton: _buildFab(theme, 56),","oldContent":"      floatingActionButton: _buildFab(theme, 56),"},{"type":"DELETE","lineNumber":60,"oldContent":"                        fontWeight: selected ? FontWeight.w700 : FontWeight.w500,"},{"type":"MODIFY","lineNumber":62,"content":"                        fontWeight: selected ? FontWeight.w700 : FontWeight.w500,","oldContent":"                        color: selected ? Colors.cyanAccent : Colors.white70,"},{"type":"INSERT","lineNumber":63,"content":"                        color: selected ? Colors.cyanAccent : Colors.white70,"},{"type":"INSERT","lineNumber":68,"content":"              );"},{"type":"DELETE","lineNumber":70,"oldContent":"              );"},{"type":"DELETE","lineNumber":72,"oldContent":"      _ActionItem(icon: Icons.inventory_2_outlined, label: 'New Stock Take', route: '/new-stock-take'),"},{"type":"DELETE","lineNumber":74,"oldContent":"      _ActionItem(icon: Icons.precision_manufacturing, label: 'New Production', route: '/new-production'),"},{"type":"DELETE","lineNumber":77,"oldContent":"      _ActionItem(icon: Icons.article_outlined, label: 'New BOM', route: '/new-bom'),"},{"type":"DELETE","lineNumber":79,"oldContent":"      _ActionItem(icon: Icons.shopping_cart_outlined, label: 'New Order', route: '/new-order'),"},{"type":"DELETE","lineNumber":82,"oldContent":"    ];"},{"type":"INSERT","lineNumber":79,"content":"      _ActionItem(icon: Icons.inventory_2_outlined, label: 'New Stock Take', route: '/new-stock-take'),"},{"type":"INSERT","lineNumber":80,"content":"      _ActionItem(icon: Icons.precision_manufacturing, label: 'New Production', route: '/new-production'),"},{"type":"INSERT","lineNumber":81,"content":"      _ActionItem(icon: Icons.article_outlined, label: 'New BOM', route: '/new-bom'),"},{"type":"INSERT","lineNumber":82,"content":"      _ActionItem(icon: Icons.shopping_cart_outlined, label: 'New Order', route: '/new-order'),"},{"type":"INSERT","lineNumber":83,"content":"    ];"},{"type":"MODIFY","lineNumber":92,"content":"      spacing: 5,","oldContent":"      elevation: 0,"},{"type":"MODIFY","lineNumber":95,"content":"          .map((action) => SpeedDialChild(","oldContent":"          .map((action) => SpeedDialChild("},{"type":"MODIFY","lineNumber":104,"content":"      child: ValueListenableBuilder<bool>(","oldContent":"      child: ValueListenableBuilder<bool>("},{"type":"DELETE","lineNumber":128,"oldContent":"}"},{"type":"DELETE","lineNumber":130,"oldContent":""},{"type":"INSERT","lineNumber":131,"content":"}"},{"type":"INSERT","lineNumber":132,"content":""},{"type":"MODIFY","lineNumber":139,"content":"","oldContent":""}]},{"timestamp":1755129821399,"changes":[{"type":"INSERT","lineNumber":20,"content":"    _NavItem(icon: Icons.bar_chart_sharp, label: 'Reporting', route: '/stats'),"},{"type":"DELETE","lineNumber":21,"oldContent":"    _NavItem(icon: Icons.history_outlined, label: 'Activity', route: '/profile'),"},{"type":"INSERT","lineNumber":24,"content":"  void _onItemTapped(int index) {"},{"type":"DELETE","lineNumber":25,"oldContent":"    setState(() => _selectedIndex = index);"},{"type":"INSERT","lineNumber":34,"content":"      body: widget.child,"},{"type":"DELETE","lineNumber":35,"oldContent":"      floatingActionButton: _buildFab(theme, 56),"},{"type":"INSERT","lineNumber":61,"content":"                        fontSize: 11,"},{"type":"DELETE","lineNumber":63,"oldContent":"                        fontSize: 11,"},{"type":"INSERT","lineNumber":76,"content":"  Widget _buildFab(ThemeData theme, double diameter) {"},{"type":"INSERT","lineNumber":77,"content":"    final actions = <_ActionItem>["},{"type":"INSERT","lineNumber":78,"content":"      _ActionItem(icon: LucideIcons.scan, label: 'Scan Barcode', route: '/scan'),"},{"type":"DELETE","lineNumber":78,"oldContent":"  Widget _buildFab(ThemeData theme, double diameter) {"},{"type":"DELETE","lineNumber":80,"oldContent":"    final actions = <_ActionItem>["},{"type":"DELETE","lineNumber":83,"oldContent":"      _ActionItem(icon: LucideIcons.scan, label: 'Scan Barcode', route: '/scan'),"},{"type":"MODIFY","lineNumber":91,"content":"      elevation: 1,","oldContent":"      elevation: 0,"},{"type":"MODIFY","lineNumber":93,"content":"      spaceBetweenChildren: 5,","oldContent":"      spaceBetweenChildren: 8,"},{"type":"INSERT","lineNumber":94,"content":"      children: actions"},{"type":"DELETE","lineNumber":95,"oldContent":"          .map((action) => SpeedDialChild("},{"type":"INSERT","lineNumber":103,"content":"          .toList(),"},{"type":"DELETE","lineNumber":104,"oldContent":"      child: ValueListenableBuilder<bool>("},{"type":"DELETE","lineNumber":129,"oldContent":"}"},{"type":"MODIFY","lineNumber":131,"content":"}","oldContent":""},{"type":"INSERT","lineNumber":132,"content":""},{"type":"INSERT","lineNumber":138,"content":"}"},{"type":"DELETE","lineNumber":139,"oldContent":""}]},{"timestamp":1755129950511,"changes":[{"type":"MODIFY","lineNumber":19,"content":"    _NavItem(icon: Icons.add, label: 'Purchase Order', route: '/health'),","oldContent":"    _NavItem(icon: Icons.cameraswitch_rounded, label: 'Purchase Order', route: '/health'),"},{"type":"DELETE","lineNumber":77,"oldContent":"      _ActionItem(icon: Icons.inventory_2_outlined, label: 'New Stock Take', route: '/new-stock-take'),"},{"type":"MODIFY","lineNumber":79,"content":"      _ActionItem(icon: Icons.inventory_2_outlined, label: 'New Stock Take', route: '/new-stock-take'),","oldContent":"      _ActionItem(icon: Icons.precision_manufacturing, label: 'New Production', route: '/new-production'),"},{"type":"INSERT","lineNumber":80,"content":"      _ActionItem(icon: Icons.precision_manufacturing, label: 'New Production', route: '/new-production'),"},{"type":"INSERT","lineNumber":130,"content":"  _NavItem({required this.icon, required this.label, required this.route});"},{"type":"DELETE","lineNumber":132,"oldContent":"  _NavItem({required this.icon, required this.label, required this.route});"}]},{"timestamp":1755129958686,"changes":[{"type":"MODIFY","lineNumber":5,"content":"class MainScaffold extends StatefulWidget {","oldContent":"import 'package:flutter_speed_dial/flutter_speed_dial.dart';"},{"type":"MODIFY","lineNumber":10,"content":"  State<MainScaffold> createState() => _MainScaffoldState();","oldContent":"  const MainScaffold({super.key, required this.child});"},{"type":"MODIFY","lineNumber":13,"content":"class _MainScaffoldState extends State<MainScaffold> {","oldContent":"  ConsumerState<MainScaffold> createState() => _MainScaffoldState();"},{"type":"MODIFY","lineNumber":15,"content":"  int _selectedIndex = 0;","oldContent":"class _MainScaffoldState extends ConsumerState<MainScaffold> {"},{"type":"MODIFY","lineNumber":17,"content":"  final List<_NavItem> _navItems = [","oldContent":""},{"type":"MODIFY","lineNumber":19,"content":"    _NavItem(icon: Icons.add_business_outlined, label: 'Purchase Order', route: '/health'),","oldContent":"    _NavItem(icon: Icons.add, label: 'Purchase Order', route: '/health'),"},{"type":"DELETE","lineNumber":37,"oldContent":"    _dialOpen.dispose();"},{"type":"DELETE","lineNumber":38,"oldContent":"    super.dispose();"},{"type":"DELETE","lineNumber":39,"oldContent":"  }"},{"type":"DELETE","lineNumber":40,"oldContent":""},{"type":"DELETE","lineNumber":41,"oldContent":"  void _onItemTapped(int index) {"},{"type":"DELETE","lineNumber":42,"oldContent":"    if (_selectedIndex == index) return;"},{"type":"DELETE","lineNumber":43,"oldContent":"    setState(() => _selectedIndex = index);"},{"type":"DELETE","lineNumber":44,"oldContent":"    context.go(_navItems[index].route);"},{"type":"DELETE","lineNumber":45,"oldContent":"  }"},{"type":"DELETE","lineNumber":46,"oldContent":""},{"type":"DELETE","lineNumber":47,"oldContent":"  @override"},{"type":"DELETE","lineNumber":48,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":49,"oldContent":"    final theme = Theme.of(context);"},{"type":"DELETE","lineNumber":50,"oldContent":""},{"type":"DELETE","lineNumber":51,"oldContent":"    // Layout constants (small, tidy)"},{"type":"DELETE","lineNumber":52,"oldContent":"    const double navHeight = 60.0;"},{"type":"DELETE","lineNumber":53,"oldContent":"    const double indicatorWidth = 60.0;"},{"type":"DELETE","lineNumber":54,"oldContent":"    const double indicatorHeight = 34.0;"},{"type":"DELETE","lineNumber":55,"oldContent":"    const double iconSize = 18.0;"},{"type":"DELETE","lineNumber":56,"oldContent":"    const double fabDiameter = 48.0;"},{"type":"DELETE","lineNumber":57,"oldContent":"    const double fabIconSize = 18.0;"},{"type":"DELETE","lineNumber":58,"oldContent":"    final Color activeColor = theme.colorScheme.primary;"},{"type":"DELETE","lineNumber":59,"oldContent":"    final Color inactiveColor = theme.colorScheme.onSurface.withOpacity(0.68);"},{"type":"DELETE","lineNumber":60,"oldContent":""},{"type":"INSERT","lineNumber":37,"content":"      bottomNavigationBar: SafeArea("},{"type":"INSERT","lineNumber":38,"content":"        top: false,"},{"type":"INSERT","lineNumber":39,"content":"        child: Container("},{"type":"INSERT","lineNumber":40,"content":"          height: 60,"},{"type":"INSERT","lineNumber":41,"content":"          color: const Color(0xFF0E2330),"},{"type":"INSERT","lineNumber":42,"content":"          child: Row("},{"type":"INSERT","lineNumber":43,"content":"            mainAxisAlignment: MainAxisAlignment.spaceAround,"},{"type":"INSERT","lineNumber":44,"content":"            children: List.generate(_navItems.length, (i) {"},{"type":"INSERT","lineNumber":45,"content":"              final item = _navItems[i];"},{"type":"INSERT","lineNumber":46,"content":"              final selected = i == _selectedIndex;"},{"type":"INSERT","lineNumber":47,"content":"              return InkWell("},{"type":"INSERT","lineNumber":48,"content":"                onTap: () => _onItemTapped(i),"},{"type":"INSERT","lineNumber":49,"content":"                child: Column("},{"type":"INSERT","lineNumber":50,"content":"                  mainAxisAlignment: MainAxisAlignment.center,"},{"type":"INSERT","lineNumber":51,"content":"                  children: ["},{"type":"INSERT","lineNumber":52,"content":"                    Icon("},{"type":"INSERT","lineNumber":53,"content":"                      item.icon,"},{"type":"INSERT","lineNumber":54,"content":"                      size: selected ? 26 : 24,"},{"type":"INSERT","lineNumber":55,"content":"                      color: selected ? Colors.cyanAccent : Colors.white,"},{"type":"INSERT","lineNumber":56,"content":"                    ),"},{"type":"INSERT","lineNumber":57,"content":"                    const SizedBox(height: 3),"},{"type":"INSERT","lineNumber":58,"content":"                    Text("},{"type":"INSERT","lineNumber":59,"content":"                      item.label,"},{"type":"INSERT","lineNumber":60,"content":"                      style: TextStyle("},{"type":"INSERT","lineNumber":78,"content":"      _ActionItem(icon: LucideIcons.scan, label: 'Scan Barcode', route: '/scan'),"},{"type":"DELETE","lineNumber":80,"oldContent":"      _ActionItem(icon: LucideIcons.scan, label: 'Scan Barcode', route: '/scan'),"},{"type":"DELETE","lineNumber":137,"oldContent":"                        ),"},{"type":"DELETE","lineNumber":138,"oldContent":"}"},{"type":"DELETE","lineNumber":139,"oldContent":""},{"type":"DELETE","lineNumber":140,"oldContent":"            ),"},{"type":"DELETE","lineNumber":141,"oldContent":"              labelStyle: const TextStyle(color: Colors.white, fontSize: 14),"},{"type":"DELETE","lineNumber":142,"oldContent":"                ),"},{"type":"DELETE","lineNumber":143,"oldContent":"              labelBackgroundColor: Colors.transparent,"},{"type":"DELETE","lineNumber":144,"oldContent":"          )"},{"type":"DELETE","lineNumber":145,"oldContent":"              onTap: () => GoRouter.of(context).push(action.route),"},{"type":"DELETE","lineNumber":146,"oldContent":"              ),"},{"type":"DELETE","lineNumber":147,"oldContent":"            ),"},{"type":"DELETE","lineNumber":148,"oldContent":"            ),"},{"type":"DELETE","lineNumber":149,"oldContent":"          )"},{"type":"DELETE","lineNumber":150,"oldContent":"          ),"},{"type":"DELETE","lineNumber":151,"oldContent":"        ),"},{"type":"DELETE","lineNumber":152,"oldContent":"      ),"},{"type":"DELETE","lineNumber":153,"oldContent":"    );"},{"type":"DELETE","lineNumber":154,"oldContent":"  }"},{"type":"DELETE","lineNumber":155,"oldContent":""},{"type":"DELETE","lineNumber":156,"oldContent":"  // FAB / SpeedDial builder"},{"type":"DELETE","lineNumber":157,"oldContent":"  Widget _buildFab(ThemeData theme, double diameter, double iconSize) {"},{"type":"DELETE","lineNumber":158,"oldContent":"    final actions = <_ActionItem>["},{"type":"DELETE","lineNumber":159,"oldContent":"      _ActionItem(icon: LucideIcons.scan, label: 'Scan Barcode', route: '/scan'),"},{"type":"DELETE","lineNumber":160,"oldContent":"      _ActionItem(icon: Icons.inventory_2_outlined, label: 'New Stock Take', route: '/new-stock-take'),"},{"type":"DELETE","lineNumber":161,"oldContent":"      _ActionItem(icon: Icons.precision_manufacturing, label: 'New Production Run', route: '/new-production'),"},{"type":"DELETE","lineNumber":162,"oldContent":"}"},{"type":"DELETE","lineNumber":163,"oldContent":"      _ActionItem(icon: Icons.article_outlined, label: 'New Bill of Material', route: '/new-bom'),"},{"type":"DELETE","lineNumber":164,"oldContent":""},{"type":"DELETE","lineNumber":165,"oldContent":"      _ActionItem(icon: Icons.shopping_cart_outlined, label: 'New Customer Order', route: '/new-order'),"},{"type":"DELETE","lineNumber":166,"oldContent":"    ];"},{"type":"DELETE","lineNumber":167,"oldContent":""},{"type":"DELETE","lineNumber":168,"oldContent":"    Widget _buildLabel(BuildContext ctx, IconData icon, String label) {"},{"type":"DELETE","lineNumber":170,"oldContent":"      final t = Theme.of(ctx);"},{"type":"DELETE","lineNumber":171,"oldContent":"  _ActionItem({required this.icon, required this.label, required this.route});"},{"type":"DELETE","lineNumber":172,"oldContent":"      return ClipRRect("},{"type":"DELETE","lineNumber":173,"oldContent":"        borderRadius: BorderRadius.circular(12),"},{"type":"DELETE","lineNumber":174,"oldContent":"        child: BackdropFilter("},{"type":"DELETE","lineNumber":175,"oldContent":"          filter: ImageFilter.blur(sigmaX: 6, sigmaY: 6),"},{"type":"DELETE","lineNumber":176,"oldContent":"          child: Container("},{"type":"DELETE","lineNumber":177,"oldContent":"            padding: const EdgeInsets.symmetric(vertical: 8, horizontal: 12),"},{"type":"DELETE","lineNumber":178,"oldContent":"            color: t.colorScheme.surface.withOpacity(0.65),"},{"type":"DELETE","lineNumber":179,"oldContent":"            child: Row("},{"type":"DELETE","lineNumber":180,"oldContent":"              mainAxisSize: MainAxisSize.min,"},{"type":"DELETE","lineNumber":181,"oldContent":"              children: ["},{"type":"DELETE","lineNumber":182,"oldContent":"                Icon(icon, size: 16, color: t.colorScheme.onSurface.withOpacity(0.95)),"},{"type":"DELETE","lineNumber":183,"oldContent":"                const SizedBox(width: 10),"},{"type":"DELETE","lineNumber":184,"oldContent":"                Text(label, style: TextStyle(fontSize: 14, fontWeight: FontWeight.w600, color: t.colorScheme.onSurface)),"},{"type":"DELETE","lineNumber":185,"oldContent":"              ],"},{"type":"DELETE","lineNumber":186,"oldContent":"            ),"},{"type":"DELETE","lineNumber":187,"oldContent":"          ),"},{"type":"DELETE","lineNumber":188,"oldContent":"        ),"},{"type":"DELETE","lineNumber":189,"oldContent":"      );"},{"type":"DELETE","lineNumber":190,"oldContent":"    }"},{"type":"DELETE","lineNumber":191,"oldContent":""},{"type":"DELETE","lineNumber":192,"oldContent":"    final sdChildren = actions.map((a) {"},{"type":"DELETE","lineNumber":193,"oldContent":"      return SpeedDialChild("},{"type":"DELETE","lineNumber":194,"oldContent":"        child: const SizedBox.shrink(), // we only show labelWidget"},{"type":"DELETE","lineNumber":195,"oldContent":"        labelWidget: _buildLabel(context, a.icon, a.label),"},{"type":"DELETE","lineNumber":196,"oldContent":"        backgroundColor: Colors.transparent,"},{"type":"DELETE","lineNumber":197,"oldContent":"        labelBackgroundColor: Colors.transparent,"},{"type":"DELETE","lineNumber":198,"oldContent":"        onTap: () {"},{"type":"DELETE","lineNumber":199,"oldContent":"          _dialOpen.value = false;"},{"type":"DELETE","lineNumber":200,"oldContent":"          GoRouter.of(context).push(a.route);"},{"type":"DELETE","lineNumber":201,"oldContent":"        },"},{"type":"DELETE","lineNumber":202,"oldContent":"      );"},{"type":"DELETE","lineNumber":203,"oldContent":"    }).toList();"},{"type":"DELETE","lineNumber":204,"oldContent":""},{"type":"DELETE","lineNumber":205,"oldContent":"    final fabChild = Container("},{"type":"DELETE","lineNumber":206,"oldContent":"      width: diameter,"},{"type":"DELETE","lineNumber":207,"oldContent":"      height: diameter,"},{"type":"DELETE","lineNumber":208,"oldContent":"      decoration: BoxDecoration("},{"type":"DELETE","lineNumber":209,"oldContent":"        color: theme.colorScheme.primary,"},{"type":"DELETE","lineNumber":210,"oldContent":"        shape: BoxShape.circle,"},{"type":"DELETE","lineNumber":211,"oldContent":"        boxShadow: [BoxShadow(color: Colors.black.withOpacity(0.12), blurRadius: 8, offset: const Offset(0, 3))],"},{"type":"DELETE","lineNumber":212,"oldContent":"      ),"},{"type":"DELETE","lineNumber":213,"oldContent":"      child: Center(child: Icon(LucideIcons.plus, size: iconSize, color: Colors.white)),"},{"type":"DELETE","lineNumber":214,"oldContent":"    );"},{"type":"DELETE","lineNumber":215,"oldContent":""},{"type":"DELETE","lineNumber":216,"oldContent":"    final activeChild = Container("},{"type":"DELETE","lineNumber":217,"oldContent":"      width: diameter,"},{"type":"DELETE","lineNumber":218,"oldContent":"      height: diameter,"},{"type":"DELETE","lineNumber":219,"oldContent":"      decoration: BoxDecoration("},{"type":"DELETE","lineNumber":220,"oldContent":"        color: theme.colorScheme.primary,"},{"type":"DELETE","lineNumber":221,"oldContent":"        shape: BoxShape.circle,"},{"type":"DELETE","lineNumber":222,"oldContent":"      ),"},{"type":"DELETE","lineNumber":223,"oldContent":"      child: Center(child: Icon(Icons.close, size: iconSize, color: Colors.white)),"},{"type":"DELETE","lineNumber":224,"oldContent":"    );"},{"type":"DELETE","lineNumber":225,"oldContent":""},{"type":"DELETE","lineNumber":226,"oldContent":"    return SpeedDial("},{"type":"DELETE","lineNumber":227,"oldContent":"      icon: null,"},{"type":"DELETE","lineNumber":228,"oldContent":"      child: fabChild,"},{"type":"DELETE","lineNumber":229,"oldContent":"      activeChild: activeChild,"},{"type":"DELETE","lineNumber":230,"oldContent":"      openCloseDial: _dialOpen,"},{"type":"DELETE","lineNumber":231,"oldContent":"      onOpen: () => _dialOpen.value = true,"},{"type":"DELETE","lineNumber":232,"oldContent":"      onClose: () => _dialOpen.value = false,"},{"type":"DELETE","lineNumber":233,"oldContent":"      backgroundColor: Colors.transparent,"},{"type":"DELETE","lineNumber":234,"oldContent":"      foregroundColor: Colors.white,"},{"type":"DELETE","lineNumber":235,"oldContent":"      overlayOpacity: 0.0, // we manage our own overlay"},{"type":"DELETE","lineNumber":236,"oldContent":"      curve: Curves.easeInOut,"},{"type":"DELETE","lineNumber":237,"oldContent":"      elevation: 0,"},{"type":"DELETE","lineNumber":238,"oldContent":"      shape: const CircleBorder(),"},{"type":"DELETE","lineNumber":239,"oldContent":"      useRotationAnimation: true,"},{"type":"DELETE","lineNumber":240,"oldContent":"      animationDuration: const Duration(milliseconds: 240),"},{"type":"DELETE","lineNumber":241,"oldContent":"      children: sdChildren,"},{"type":"DELETE","lineNumber":242,"oldContent":"    );"},{"type":"DELETE","lineNumber":243,"oldContent":"  }"},{"type":"DELETE","lineNumber":244,"oldContent":""},{"type":"DELETE","lineNumber":245,"oldContent":"  Alignment _alignmentForIndex(int index, int total) {"},{"type":"DELETE","lineNumber":246,"oldContent":"    if (total <= 1) return Alignment.center;"},{"type":"DELETE","lineNumber":247,"oldContent":"    final frac = index / (total - 1);"},{"type":"DELETE","lineNumber":248,"oldContent":"    final ax = (frac * 2) - 1;"},{"type":"DELETE","lineNumber":249,"oldContent":"    return Alignment(ax, 0);"},{"type":"DELETE","lineNumber":250,"oldContent":"  }"},{"type":"DELETE","lineNumber":253,"oldContent":"// Reusable widgets and models"},{"type":"DELETE","lineNumber":254,"oldContent":""},{"type":"DELETE","lineNumber":255,"oldContent":"class _BottomNavItem extends StatelessWidget {"},{"type":"DELETE","lineNumber":256,"oldContent":"  final IconData icon;"},{"type":"DELETE","lineNumber":257,"oldContent":"  final String label;"},{"type":"DELETE","lineNumber":258,"oldContent":"  final bool selected;"},{"type":"DELETE","lineNumber":259,"oldContent":"  final Color activeColor;"},{"type":"DELETE","lineNumber":260,"oldContent":"  final Color inactiveColor;"},{"type":"DELETE","lineNumber":261,"oldContent":"  final VoidCallback onTap;"},{"type":"DELETE","lineNumber":262,"oldContent":"  final double iconSize;"},{"type":"DELETE","lineNumber":263,"oldContent":""},{"type":"DELETE","lineNumber":264,"oldContent":"  const _BottomNavItem({"},{"type":"DELETE","lineNumber":265,"oldContent":"    Key? key,"},{"type":"DELETE","lineNumber":266,"oldContent":"    required this.icon,"},{"type":"DELETE","lineNumber":267,"oldContent":"    required this.label,"},{"type":"DELETE","lineNumber":268,"oldContent":"    required this.selected,"},{"type":"DELETE","lineNumber":269,"oldContent":"    required this.activeColor,"},{"type":"DELETE","lineNumber":270,"oldContent":"    required this.inactiveColor,"},{"type":"DELETE","lineNumber":271,"oldContent":"    required this.onTap,"},{"type":"DELETE","lineNumber":272,"oldContent":"    required this.iconSize,"},{"type":"DELETE","lineNumber":273,"oldContent":"  }) : super(key: key);"},{"type":"DELETE","lineNumber":274,"oldContent":""},{"type":"DELETE","lineNumber":275,"oldContent":"  @override"},{"type":"DELETE","lineNumber":276,"oldContent":"  Widget build(BuildContext context) {"},{"type":"DELETE","lineNumber":277,"oldContent":"    return Expanded("},{"type":"DELETE","lineNumber":278,"oldContent":"      child: InkWell("},{"type":"DELETE","lineNumber":279,"oldContent":"        onTap: onTap,"},{"type":"DELETE","lineNumber":280,"oldContent":"        child: SizedBox("},{"type":"DELETE","lineNumber":281,"oldContent":"          height: double.infinity,"},{"type":"DELETE","lineNumber":282,"oldContent":"          child: Column("},{"type":"DELETE","lineNumber":283,"oldContent":"            mainAxisAlignment: MainAxisAlignment.center,"},{"type":"DELETE","lineNumber":284,"oldContent":"            children: ["},{"type":"DELETE","lineNumber":285,"oldContent":"              Icon(icon, size: iconSize, color: selected ? activeColor : inactiveColor),"},{"type":"DELETE","lineNumber":286,"oldContent":"              const SizedBox(height: 4),"},{"type":"DELETE","lineNumber":287,"oldContent":"              AnimatedDefaultTextStyle("},{"type":"DELETE","lineNumber":288,"oldContent":"                duration: const Duration(milliseconds: 200),"},{"type":"DELETE","lineNumber":289,"oldContent":"                style: TextStyle("},{"type":"DELETE","lineNumber":290,"oldContent":"                  fontSize: 11,"},{"type":"DELETE","lineNumber":291,"oldContent":"                  fontWeight: selected ? FontWeight.w700 : FontWeight.w600,"},{"type":"DELETE","lineNumber":292,"oldContent":"                  color: selected ? activeColor : inactiveColor,"},{"type":"DELETE","lineNumber":293,"oldContent":"                ),"},{"type":"DELETE","lineNumber":294,"oldContent":"                child: Text(label),"},{"type":"DELETE","lineNumber":295,"oldContent":"              ),"},{"type":"DELETE","lineNumber":296,"oldContent":"            ],"},{"type":"DELETE","lineNumber":297,"oldContent":"          ),"},{"type":"DELETE","lineNumber":298,"oldContent":"        ),"},{"type":"DELETE","lineNumber":299,"oldContent":"      ),"},{"type":"DELETE","lineNumber":300,"oldContent":"    );"},{"type":"DELETE","lineNumber":301,"oldContent":"  }"},{"type":"DELETE","lineNumber":302,"oldContent":"}"},{"type":"DELETE","lineNumber":303,"oldContent":""},{"type":"DELETE","lineNumber":304,"oldContent":"class _NavItem {"},{"type":"DELETE","lineNumber":305,"oldContent":"  final IconData icon;"},{"type":"DELETE","lineNumber":306,"oldContent":"  final String label;"},{"type":"DELETE","lineNumber":307,"oldContent":"  final String route;"},{"type":"DELETE","lineNumber":308,"oldContent":"  const _NavItem({required this.icon, required this.label, required this.route});"},{"type":"DELETE","lineNumber":309,"oldContent":"}"},{"type":"DELETE","lineNumber":310,"oldContent":""},{"type":"DELETE","lineNumber":311,"oldContent":"class _ActionItem {"},{"type":"DELETE","lineNumber":312,"oldContent":"  final IconData icon;"},{"type":"DELETE","lineNumber":313,"oldContent":"  final String label;"},{"type":"DELETE","lineNumber":314,"oldContent":"  final String route;"},{"type":"DELETE","lineNumber":315,"oldContent":"  const _ActionItem({required this.icon, required this.label, required this.route});"},{"type":"DELETE","lineNumber":316,"oldContent":"}"},{"type":"DELETE","lineNumber":317,"oldContent":""}]}]},"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/config/router/app_router.dart":{"filePath":"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/config/router/app_router.dart","baseContent":"import 'package:clean_arch_app/presentation/stocktake/stocktake_page.dart';\nimport 'package:flutter/material.dart';\nimport 'package:flutter_riverpod/flutter_riverpod.dart';\nimport 'package:go_router/go_router.dart';\nimport '../../di/injection.dart';\nimport '../../presentation/auth/login_page.dart';\nimport '../../presentation/common/widgets/main_scaffold.dart';\nimport '../../presentation/dashboard/dashboard_page.dart';\nimport '../../presentation/stock/stock_page.dart';\nimport '../../presentation/product_form/add_product_page.dart';\nimport '../../presentation/suppliers/supplier_page.dart';\nimport '../../presentation/users/user_management_page.dart';\nimport '../../presentation/settings/settings_page.dart';\nimport 'route_names.dart';\n\nfinal routerProvider = Provider<GoRouter>((ref) {\n  final authState = ref.watch(authViewModelProvider);\n\n  return GoRouter(\n    initialLocation: RouteNames.stock,\n    routes: [\n      ShellRoute(\n        builder: (context, state, child) => MainScaffold(),\n\n        routes: [\n          GoRoute(\n            path: RouteNames.login,\n            name: RouteNames.login,\n            builder: (context, state) => const LoginPage(),\n          ),\n          GoRoute(\n            path: RouteNames.dashboard,\n            name: RouteNames.dashboard,\n            builder: (context, state) =>\n                DashboardPage(),\n          ),\n          GoRoute(\n            path: RouteNames.stock,\n            name: RouteNames.stock,\n            builder: (context, state) => StockPage(),\n          ),\n          GoRoute(\n            path: RouteNames.stocktake,\n            name: RouteNames.stocktake,\n            builder: (context, state) => StockTakePage(),\n          ),\n          GoRoute(\n            path: RouteNames.addProduct,\n            name: RouteNames.addProduct,\n            builder: (context, state) => const AddProductPage(),\n          ),\n          GoRoute(\n            path: RouteNames.suppliers,\n            name: RouteNames.suppliers,\n            builder: (context, state) => SupplierPage(),\n          ),\n          GoRoute(\n            path: RouteNames.users,\n            name: RouteNames.users,\n            builder: (context, state) => UserManagementPage(),\n          ),\n          GoRoute(\n            path: RouteNames.settings,\n            name: RouteNames.settings,\n            builder: (context, state) => const SettingsPage(),\n          ),\n        ],\n      ),\n    ],\n    errorBuilder: (context, state) =>\n        Scaffold(body: Center(child: Text('Page not found: ${state.error}'))),\n  );\n});\n","baseTimestamp":1755128187419,"deltas":[{"timestamp":1755128193132,"changes":[{"type":"MODIFY","lineNumber":22,"content":"        builder: (context, state, child) => MainScaffold(child: child),","oldContent":"        builder: (context, state, child) => MainScaffold(),"}]}]},"/Dummy.txt":{"filePath":"/Dummy.txt","baseContent":"Update initial route to stock and reformat plugin registration files\n\nThe initial route in `app_router.dart` has been changed from `dashboard` to `stock`.\n\nAdditionally, the following files related to plugin registration for Linux and Windows have been reformatted for improved readability:\n- `windows/flutter/generated_plugin_registrant.cc`\n- `windows/flutter/generated_plugins.cmake`\n- `linux/flutter/generated_plugin_registrant.cc`\n- `windows/flutter/generated_plugin_registrant.h`\n- `linux/flutter/generated_plugins.cmake`\n- `linux/flutter/generated_plugin_registrant.h`\n\nThe `devtools_options.yaml` file has been updated to include `provider: true` under extensions.","baseTimestamp":1755129192267},"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/di/injection.dart":{"filePath":"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/di/injection.dart","baseContent":"import 'package:clean_arch_app/data/datasources/remote/notification_api.dart';\nimport 'package:clean_arch_app/data/repositories_impl/notification_repository_impl.dart';\nimport 'package:clean_arch_app/domain/repositories/notification_repository.dart';\nimport 'package:clean_arch_app/domain/usecases/general/notification/notification_usecases.dart';\nimport 'package:clean_arch_app/presentation/auth/auth_state.dart';\nimport 'package:clean_arch_app/presentation/auth/auth_view_model.dart';\nimport 'package:clean_arch_app/presentation/notification/notification_state.dart';\nimport 'package:clean_arch_app/presentation/notification/notification_view_model.dart';\nimport 'package:flutter_riverpod/flutter_riverpod.dart';\nimport 'package:dio/dio.dart';\n\nimport '../core/network/api_client.dart';\n\n// Data Sources\nimport '../data/datasources/remote/auth_api.dart';\nimport '../data/datasources/remote/user_api.dart';\nimport '../data/datasources/remote/stock_api.dart';\n\n// Repositories (Interfaces)\nimport '../domain/repositories/auth_repository.dart';\nimport '../domain/repositories/user_repository.dart';\nimport '../domain/repositories/stock_repository.dart';\nimport '../domain/repositories/stock_take_repository.dart';\n\n// Repository Implementations\nimport '../data/repositories_impl/auth_repository_impl.dart';\nimport '../data/repositories_impl/user_repository_impl.dart';\nimport '../data/repositories_impl/stock_repository_impl.dart';\n\n// ViewModels\nimport '../domain/usecases/stock/add_stock_usecase.dart';\nimport '../domain/usecases/stock/adjust_stock_usecase.dart';\nimport '../domain/usecases/stock/delete_multiple_stocks_usecase.dart';\nimport '../domain/usecases/stock/delete_stock_usecase.dart';\nimport '../domain/usecases/stock/filter_stocks_usecase.dart';\nimport '../domain/usecases/stock/get_all_stocks_usecase.dart';\nimport '../domain/usecases/stock/get_stock_by_id_usecase.dart';\nimport '../domain/usecases/stock/search_stocks_usecase.dart';\nimport '../domain/usecases/stock/sort_stocks_usecase.dart';\nimport '../domain/usecases/stock/toggle_stock_selection_usecase.dart';\nimport '../domain/usecases/stock/update_multiple_stock_status.dart';\nimport '../domain/usecases/stock/update_stock_status_usecase.dart';\nimport '../domain/usecases/stock/update_stock_usecase.dart';\nimport '../domain/usecases/stock/stock_usecases.dart';\nimport '../presentation/dashboard/dashboard_state.dart';\nimport '../presentation/dashboard/dashboard_view_model.dart';\nimport '../presentation/stock/stock_state.dart';\nimport '../presentation/stock/stock_view_model.dart';\nimport '../presentation/suppliers/supplier_view_model.dart';\nimport '../presentation/auth/login_view_model.dart';\nimport '../presentation/stocktake/stocktake_view_model.dart';\nimport '../domain/usecases/login_user.dart';\n\n// \n// NETWORK PROVIDERS\n// \n\nfinal dioProvider = Provider<Dio>((ref) => ApiClient().dio);\n\nfinal apiClientProvider = Provider<ApiClient>((ref) {\n  final dio = ref.watch(dioProvider);\n  return ApiClient(dio: dio);\n});\n\n// \n// DATA SOURCE PROVIDERS\n// \n\nfinal authApiProvider = Provider<AuthApiImpl>((ref) {\n  final apiClient = ref.watch(apiClientProvider);\n  return AuthApiImpl(apiClient);\n});\n\nfinal userApiProvider = Provider<UserApi>((ref) {\n  final dio = ref.watch(dioProvider);\n  return UserApi(dio);\n});\n\nfinal stockRemoteDataSourceProvider = Provider<StockApi>((ref) {\n  final dio = ref.watch(dioProvider);\n  return StockApi(dio);\n});\n// Provide the generated Retrofit API\nfinal notificationApiProvider = Provider<NotificationApi>((ref) {\n  final dio = ref.read(dioProvider);\n  return NotificationApi(dio, baseUrl: dio.options.baseUrl);\n});\n\n// Provide the concrete repository implementation\nfinal notificationRepositoryProvider = Provider<NotificationRepository>((ref) {\n  final api = ref.read(notificationApiProvider);\n  return NotificationRepositoryImpl(api);\n});\n\n// ---------- usecases provider ----------\nfinal notificationUseCasesProvider = Provider<NotificationUseCases>((ref) {\n  final repo = ref.read(notificationRepositoryProvider);\n  return NotificationUseCases.fromRepository(repo);\n});\n\n\n// \n// REPOSITORY PROVIDERS\n// \n\nfinal authRepositoryProvider = Provider<AuthRepository>((ref) {\n  final api = ref.watch(authApiProvider);\n  return AuthRepositoryImpl(api);\n});\n\nfinal userRepositoryProvider = Provider<UserRepository>((ref) {\n  final api = ref.watch(userApiProvider);\n  return UserRepositoryImpl(api);\n});\n\nfinal stockRepositoryProvider = Provider<StockRepository>((ref) {\n  final remoteSource = ref.watch(stockRemoteDataSourceProvider);\n  return StockRepositoryImpl(remoteSource);\n});\n\n// \n// VIEWMODEL PROVIDERS\n// \n\nfinal dashboardViewModelProvider =\n    StateNotifierProvider<DashboardViewModel, DashboardState>(\n      (ref) => DashboardViewModel(),\n    );\n//\n// final stockViewModelProvider =\n//     StateNotifierProvider.autoDispose<StockViewModel, StockState>((ref) {\n//       final stockRepo = ref.watch(stockRepositoryProvider);\n//       final authRepo = ref.watch(authRepositoryProvider);\n//       return StockViewModel(\n//         stockRepository: stockRepo,\n//         authRepository: authRepo,\n//       );\n//     });\n\nfinal notificationViewModelProvider =\nStateNotifierProvider<NotificationViewModel, NotificationState>((ref) {\n  final usecases = ref.read(notificationUseCasesProvider);\n  return NotificationViewModel(notificationUseCases: usecases);\n});\n\nfinal stockUsecasesProvider = Provider((ref) {\n  final stockRepo = ref.watch(stockRepositoryProvider);\n  return StockUseCases(\n    addStock: AddStockUseCase(stockRepo),\n    adjustStock: AdjustStockUseCase(stockRepo),\n    deleteMultipleStocks: DeleteMultipleStocksUseCase(stockRepo),\n    deleteStock: DeleteStockUseCase(stockRepo),\n    filterStocks: FilterStocksUseCase(),\n    getAllStocks: GetAllStocksUseCase(stockRepo),\n    getStockById: GetStockByIdUseCase(stockRepo),\n    searchStocks: SearchStocksUseCase(),\n    sortStocks: SortStocksUseCase(),\n    toggleStockSelection: ToggleStockSelectionUseCase(),\n    updateMultipleStockStatus:\n        UpdateMultipleStockStatusUseCase(stockRepo),\n    updateStockStatus: UpdateStockStatusUseCase(stockRepo),\n    updateStock: UpdateStockUseCase(stockRepo),\n  );\n});\nfinal stockViewModelProvider =\nStateNotifierProvider.autoDispose<StockViewModel, StockState>((ref) {\n  final stockUseCases =ref.watch(stockUsecasesProvider);\n  final authRepo = ref.watch(authRepositoryProvider);\n  return StockViewModel(\n    stockUseCases: stockUseCases,\n    authRepository: authRepo,\n  );\n});\n\nfinal supplierViewModelProvider = Provider<SupplierViewModel>((ref) {\n  return SupplierViewModel();\n});\n\nfinal loginViewModelProvider =\n    StateNotifierProvider<LoginViewModel, LoginState>((ref) {\n      final loginUseCase = LoginUser(ref.watch(authRepositoryProvider));\n      return LoginViewModel(loginUseCase);\n    });\n\nfinal authViewModelProvider =\nStateNotifierProvider<AuthViewModel, AuthState>((ref) {\n  return AuthViewModel(ref.read(authRepositoryProvider));\n});\n\n\n// Mock stock take repository for now\nfinal stockTakeRepositoryProvider = Provider<StockTakeRepository>((ref) {\n  throw UnimplementedError('StockTakeRepository implementation needed');\n});\n\n\n// Provider definition\nfinal stockTakeViewModelProvider =\nStateNotifierProvider<StockTakeViewModel, StockTakeState>((ref) {\n  final repository = ref.watch(stockTakeRepositoryProvider);\n  return StockTakeViewModel(repository);\n});\n\n","baseTimestamp":1755130396733},"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/presentation/stock/stock_page.dart":{"filePath":"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/presentation/stock/stock_page.dart","baseContent":"import 'package:clean_arch_app/core/enums/stock_status.dart';\nimport 'package:clean_arch_app/di/injection.dart'; // should export stockViewModelProvider\nimport 'package:clean_arch_app/domain/entities/stock/stock.dart';\nimport 'package:clean_arch_app/presentation/stock/stock_view_model.dart';\nimport 'package:clean_arch_app/presentation/stock/widgets/app_bar.dart';\nimport 'package:clean_arch_app/presentation/stock/widgets/search_control_bar.dart';\nimport 'package:flutter/material.dart';\nimport 'package:flutter_riverpod/flutter_riverpod.dart';\n\nclass StockPage extends ConsumerWidget {\n  const StockPage({super.key});\n\n  @override\n  Widget build(BuildContext context, WidgetRef ref) {\n    final vm = ref.read(stockViewModelProvider.notifier);\n    final state = ref.watch(stockViewModelProvider);\n\n    final List<Stock> stocks = state.filteredStocks;\n    final isLoading = state.isLoading;\n    final selectable = state.isBulkSelectionMode; // show checkboxes by default (change to state flag if you add one)\n    final selectedIds = state.selectedStockIds;\n    final allSelected = state.allSelected;\n\n    return Scaffold(\n      backgroundColor: const Color(0xFFF7F8FA),\n  appBar: ProductionTopAppBar(),\n      body: SafeArea(\n        child: Column(\n          children: [\n            // buildTopAppBar(context, vm),\n            // _buildTopBar(context, vm),\n            Padding(\n              padding: const EdgeInsets.fromLTRB(18, 12, 18, 6), // tightened\n              child: _buildTitleAndCount(stocks.length),\n            ),\n            Padding(\n              padding: const EdgeInsets.symmetric(horizontal: 18.0),\n              child: SearchControlBar(),\n              // _buildSearchFilterRow(vm, state),\n            ),\n            const SizedBox(height: 10),\n            Expanded(\n              child: Padding(\n                padding: const EdgeInsets.symmetric(horizontal: 18.0),\n                child: isLoading\n                    ? _buildLoading()\n                    : stocks.isEmpty\n                    ? _buildEmpty()\n                    : _buildListView(stocks, selectable, selectedIds, allSelected, vm, ref),\n              ),\n            ),\n          ],\n        ),\n      ),\n    );\n  }\n  Widget buildTopAppBar(BuildContext context, StockViewModel stockVm) {\n    return PreferredSize(\n      preferredSize: const Size.fromHeight(72.0),\n      child: AppBar(\n        backgroundColor: const Color(0xFF0E2330),\n        elevation: 0,\n        toolbarHeight: 72,\n        titleSpacing: 18,\n        automaticallyImplyLeading: false, // keep no back button if not needed\n        title: Column(\n          crossAxisAlignment: CrossAxisAlignment.start,\n          mainAxisAlignment: MainAxisAlignment.center,\n          children: const [\n            Text(\n              'StockTrack-Pro',\n              style: TextStyle(\n                color: Colors.white,\n                fontSize: 20,\n                fontWeight: FontWeight.w800,\n                letterSpacing: 0.1,\n              ),\n            ),\n            SizedBox(height: 2),\n            Text(\n              'Professional Inventory Management',\n              style: TextStyle(color: Colors.white70, fontSize: 12),\n            ),\n          ],\n        ),\n        actions: [\n          IconButton(\n            onPressed: () => stockVm.refresh(),\n            icon: const Icon(Icons.refresh),\n            color: Colors.white70,\n            tooltip: 'Refresh',\n            visualDensity: VisualDensity.compact,\n          ),\n          IconButton(\n            onPressed: () {},\n            icon: const Icon(Icons.notifications_none),\n            color: Colors.white70,\n            tooltip: 'Notifications',\n            visualDensity: VisualDensity.compact,\n          ),\n          const SizedBox(width: 6),\n          Padding(\n            padding: const EdgeInsets.only(right: 14.0),\n            child: CircleAvatar(\n              radius: 18,\n              backgroundColor: Colors.white,\n              child: const Icon(Icons.person, color: Color(0xFF0E2330)),\n            ),\n          ),\n        ],\n      ),\n    );\n  }\n  Widget _buildTitleAndCount(int total) {\n    return Row(\n      children: [\n        const Text('Stock Inventory',\n            style: TextStyle(fontSize: 20, fontWeight: FontWeight.w800, color: Color(0xFF0B2130))),\n        const Spacer(),\n        Text('$total items', style: TextStyle(color: Colors.grey.shade600, fontWeight: FontWeight.w600)),\n      ],\n    );\n  }\n\n  Widget _buildSearchFilterRow(StockViewModel vm, dynamic state) {\n    return Row(\n      children: [\n        Expanded(\n          child: Container(\n            height: 40, // slightly smaller\n            decoration: BoxDecoration(\n              color: Colors.white,\n              border: Border.all(color: const Color(0xFFE6E9EE)),\n              borderRadius: BorderRadius.circular(8),\n            ),\n            padding: const EdgeInsets.symmetric(horizontal: 10),\n            child: Row(\n              children: [\n                const Icon(Icons.search, color: Color(0xFF9AA6B2), size: 18),\n                const SizedBox(width: 8),\n                Expanded(\n                  child: TextField(\n                    onChanged: vm.updateSearch,\n                    decoration: const InputDecoration.collapsed(\n                      hintText: 'Search inventory...',\n                      hintStyle: TextStyle(color: Color(0xFF9AA6B2)),\n                    ),\n                    style: const TextStyle(fontSize: 14),\n                    textInputAction: TextInputAction.search,\n                  ),\n                ),\n              ],\n            ),\n          ),\n        ),\n        const SizedBox(width: 10),\n        _smallActionButton(icon: Icons.filter_list, tooltip: 'Filter', onTap: () {\n          final current = state.filterStatus;\n          vm.setFilterStatus(current == StockStatus.inStock ? null : StockStatus.inStock);\n        }),\n        const SizedBox(width: 8),\n        _smallActionButton(icon: Icons.swap_vert, tooltip: 'Sort', onTap: vm.toggleSort),\n      ],\n    );\n  }\n\n  Widget _smallActionButton({required IconData icon, String? tooltip, VoidCallback? onTap}) {\n    return Material(\n      color: Colors.white,\n      shape: RoundedRectangleBorder(side: BorderSide(color: const Color(0xFFE6E9EE)), borderRadius: BorderRadius.circular(8)),\n      child: InkWell(\n        onTap: onTap,\n        borderRadius: BorderRadius.circular(8),\n        child: SizedBox(width: 40, height: 40, child: Center(child: Icon(icon, color: const Color(0xFF374151), size: 18))),\n      ),\n    );\n  }\n\n  Widget _buildListView(List<Stock> stocks, bool selectable, Set<String> selectedIds, bool allSelected, StockViewModel vm, WidgetRef ref) {\n    return Container(\n      decoration: BoxDecoration(\n        color: Colors.white,\n        borderRadius: BorderRadius.circular(10),\n        border: Border.all(color: const Color(0xFFE7EDF3)),\n      ),\n      child: Column(\n        children: [\n          // Header row inside the white card\n          Container(\n            height: 48, // tightened from 56\n            padding: const EdgeInsets.symmetric(horizontal: 8),\n            decoration: BoxDecoration(\n              border: Border(bottom: BorderSide(color: Colors.grey.shade100)),\n              color: Colors.white,\n            ),\n            child: Row(\n              children: [\n                if (selectable)\n                  SizedBox(\n                    width: 44,\n                    child: Checkbox(\n                      value: allSelected ? true : (selectedIds.isEmpty ? false : null),\n                      tristate: true,\n                      onChanged: (v) {\n                        if (v == true) vm.selectAllAll();\n                        else vm.clearSelection();\n                      },\n                      visualDensity: VisualDensity.compact,\n                      materialTapTargetSize: MaterialTapTargetSize.shrinkWrap,\n                    ),\n                  ),\n                Expanded(flex: 4, child: Padding(\n                  padding: const EdgeInsets.only(left: 6.0),\n                  child: Text('ITEM DETAILS', style: TextStyle(fontSize: 12, color: Colors.grey.shade600, fontWeight: FontWeight.w700)),\n                )),\n                Expanded(flex: 2, child: Text('STOCK', textAlign: TextAlign.center, style: TextStyle(fontSize: 12, color: Colors.grey.shade600, fontWeight: FontWeight.w700))),\n                Expanded(flex: 2, child: Text('STATUS', textAlign: TextAlign.center, style: TextStyle(fontSize: 12, color: Colors.grey.shade600, fontWeight: FontWeight.w700))),\n                Expanded(flex:2,child: SizedBox(width: 96, child: Center(child: Text('ACTIONS', style: TextStyle(fontSize: 12, color: Colors.grey.shade600, fontWeight: FontWeight.w700))))),\n              ],\n            ),\n          ),\n\n          // List rows\n          Expanded(\n            child: ListView.separated(\n              itemCount: stocks.length,\n              separatorBuilder: (_, __) => Divider(height: 1, color: Colors.grey.shade100),\n              itemBuilder: (context, index) {\n                final s = stocks[index];\n                final isSelected = selectedIds.contains(s.id);\n                return _stockRow(s, index, isSelected, selectable, vm, ref);\n              },\n            ),\n          ),\n        ],\n      ),\n    );\n  }\n\n  Widget _stockRow(Stock stock, int index, bool isSelected, bool selectable, StockViewModel vm, WidgetRef ref) {\n    final isEven = index % 2 == 0;\n    final bg = isSelected ? const Color(0xFFF1F9FF) : (isEven ? Colors.white : const Color(0xFFF9FBFD));\n\n    return AnimatedContainer(\n      duration: const Duration(milliseconds: 140),\n      padding: const EdgeInsets.symmetric(horizontal: 8, vertical: 10), // tightened\n      color: bg,\n      child: Row(\n        children: [\n          if (selectable)\n            SizedBox(\n              width: 44,\n              child: Checkbox(\n                value: isSelected,\n                onChanged: (_) => vm.toggleStockSelection(stock.id),\n                materialTapTargetSize: MaterialTapTargetSize.shrinkWrap,\n                visualDensity: VisualDensity.compact,\n              ),\n            ),\n          Expanded(flex: 4, child: _itemDetailsCol(stock)),\n          Expanded(flex: 2, child: _stockCol(stock)),\n          Expanded(flex: 2, child: Center(child: _statusPill(stock.status))),\n          Expanded(\n            flex: 2,\n            child: SizedBox(\n              width: 96, // narrower\n              child: Row(\n                mainAxisAlignment: MainAxisAlignment.center,\n                children: [\n                  // Single overflow dropdown with View & Delete\n                  PopupMenuButton<_Action>(\n                    tooltip: 'Actions',\n                    onSelected: (action) async {\n                      switch (action) {\n                        case _Action.view:\n                        // adapt to your VM API\n                            showViewStock(ref.context, stock);\n                          break;\n                        case _Action.delete:\n                          final confirmed = await _confirmDelete(ref.context, stock);\n                          if (confirmed) vm.deleteStock(stock.id);\n                          break;\n                      }\n                    },\n                    itemBuilder: (_) => [\n                      const PopupMenuItem(value: _Action.view, child: ListTile(leading: Icon(Icons.remove_red_eye_outlined), title: Text('View'))),\n                      const PopupMenuItem(value: _Action.delete, child: ListTile(leading: Icon(Icons.delete_outline), title: Text('Delete'))),\n                    ],\n                    icon: const Icon(Icons.more_vert, size: 20, color: Color(0xFF374151)),\n                    padding: EdgeInsets.zero,\n                    offset: const Offset(0, 36),\n                  ),\n                ],\n              ),\n            ),\n          )\n        ],\n      ),\n    );\n  }\n  Future<void> showViewStock(BuildContext context, Stock stock) async {\n    await showDialog<void>(\n      context: context,\n      builder: (ctx) => AlertDialog(\n        title: Text(stock.name),\n        content: Column(\n          mainAxisSize: MainAxisSize.min,\n          crossAxisAlignment: CrossAxisAlignment.start,\n          children: [\n            Text('Quantity: ${stock.quantity}'),\n            Text('Status: ${stock.status.name}'),\n            if (stock.description != null) ...[\n              const SizedBox(height: 8),\n              Text(stock.description!),\n            ],\n          ],\n        ),\n        actions: [\n          TextButton(\n            onPressed: () => Navigator.of(ctx).pop(),\n            child: const Text('Close'),\n          ),\n          ElevatedButton.icon(\n            icon: const Icon(Icons.edit),\n            label: const Text('Edit'),\n            onPressed: () {\n              Navigator.of(ctx).pop(); // close view dialog first\n              _showEditStock(context, stock); // open edit screen/dialog\n            },\n          ),\n        ],\n      ),\n    );\n  }\n  /// Example edit function  replace with your real navigation/edit form\n  void _showEditStock(BuildContext context, Stock stock) {\n    showDialog<void>(\n      context: context,\n      builder: (ctx) => AlertDialog(\n        title: const Text('Edit Stock'),\n        content: Text('Here you would show your edit form for \"${stock.name}\".'),\n        actions: [\n          TextButton(\n            onPressed: () => Navigator.of(ctx).pop(),\n            child: const Text('Cancel'),\n          ),\n          ElevatedButton(\n            onPressed: () {\n              // TODO: save changes via ViewModel.updateStock(...)\n              Navigator.of(ctx).pop();\n            },\n            child: const Text('Save'),\n          ),\n        ],\n      ),\n    );\n  }\n\n  Future<bool> _confirmDelete(BuildContext context, Stock stock) async {\n    final res = await showDialog<bool>(\n      context: context,\n      builder: (ctx) => AlertDialog(\n        title: const Text('Delete item'),\n        content: Text('Are you sure you want to delete \"${stock.name}\"? This action cannot be undone.'),\n        actions: [\n          TextButton(onPressed: () => Navigator.of(ctx).pop(false), child: const Text('Cancel')),\n          ElevatedButton(onPressed: () => Navigator.of(ctx).pop(true), child: const Text('Delete')),\n        ],\n      ),\n    );\n    return res == true;\n  }\n\n  Widget _itemDetailsCol(Stock s) {\n    return Column(crossAxisAlignment: CrossAxisAlignment.center, children: [\n      Text(\n        s.name ?? '-',\n        style: const TextStyle(fontSize: 15, fontWeight: FontWeight.w800, color: Color(0xFF0B2130)),\n        maxLines: 2,\n        overflow: TextOverflow.ellipsis,\n      ),\n      const SizedBox(height: 4), // tightened\n      Row(\n        children: [\n          Text('SKU :', style: TextStyle(color: Colors.grey.shade600, fontSize: 12, fontWeight: FontWeight.w600)),\n          const SizedBox(width: 6),\n          Text(s.sku ?? '-', style: TextStyle(color: Colors.grey.shade700, fontSize: 12 ,overflow: TextOverflow.ellipsis)),\n        ],\n      ),\n      const SizedBox(height: 6),\n      Row(children: [\n        Text(s.categoryId?.toString() ?? '-', style: TextStyle(color: Colors.grey.shade600, fontSize: 12)),\n        const SizedBox(width: 12),\n        const Icon(Icons.location_on_outlined, size: 14, color: Colors.grey),\n        const SizedBox(width: 4),\n        Flexible(child: Text(s.location?.toString() ?? '-', overflow: TextOverflow.ellipsis, style: TextStyle(color: Colors.grey.shade600, fontSize: 12))),\n      ]),\n    ]);\n  }\n\n  Widget _stockCol(Stock s) {\n    final qty = s.quantity ?? 0;\n    final min = s.minimumStock ?? 0;\n    final progress = _calcProgress(qty, min);\n    return Column(\n      crossAxisAlignment: CrossAxisAlignment.center,\n      children: [\n        Text('$qty', style: const TextStyle(fontSize: 20, fontWeight: FontWeight.w900, color: Color(0xFF0B2130))),\n        const SizedBox(height: 4),\n        Text('Min: $min', style: TextStyle(color: Colors.grey.shade600, fontSize: 11)),\n        const SizedBox(height: 6),\n        Container(\n          width: 72,\n          height: 6,\n          decoration: BoxDecoration(borderRadius: BorderRadius.circular(6), color: const Color(0xFFF0F4F8)),\n          child: ClipRRect(\n            borderRadius: BorderRadius.circular(6),\n            child: LinearProgressIndicator(\n              value: progress,\n              backgroundColor: Colors.transparent,\n              valueColor: AlwaysStoppedAnimation(_stockColor(qty, min)),\n            ),\n          ),\n        ),\n      ],\n    );\n  }\n\n  double _calcProgress(int qty, int min) {\n    if (min <= 0) return 1.0;\n    final v = (qty / (min * 2));\n    return v.clamp(0.0, 1.0);\n  }\n\n  Color _stockColor(int qty, int min) {\n    if (min <= 0) return const Color(0xFF10B981);\n    final ratio = qty / min;\n    if (ratio <= 0.5) return const Color(0xFFEF4444);\n    if (ratio <= 1.0) return const Color(0xFFF59E0B);\n    return const Color(0xFF10B981);\n  }\n\n  Widget _statusPill(dynamic status) {\n    StockStatus s;\n    if (status is StockStatus) s = status;\n    else if (status is String) s = _parseStatus(status);\n    else s = StockStatus.inStock;\n\n    final style = _statusStyle(s);\n    return Container(\n      padding: const EdgeInsets.symmetric(horizontal: 10, vertical: 6), // slightly narrower\n      decoration: BoxDecoration(color: style['bg'] as Color, borderRadius: BorderRadius.circular(18)),\n      child: Text(style['label'] as String, style: TextStyle(color: style['fg'] as Color, fontWeight: FontWeight.w800, fontSize: 11)),\n    );\n  }\n\n  StockStatus _parseStatus(String raw) {\n    final r = raw.toLowerCase();\n    if (r.contains('good')) return StockStatus.inStock;\n    if (r.contains('low')) return StockStatus.lowStock;\n    if (r.contains('out')) return StockStatus.outOfStock;\n    return StockStatus.inStock;\n  }\n\n  Map<String, Object> _statusStyle(StockStatus s) {\n    switch (s) {\n      case StockStatus.lowStock:\n        return {'label': 'LOW', 'bg': const Color(0xFFFEF3C7), 'fg': const Color(0xFF92400E)};\n      case StockStatus.outOfStock:\n        return {'label': 'OUT', 'bg': const Color(0xFFF3F4F6), 'fg': const Color(0xFF374151)};\n      case StockStatus.inStock:\n      default:\n        return {'label': 'AVAILABLE', 'bg': const Color(0xFFEFFAF6), 'fg': const Color(0xFF065F46)};\n    }\n  }\n\n  Widget _buildLoading() => const Center(child: CircularProgressIndicator());\n  Widget _buildEmpty() => Center(child: Column(mainAxisAlignment: MainAxisAlignment.center, children: [\n    Icon(Icons.inventory_2_outlined, size: 48, color: Colors.grey.shade400),\n    const SizedBox(height: 12),\n    Text('No inventory items found', style: TextStyle(fontSize: 16, color: Colors.grey.shade700, fontWeight: FontWeight.w700)),\n    const SizedBox(height: 6),\n    Text('Add items to your inventory to get started', style: TextStyle(color: Colors.grey.shade500)),\n  ]));\n}\n\n// small enum for local action mapping\nenum _Action { view, delete }\n","baseTimestamp":1755130396748},"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/presentation/stock/stock_state.dart":{"filePath":"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/presentation/stock/stock_state.dart","baseContent":"// stock_state.dart\nimport 'package:clean_arch_app/domain/entities/auth/user.dart';\nimport 'package:clean_arch_app/domain/entities/stock/stock.dart';\nimport 'package:clean_arch_app/core/enums/stock_status.dart';\n\nenum SortBy { nameAsc, nameDesc, quantityAsc, quantityDesc, lastUpdated }\n\nextension SortByLabel on SortBy {\n  String get label {\n    switch (this) {\n      case SortBy.nameAsc:\n        return 'Name (AZ)';\n      case SortBy.nameDesc:\n        return 'Name (ZA)';\n      case SortBy.quantityAsc:\n        return 'Quantity (Low  High)';\n      case SortBy.quantityDesc:\n        return 'Quantity (High  Low)';\n      case SortBy.lastUpdated:\n        return 'Last updated';\n    }\n  }\n\n  /// Flexible parser: accepts \"name\", \"quantity\", \"lastUpdated\" or explicit enum strings.\n  static SortBy fromString(String value) {\n    final v = value.trim().toLowerCase();\n    switch (v) {\n      case 'name':\n      case 'name_asc':\n      case 'name (az)':\n      case 'name (a-z)':\n        return SortBy.nameAsc;\n      case 'name_desc':\n      case 'name (za)':\n      case 'name (z-a)':\n        return SortBy.nameDesc;\n      case 'quantity':\n      case 'quantity_asc':\n        return SortBy.quantityAsc;\n      case 'quantity_desc':\n        return SortBy.quantityDesc;\n      case 'last_updated':\n      case 'last updated':\n        return SortBy.lastUpdated;\n      default:\n      // default fallback\n        return SortBy.nameAsc;\n    }\n  }\n}\n\nenum SortOrder { ascending, descending }\n\nenum StockStateStatus { initial, loading, success, error }\n\nclass StockState {\n  final List<Stock> stocks; // canonical full list from repo\n  final User? currentUser;\n\n  final bool isLoading;\n  final bool isBulkSelectionMode;\n  final StockStateStatus status;\n  final Set<String> selectedStockIds;\n  final String searchQuery;\n  final StockStatus? filterStatus;\n  final SortBy sortBy;\n  final SortOrder sortOrder;\n\n  final List<SortBy> sortOptions; // Available fields to sort by\n  final String? errorMessage;\n\n  const StockState({\n    this.stocks = const [],\n    this.currentUser,\n    this.status = StockStateStatus.initial,\n    this.selectedStockIds = const {},\n    this.searchQuery = '',\n    this.filterStatus,\n    this.sortBy = SortBy.nameAsc,\n    this.sortOrder = SortOrder.ascending,\n    this.sortOptions = const [\n      SortBy.nameAsc,\n      SortBy.nameDesc,\n      SortBy.quantityAsc,\n      SortBy.quantityDesc\n    ],\n    this.errorMessage,\n    this.isLoading = false,\n    this.isBulkSelectionMode = false,\n  });\n\n  /// Default initial state\n  factory StockState.initial() => const StockState();\n  static const _noChange = Object();\n\n  StockState copyWith({\n    List<Stock>? stocks,\n    User? currentUser,\n    StockStateStatus? status,\n    Set<String>? selectedStockIds,\n    String? searchQuery,\n    Object? filterStatus = _noChange,\n    SortBy? sortBy,\n    SortOrder? sortOrder,\n    List<SortBy>? sortOptions,\n    String? errorMessage,\n    bool? isLoading,\n    bool? isBulkSelectionMode,\n  }) {\n    return StockState(\n      stocks: stocks ?? this.stocks,\n      // allow setting currentUser to null by explicitly passing non-null ? (keeps existing if parameter omitted)\n      currentUser: currentUser ?? this.currentUser,\n      status: status ?? this.status,\n      selectedStockIds: selectedStockIds ?? this.selectedStockIds,\n      searchQuery: searchQuery ?? this.searchQuery,\n      filterStatus: filterStatus == _noChange\n          ? this.filterStatus\n          : filterStatus as StockStatus?,\n      sortBy: sortBy ?? this.sortBy,\n      sortOrder: sortOrder ?? this.sortOrder,\n      sortOptions: sortOptions ?? this.sortOptions,\n      errorMessage: errorMessage ?? this.errorMessage,\n      isLoading: isLoading ?? this.isLoading,\n      isBulkSelectionMode: isBulkSelectionMode ?? this.isBulkSelectionMode,\n    );\n  }\n\n  // ---------- Convenience helpers ----------\n  bool get hasSelection => selectedStockIds.isNotEmpty;\n  int get selectedCount => selectedStockIds.length;\n  bool get allSelected => stocks.isNotEmpty && selectedStockIds.length == stocks.length;\n\n  // ---------- Computed / Derived data ----------\n  /// Returns the list filtered by searchQuery and filterStatus and sorted.\n  List<Stock> get filteredStocks {\n    var list = List<Stock>.from(stocks);\n\n    final q = (searchQuery).trim().toLowerCase();\n    if (q.isNotEmpty) {\n      list = list.where((s) {\n        final name = (s.name ?? '').toLowerCase();\n        final sku = (s.sku ?? '').toLowerCase();\n        final cat = (s.categoryId?.toString() ?? '').toLowerCase();\n        return name.contains(q) || sku.contains(q) || cat.contains(q);\n      }).toList();\n    }\n\n    if (filterStatus != null) {\n      list = list.where((s) => s.status == filterStatus).toList();\n    }\n\n    // Sorting\n    list.sort((a, b) {\n      int cmp = 0;\n      switch (sortBy) {\n        case SortBy.nameAsc:\n        case SortBy.nameDesc:\n          cmp = (a.name ?? '').toLowerCase().compareTo((b.name ?? '').toLowerCase());\n          if (sortBy == SortBy.nameDesc) cmp = -cmp;\n          break;\n\n        case SortBy.quantityAsc:\n        case SortBy.quantityDesc:\n        // Stock.quantity in your domain model is non-nullable int; but guard anyway\n          final aq = a.quantity;\n          final bq = b.quantity;\n          cmp = aq.compareTo(bq);\n          if (sortBy == SortBy.quantityDesc) cmp = -cmp;\n          break;\n\n        case SortBy.lastUpdated:\n        // sort by updatedAt (newest first); respect sortOrder for direction\n          final ad = a.updatedAt?.millisecondsSinceEpoch ?? 0;\n          final bd = b.updatedAt?.millisecondsSinceEpoch ?? 0;\n          cmp = ad.compareTo(bd);\n          break;\n      }\n      return sortOrder == SortOrder.ascending ? cmp : -cmp;\n    });\n\n    return list;\n  }\n}\n","baseTimestamp":1755130396748},"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/presentation/stock/stock_view_model.dart":{"filePath":"C:/Users/USER/Documents/Stock Management System/Frontend/clean_arch_app/lib/presentation/stock/stock_view_model.dart","baseContent":"// stock_view_model.dart\nimport 'dart:async';\n\nimport 'package:clean_arch_app/data/mappers/auth/user_mapper.dart';\nimport 'package:clean_arch_app/data/models/auth/user_model.dart';\nimport 'package:clean_arch_app/domain/entities/auth/user.dart';\nimport 'package:clean_arch_app/presentation/stock/mock_stock_data.dart';\nimport 'package:flutter_riverpod/flutter_riverpod.dart';\n\nimport '../../core/enums/stock_status.dart';\nimport '../../domain/entities/stock/stock.dart';\nimport '../../domain/entities/auth/permission_type.dart';\nimport '../../domain/repositories/auth_repository.dart';\nimport '../../domain/usecases/stock/stock_usecases.dart';\nimport 'stock_state.dart';\n\n/// Production-grade StockViewModel which uses grouped usecases.\n/// All domain/data access goes through `stockUseCases` (one injected object).\n/// ViewModel only updates immutable StockState. Filtering + sorting are computed\n/// by StockState.filteredStocks (no duplicated storage).\nclass StockViewModel extends StateNotifier<StockState> {\n  final StockUseCases stockUseCases;\n  final AuthRepository authRepository;\n\n  // Optional debounce for search (tweak timeout as needed)\n  Timer? _searchDebounce;\n\n  StockViewModel({\n    required this.stockUseCases,\n    required this.authRepository,\n  }) : super(StockState.initial()) {\n    _init();\n  }\n\n  // -----------------------\n  // Initialization\n  // -----------------------\n  void _init() {\n    _loadCurrentUser();\n    loadStocks();\n  }\n\n  Future<void> _loadCurrentUser() async {\n    try {\n      final res = await authRepository.getCurrentUser();\n      res.fold(\n            (failure) => state = state.copyWith(\n          status: StockStateStatus.error,\n          errorMessage: _failureMessage(failure, fallback: 'Failed to load user'),\n        ),\n            (user) => state = state.copyWith(currentUser: user)\n    );\n    } catch (e) {\n      state = state.copyWith(\n        status: StockStateStatus.error,\n        errorMessage: 'Failed to load user: $e',\n      );\n    }\n  }\n\n  String _failureMessage(dynamic failure, {String? fallback}) {\n    try {\n      if (failure == null) return fallback ?? 'Unknown error';\n      if (failure is Exception) return failure.toString();\n      // Common shape: failure.message\n      final msg = (failure as dynamic).message;\n      return msg ?? failure.toString();\n    } catch (_) {\n      return fallback ?? failure.toString();\n    }\n  }\n\n  // -----------------------\n  // Permission helpers\n  // -----------------------\n  bool hasPermission(PermissionType permission) =>\n      state.currentUser?.hasPermission(permission) ?? false;\n\n  bool get canCreateStock => hasPermission(PermissionType.createProduct);\n  bool get canEditStock => hasPermission(PermissionType.editProduct);\n  bool get canDeleteStock => hasPermission(PermissionType.deleteProduct);\n  bool get canAdjustStock => hasPermission(PermissionType.adjustStock);\n  bool get canViewStockReports => hasPermission(PermissionType.viewReports);\n\n  // -----------------------\n  // Load / Refresh\n  // -----------------------\n  Future<void> loadStocks() async {\n    state = state.copyWith(status: StockStateStatus.loading, errorMessage: null);\n\n    try {\n      final result = await stockUseCases.getAllStocks();\n      result.fold(\n            (failure) {\n          // fallback: if you want mock data only in dev, move this to DEV-only code\n          final mock = getMockStocks();\n          state = state.copyWith(\n            stocks: mock,\n            status: StockStateStatus.success,\n            errorMessage: _failureMessage(failure, fallback: 'Using mock data'),\n          );\n          // no _applyFiltersAndSort: filteredStocks is computed by state\n        },\n            (stocks) {\n          final used = stocks.isEmpty ? getMockStocks() : stocks;\n          state = state.copyWith(stocks: used, status: StockStateStatus.success);\n        },\n      );\n    } catch (e) {\n      final mock = getMockStocks();\n      state = state.copyWith(\n        stocks: mock,\n        status: StockStateStatus.success,\n        errorMessage: 'Using mock data due to error: $e',\n      );\n    }\n  }\n\n  Future<void> refresh() async => loadStocks();\n\n  // -----------------------\n  // Search / Filters\n  // -----------------------\n  /// Debounced search to avoid repeated work on every keystroke\n  void setSearchQuery(String q) {\n    _searchDebounce?.cancel();\n    _searchDebounce = Timer(const Duration(milliseconds: 300), () {\n      state = state.copyWith(searchQuery: q);\n      // no explicit apply; UI should read state.filteredStocks\n    });\n  }\n\n  /// Convenience alias (UI may call updateSearch)\n  void updateSearch(String q) => setSearchQuery(q);\n\n  /// Set filter status\n  void setFilterStatus(StockStatus? status) {\n    state = state.copyWith(filterStatus: status);\n  }\n\n  /// Alias to match UI naming\n  void setStatusFilter(StockStatus? status) => setFilterStatus(status);\n\n  // -----------------------\n  // Sorting\n  // -----------------------\n  /// Toggle / set sort by\n  void setSortBy(SortBy sortBy) {\n    // if same field, flip order; if different, set ascending\n    if (state.sortBy == sortBy) {\n      final newOrder = state.sortOrder == SortOrder.ascending\n          ? SortOrder.descending\n          : SortOrder.ascending;\n      state = state.copyWith(sortOrder: newOrder);\n    } else {\n      state = state.copyWith(sortBy: sortBy, sortOrder: SortOrder.ascending);\n    }\n  }\n\n  /// Toggle the sort order for the current sort field (useful for UI toggle)\n  void toggleSort() => setSortBy(state.sortBy);\n\n  void toggleSortOrder(SortBy sortBy) {\n    setSortBy(sortBy); // setSortBy already toggles\n  }\n\n  // -----------------------\n  // Selection / Bulk\n  // -----------------------\n  void toggleBulkSelectionMode() {\n    final newMode = !state.isBulkSelectionMode;\n    selectAll();\n    state = state.copyWith(\n      isBulkSelectionMode: newMode,\n      selectedStockIds: newMode ? state.selectedStockIds : <String>{},\n    );\n  }\n\n  void toggleStockSelection(String stockId) {\n    final set = Set<String>.from(state.selectedStockIds);\n    if (!set.add(stockId)) set.remove(stockId);\n    state = state.copyWith(selectedStockIds: set);\n  }\n\n  /// Select all visible (filtered) items\n  void selectAll() {\n    final all = state.filteredStocks.map((s) => s.id).toSet();\n    state = state.copyWith(selectedStockIds: all);\n  }\n\n  /// Select all items (regardless of filter)\n  void selectAllAll() {\n    final all = state.stocks.map((s) => s.id).toSet();\n    state = state.copyWith(selectedStockIds: all);\n  }\n\n  void clearSelection() => state = state.copyWith(selectedStockIds: <String>{});\n\n  // -----------------------\n  // CRUD via usecases\n  // -----------------------\n  Future<void> addStock(Stock stock) async {\n    if (!canCreateStock) {\n      state = state.copyWith(\n          status: StockStateStatus.error,\n          errorMessage: 'You do not have permission to create stock items');\n      return;\n    }\n\n    state = state.copyWith(status: StockStateStatus.loading, errorMessage: null);\n\n    try {\n      final res = await stockUseCases.addStock(stock);\n      res.fold(\n            (failure) => state = state.copyWith(\n            status: StockStateStatus.error,\n            errorMessage: _failureMessage(failure, fallback: 'Failed to add')),\n            (_) => loadStocks(),\n      );\n    } catch (e) {\n      state = state.copyWith(\n          status: StockStateStatus.error, errorMessage: 'Failed to add: $e');\n    }\n  }\n\n  Future<void> updateStock(Stock stock) async {\n    if (!canEditStock) {\n      state = state.copyWith(\n          status: StockStateStatus.error,\n          errorMessage: 'You do not have permission to edit stock items');\n      return;\n    }\n\n    state = state.copyWith(status: StockStateStatus.loading, errorMessage: null);\n\n    try {\n      final res = await stockUseCases.updateStock(stock);\n      res.fold(\n            (failure) => state = state.copyWith(\n            status: StockStateStatus.error,\n            errorMessage: _failureMessage(failure, fallback: 'Failed to update')),\n            (_) => loadStocks(),\n      );\n    } catch (e) {\n      state = state.copyWith(\n          status: StockStateStatus.error, errorMessage: 'Failed to update: $e');\n    }\n  }\n\n  Future<void> deleteStock(String id) async {\n    if (!canDeleteStock) {\n      state = state.copyWith(\n          status: StockStateStatus.error,\n          errorMessage: 'You do not have permission to delete stock items');\n      return;\n    }\n\n    state = state.copyWith(status: StockStateStatus.loading, errorMessage: null);\n\n    try {\n      final res = await stockUseCases.deleteStock(id);\n      res.fold(\n            (failure) {\n          state = state.copyWith(\n              status: StockStateStatus.error,\n              errorMessage: _failureMessage(failure, fallback: 'Failed to delete'));\n        },\n            (_) {\n          final remaining = state.stocks.where((s) => s.id != id).toList();\n          state = state.copyWith(\n            stocks: remaining,\n            selectedStockIds: Set<String>.from(state.selectedStockIds)..remove(id),\n            status: StockStateStatus.success,\n          );\n        },\n      );\n    } catch (e) {\n      state = state.copyWith(\n          status: StockStateStatus.error, errorMessage: 'Failed to delete: $e');\n    }\n  }\n\n  Future<void> bulkDelete() async {\n    if (!canDeleteStock) {\n      state = state.copyWith(\n          status: StockStateStatus.error,\n          errorMessage: 'You do not have permission to delete stock items');\n      return;\n    }\n\n    final ids = state.selectedStockIds.toList();\n    if (ids.isEmpty) return;\n\n    state = state.copyWith(status: StockStateStatus.loading, errorMessage: null);\n\n    try {\n      // Prefer a batched usecase if available:\n      if (stockUseCases.deleteMultipleStocks != null) {\n        final res = await stockUseCases.deleteMultipleStocks!(ids);\n        res.fold(\n              (failure) => state = state.copyWith(\n              status: StockStateStatus.error,\n              errorMessage: _failureMessage(failure, fallback: 'Failed batch delete')),\n              (_) {\n            state = state.copyWith(\n              stocks: state.stocks.where((s) => !ids.contains(s.id)).toList(),\n              selectedStockIds: <String>{},\n              isBulkSelectionMode: false,\n              status: StockStateStatus.success,\n            );\n          },\n        );\n      } else {\n        // fallback to parallel deletes and collect failures\n        final results = await Future.wait(ids.map((id) => stockUseCases.deleteStock(id)));\n        // assume results are Either; adapt to your type if different\n        final failures = results.where((r) => r.isLeft()).toList();\n        if (failures.isNotEmpty) {\n          state = state.copyWith(\n              status: StockStateStatus.error,\n              errorMessage: 'Some items could not be deleted');\n        } else {\n          state = state.copyWith(\n            stocks: state.stocks.where((s) => !ids.contains(s.id)).toList(),\n            selectedStockIds: <String>{},\n            isBulkSelectionMode: false,\n            status: StockStateStatus.success,\n          );\n        }\n      }\n    } catch (e) {\n      state = state.copyWith(\n          status: StockStateStatus.error, errorMessage: 'Bulk delete failed: $e');\n    }\n  }\n\n  Future<void> adjustStock(String stockId, int delta, String reason) async {\n    if (!canAdjustStock) {\n      state = state.copyWith(\n        status: StockStateStatus.error,\n        errorMessage: 'You do not have permission to adjust stock quantities',\n      );\n      return;\n    }\n\n    state = state.copyWith(status: StockStateStatus.loading, errorMessage: null);\n\n    try {\n      final res = await stockUseCases.adjustStock(stockId, delta, reason);\n      res.fold(\n            (failure) => state = state.copyWith(\n            status: StockStateStatus.error,\n            errorMessage: _failureMessage(failure, fallback: 'Failed to adjust')),\n            (_) => loadStocks(),\n      );\n    } catch (e) {\n      state = state.copyWith(\n          status: StockStateStatus.error, errorMessage: 'Failed to adjust: $e');\n    }\n  }\n\n  Future<void> bulkUpdateStatus(StockStatus status) async {\n    if (!canEditStock) {\n      state = state.copyWith(\n          status: StockStateStatus.error,\n          errorMessage: 'You do not have permission to update stock status');\n      return;\n    }\n\n    final ids = state.selectedStockIds.toList();\n    if (ids.isEmpty) return;\n\n    state = state.copyWith(status: StockStateStatus.loading, errorMessage: null);\n\n    try {\n      if (stockUseCases.updateMultipleStockStatus != null) {\n        final res = await stockUseCases.updateMultipleStockStatus!(ids, status);\n        res.fold(\n              (failure) => state = state.copyWith(\n              status: StockStateStatus.error,\n              errorMessage: _failureMessage(failure, fallback: 'Failed batch update')),\n              (_) async {\n            await loadStocks();\n            state = state.copyWith(selectedStockIds: <String>{}, isBulkSelectionMode: false);\n          },\n        );\n      } else {\n        // fallback: update one-by-one\n        final results = await Future.wait(ids.map((id) {\n          final s = state.stocks.firstWhere((it) => it.id == id);\n          final updated = s.copyWith(status: status);\n          return stockUseCases.updateStock(updated);\n        }));\n        final failures = results.where((r) => r.isLeft()).toList();\n        if (failures.isNotEmpty) {\n          state = state.copyWith(status: StockStateStatus.error, errorMessage: 'Some updates failed');\n        } else {\n          await loadStocks();\n          state = state.copyWith(selectedStockIds: <String>{}, isBulkSelectionMode: false);\n        }\n      }\n    } catch (e) {\n      state = state.copyWith(status: StockStateStatus.error, errorMessage: 'Failed to bulk update: $e');\n    }\n  }\n\n  // -----------------------\n  // Helpers / UI actions (placeholders)\n  // -----------------------\n  Stock? getStockById(String id) {\n    try {\n      return state.stocks.firstWhere((s) => s.id == id);\n    } catch (_) {\n      return null;\n    }\n  }\n\n  // Placeholder  wire these to real UI navigations / dialogs\n  void showViewStock(String id) {\n    try{\n\n    }\n    catch (_){\n\n    }\n  }\n  void showAddStock() {\n    // TODO: open create modal / route\n  }\n\n  void refreshItem(String id) {\n    // TODO: refresh single item if needed\n  }\n\n  void handleItemAction(String stockId, String action) {\n    switch (action.toLowerCase()) {\n      case 'delete':\n        deleteStock(stockId);\n        break;\n      case 'edit':\n      // TODO: Navigate to edit screen\n        break;\n      case 'adjust':\n      // TODO: Show adjustment dialog\n        break;\n      default:\n      // Unknown action\n        break;\n    }\n  }\n\n  void openAdvancedFilters() {\n    // TODO: trigger advanced filters UI\n  }\n\n  @override\n  void dispose() {\n    _searchDebounce?.cancel();\n    super.dispose();\n  }\n}\n","baseTimestamp":1755130396776}}}